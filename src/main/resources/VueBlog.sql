/*
 Navicat Premium Data Transfer

 Source Server         : blog
 Source Server Type    : MySQL
 Source Server Version : 80021
 Source Host           : 120.27.243.204:10001
 Source Schema         : VueBlog

 Target Server Type    : MySQL
 Target Server Version : 80021
 File Encoding         : 65001

 Date: 08/08/2020 12:30:35
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for blog
-- ----------------------------
DROP TABLE IF EXISTS `blog`;
CREATE TABLE `blog`  (
                         `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                         `title` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'æ ‡é¢˜',
                         `summary` varchar(400) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'æ¦‚è§ˆ',
                         `create_date` datetime(0) NOT NULL COMMENT 'åˆ›å»ºæ—¥æœŸ',
                         `update_date` datetime(0) NOT NULL COMMENT 'æ›´æ–°æ—¥æœŸ',
                         `click_count` int(0) NOT NULL COMMENT 'ç‚¹å‡»æ•°',
                         `comment_count` int(0) NOT NULL COMMENT 'è¯„è®ºæ•°',
                         `like_count` int(0) NOT NULL COMMENT 'å–œæ¬¢æ•°',
                         `tag` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'åšå®¢æ ‡ç­¾(å¦‚1,2,3è¡¨ç¤ºå…·æœ‰ä¸‰ç§æ ‡ç­¾)',
                         `blog_image` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'åšå®¢å›¾ç‰‡',
                         `original_url` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'åŸæ–‡åœ°å€ï¼ˆå¦‚æœéåŸåˆ›ï¼‰',
                         `type` int(0) UNSIGNED NOT NULL COMMENT '0åŸåˆ›/1è½¬è½½/2ç¿»è¯‘',
                         PRIMARY KEY (`id`) USING BTREE,
                         INDEX `type_id`(`tag`) USING BTREE,
                         INDEX `type`(`type`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 63 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of blog
-- ----------------------------
INSERT INTO `blog` VALUES (10, 'å…³äºæœ¬åšå®¢', 'ç®€ä»‹æœ¬åšå®¢å‰åç«¯åˆ†ç¦»çš„è½»é‡çº§ä¸ªäººåšå®¢ç³»ç»Ÿã€‚æœ¬åšå®¢ç³»ç»Ÿç”±åç«¯æœåŠ¡å™¨ç³»ç»Ÿã€åå°ç®¡ç†ç³»ç»Ÿã€å‰å°ç³»ç»Ÿä¸‰ä¸ªå­ç³»ç»Ÿç»„æˆã€‚å…¶ä¸­ï¼Œåç«¯æœåŠ¡ç³»ç»ŸåŸºäºSpringBootï¼Œåå°ç®¡ç†ç³»ç»Ÿå’Œå‰å°ç³»ç»Ÿå‡åŸºäºVueã€‚æ¯ä¸ªå­ç³»ç»Ÿçš„', '2019-07-01 20:13:13', '2019-08-29 21:20:08', 258, 1, 30, '11,13', 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/5lQGI7TSaeU97bVgYoTMJasr', '', 1);
INSERT INTO `blog` VALUES (11, 'å›¾è§£æ’åºç®—æ³•(å››)ä¹‹å½’å¹¶æ’åº', 'åŸºæœ¬æ€æƒ³ã€€ã€€å½’å¹¶æ’åºï¼ˆMERGE-SORTï¼‰æ˜¯åˆ©ç”¨å½’å¹¶çš„æ€æƒ³å®ç°çš„æ’åºæ–¹æ³•ï¼Œè¯¥ç®—æ³•é‡‡ç”¨ç»å…¸çš„åˆ†æ²»ï¼ˆdivide-and-conquerï¼‰ç­–ç•¥ï¼ˆåˆ†æ²»æ³•å°†é—®é¢˜åˆ†ã€‚åˆ†è€Œæ²»ä¹‹!(http://localhos', '2019-07-16 19:51:27', '2019-08-14 11:09:53', 23, 0, 1, '1,10', 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/6FuV57igPa9A0Iwru922IK8l', 'http://www.cnblogs.com/chengxiao/p/6194356.html', 2);
INSERT INTO `blog` VALUES (20, 'vueä¸ä½¿ç”¨vuexæ—¶åˆ›å»ºå“åº”å¼å…¨å±€å˜é‡çš„æ–¹æ³•', 'é—®é¢˜æè¿°Vuexé€‚åˆäºä¸­å¤§å‹é¡¹ç›®ï¼Œåœ¨å°å‹é¡¹ç›®ä¸­ä½¿ç”¨å¾€å¾€æ˜¯æ€é¸¡ç”¨ç‰›åˆ€ã€‚å®˜æ–¹è¯´æ˜å¦‚ä¸‹:å¦‚æœæ‚¨ä¸æ‰“ç®—å¼€å‘å¤§å‹å•é¡µåº”ç”¨ï¼Œä½¿ç”¨Vuexå¯èƒ½æ˜¯ç¹çå†—ä½™çš„ã€‚ç¡®å®æ˜¯å¦‚æ­¤â€”â€”å¦‚æœæ‚¨çš„åº”ç”¨å¤Ÿç®€å•ï¼Œæ‚¨æœ€å¥½ä¸è¦ä½¿ç”¨Vuexã€‚', '2019-07-23 20:13:13', '2019-08-14 11:14:19', 82, 0, 1, '4,6,12', 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/nAUpvLNjzkxwks6rvAu9a14i', '', 1);
INSERT INTO `blog` VALUES (33, 'CentOSä¸‹dockerå®‰è£…', 'å‰ææ¡ä»¶å¦‚æœæ˜¯CentOS8,å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« 1.Dockerè¿è¡Œåœ¨CentOS7ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º3.10ä»¥ä¸Šã€‚2.Dockerè¿è¡Œåœ¨CentOS-6.5æˆ–æ›´é«˜çš„ç‰ˆæœ¬çš„CentOS', '2019-08-14 11:02:55', '2019-12-18 16:36:36', 24, 0, 2, '15', NULL, '', 1);
INSERT INTO `blog` VALUES (34, 'SpringCloudå­¦ä¹ ç¬”è®°', 'å‰è¨€æœ¬æ–‡ç« å†…å®¹æ¯”è¾ƒåŸºç¡€ï¼Œä¸ªäººå­¦ä¹ ä½¿ç”¨ï¼ˆå­¦åˆ°å¿ƒæ€çˆ†ç‚¸ï¼Œç™¾åº¦ä¸€å †è€æ—§æ“ä½œï¼Œä¸€å †å‘ï¼‰ï¼Œé…å¥—å®Œæ•´ä»£ç åœ°å€Springæ˜¯ä¸€ä¸ªè½»é‡çº§çš„JAVAEEå¼€æºæ¡†æ¶ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¼ä¸šçº§å¼€å‘çš„å¤æ‚åº¦é—®é¢˜å¤æ‚åº¦-è€¦åˆåº¦Spr', '2019-08-14 11:07:58', '2019-09-09 14:05:00', 45, 5, 4, '15', NULL, '', 1);
INSERT INTO `blog` VALUES (35, 'é¡¹ç›®ä»æ‰“åŒ…åˆ°éƒ¨ç½²', 'è¯´æ˜æœ¬æ–‡ä»¥æœ¬ç½‘ç«™ä½œä¸ºæ¡ˆä¾‹è¿›è¡Œè¯´æ˜SpringBootåç«¯ç³»ç»Ÿçš„æ‰“åŒ…ä»¥åŠéƒ¨ç½²-æ‰“åŒ…é¡¹ç›®æˆjaråŒ…IDEAæ“ä½œ!æˆåŠŸæ ‡å¿—![å¾®ä¿¡å›¾ç‰‡_2019082', '2019-08-26 16:47:58', '2019-08-26 19:30:06', 16, 2, 1, '11', NULL, '', 1);
INSERT INTO `blog` VALUES (36, 'Javaå¤šçº¿ç¨‹', 'ä¸€ã€Javaå¤šçº¿ç¨‹å®ç°çš„å‡ ç§æ–¹å¼1.ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹ç±»publicclassstudy{//1.å®šä¹‰ä¸€ä¸ªç»§æ‰¿Threadçš„å­ç±»publicstaticclasstestThreadexten', '2019-08-27 10:30:03', '2019-12-23 10:03:44', 47, 2, 1, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (37, 'Javaçˆ¬è™«ä»¥åŠçº¿ç¨‹æ± åˆ©ç”¨', 'æ¦‚å¿µä»‹ç»éƒ¨åˆ†ï¼Œä¸æƒ³çœ‹å¯ä»¥è‡ªè¡Œè·³åˆ°åé¢å®æˆ˜ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ï¼Ÿ1.æ“ä½œçš„æ˜¯é‡ç”¨å­˜åœ¨çš„çº¿ç¨‹ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºã€æ¶ˆäº¡çš„å¼€é”€ï¼Œæ€§èƒ½ä½³ã€‚2.å¯æœ‰æ•ˆæ§åˆ¶æœ€å¤§å¹¶å‘çº¿ç¨‹æ•°ï¼Œæé«˜ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨ç‡ï¼ŒåŒæ—¶é¿å…è¿‡å¤šèµ„æºç«äº‰ï¼Œé¿å…', '2019-08-27 16:56:18', '2019-08-28 10:01:40', 190, 8, 1, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (38, 'å…³äºå¤šçº¿ç¨‹å†…å®¹çš„è¡¥å……ï¼ŒThreadPoolExecutorä¸Executorsçš„åŒºåˆ«', 'ç®€ä»‹çœ‹äº†å¤šçº¿ç¨‹çˆ¬è™«çš„æ–‡ç« åï¼Œå¯¹å¤šçº¿ç¨‹åº”è¯¥æœ‰ä¸€å®šçš„äº†è§£äº†ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ThreadPoolExecutoræ¥åˆ›å»ºçº¿ç¨‹æ± è€Œä¸ä½¿ç”¨Executorså‘¢ï¼Ÿå±…ç„¶é˜¿é‡Œçˆ¸çˆ¸éƒ½è¯´äº†ä¸è¦ä½¿ç”¨Executors', '2019-08-28 16:03:44', '2019-08-28 16:03:44', 31, 5, 2, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (39, 'quartz cron', 'Tipsæœ€è¿‘æ‰“ç®—åœ¨é¡¹ç›®ä¸­åŠ å…¥quartzä»»åŠ¡è°ƒåº¦ï¼Œå®ç°å®šæ—¶å¤‡ä»½æ•°æ®åº“ï¼Œå®šæ—¶å‘é€é‚®ä»¶æé†’çš„åŠŸèƒ½ï¼Œæœ€è¿‘æ—¶é—´æœ‰é™ï¼Œå…ˆæŠŠcronçš„ç”¨æ³•äº†è§£ä¸€ä¸‹ï¼Œè¯¦ç»†çš„åé¢æœ‰ç©ºå†åšä¸€ã€ç»“æ„SecondsMinutesHours', '2019-08-29 20:05:24', '2019-09-01 19:50:12', 14, 4, 2, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (40, 'MongoDB', 'ç¯å¢ƒå®‰è£…ç•¥å®æˆ˜~~~bash$mongo//è¿›å…¥mongodbhelp//å¸®åŠ©exit//é€€å‡º$mongoshowdbs;//æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“usetest;//ä½¿ç”¨æŸä¸ªæ•°æ®åº“showcollectio', '2019-09-04 15:13:00', '2019-09-04 18:29:36', 5, 0, 0, '7', NULL, '', 1);
INSERT INTO `blog` VALUES (41, 'Spring Security OAuth2å­¦ä¹ ', 'ä»€ä¹ˆæ˜¯oAuthoAuthåè®®ä¸ºç”¨æˆ·èµ„æºçš„æˆæƒæä¾›äº†ä¸€ä¸ªå®‰å…¨çš„ã€å¼€æ”¾è€Œåˆç®€æ˜“çš„æ ‡å‡†ã€‚ä¸ä»¥å¾€çš„æˆæƒæ–¹å¼ä¸åŒä¹‹å¤„æ˜¯oAuthçš„æˆæƒä¸ä¼šä½¿ç¬¬ä¸‰æ–¹è§¦åŠåˆ°ç”¨æˆ·çš„å¸å·ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åä¸å¯†ç ï¼‰ï¼Œå³ç¬¬ä¸‰æ–¹æ— éœ€ä½¿ç”¨ç”¨æˆ·çš„', '2019-09-08 11:35:32', '2019-12-17 19:32:56', 16, 0, 0, '2', NULL, '', 1);
INSERT INTO `blog` VALUES (42, 'frpåšå†…ç½‘ç©¿é€', 'ä¸ºä»€ä¹ˆè¦åšå†…ç½‘ç©¿é€åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œç›®å‰ä¸»æµçš„æ–¹æ¡ˆéƒ½æ˜¯å‰åç«¯åˆ†ç¦»çš„ï¼Œé‚£ä¹ˆå‰åç«¯ä¸åœ¨ä¸€å°ç”µè„‘ä¸Šï¼Œæµ‹è¯•çš„æ—¶å€™å‰ç«¯äººå‘˜éœ€è¦ä¸€ä¸ªå¯ä»¥è®¿é—®çš„serverï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšå†…ç½‘ç©¿é€ï¼Œå°†æœ¬åœ°ç«¯å£æš´éœ²åˆ°å…¬ç½‘ä¸­å»ï¼Œ', '2019-09-11 19:56:10', '2019-09-11 20:02:18', 7, 0, 0, '13', NULL, '', 1);
INSERT INTO `blog` VALUES (43, 'æ‰‹å†™ä¸€ä¸ªFutureTaskå’Œçº¿ç¨‹æ± ', 'å‡†å¤‡å·¥ä½œ1.äº†è§£Javaæ˜¯å¦‚ä½•åˆ›å»ºçº¿ç¨‹çš„2.äº†è§£Javaæ˜¯å¦‚ä½•åˆå§‹åŒ–çº¿ç¨‹æ± çš„æœ¬èŠ‚ä»£ç åœ°å€ä¸ºä»€ä¹ˆè¦ç”¨FutureTaskFutureTaskå¯ä»¥è·å–åˆ°çº¿ç¨‹æ‰§è¡Œçš„ç»“æœï¼Œè€Œç›´æ¥ä½¿ç”¨Runableæ˜¯æ²¡åŠæ³•è·å–', '2019-09-25 16:45:14', '2019-09-25 17:22:39', 12, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (44, 'ç»å…¸æ’åºç®—æ³•æ•´åˆï¼ˆå¾…æ›´æ–°ï¼‰', 'ç›¸å…³ä»£ç åœ°å€å†’æ³¡æ’åº-æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢å®ƒä»¬ä¸¤ä¸ªï¼›-å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ï¼Œè¿™æ ·åœ¨æœ€åçš„å…ƒç´ åº”è¯¥ä¼šæ˜¯æœ€å¤§çš„æ•°ï¼›-é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥', '2019-10-08 14:40:42', '2019-12-17 09:28:27', 16, 0, 0, '1,10', NULL, '', 1);
INSERT INTO `blog` VALUES (45, 'RocketMQ', 'æ¦‚è¿°æ¶ˆæ¯é˜Ÿåˆ—ä½œä¸ºé«˜å¹¶å‘ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œèƒ½å¤Ÿå¸®åŠ©ä¸šåŠ¡ç³»ç»Ÿè§£æ„æå‡å¼€å‘æ•ˆç‡å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚ä¸»è¦å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š-å‰Šå³°å¡«è°·ï¼šä¸»è¦è§£å†³ç¬æ—¶å†™å‹åŠ›å¤§äºåº”ç”¨æœåŠ¡èƒ½åŠ›å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€ç³»ç»Ÿå¥”æºƒç­‰é—®é¢˜-ç³»ç»Ÿè§£è€¦ï¼šè§£å†³ä¸åŒ', '2019-10-12 09:36:35', '2019-10-12 09:36:35', 3, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (46, 'Javaé¢è¯•æ•´åˆ', 'ï¼ˆä¸ªäººæ€»ç»“ï¼Œä»…ä¾›å‚è€ƒï¼‰JavaåŸºç¡€æ¥å£ç±»å’ŒæŠ½è±¡ç±»çš„å·®åˆ«1.æ¥å£æ˜¯ç»å¯¹æŠ½è±¡çš„ï¼Œä¸å¯ä»¥è¢«å®ä¾‹åŒ–æˆå¯¹è±¡ã€‚æŠ½è±¡ç±»ä¹Ÿä¸å¯ä»¥è¢«å®ä½“åŒ–ï¼Œå¯æ˜¯å¦‚æœæŠ½è±¡ç±»ä¸­æœ‰mainæ–¹æ³•çš„è¯å¯ä»¥è¢«è°ƒç”¨ã€‚2.æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯éšè—æŠ½è±¡', '2019-11-20 20:38:53', '2020-05-11 22:53:44', 85, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (47, 'Javaç¬”è¯•', '2019/5/8ä¸‹åˆ—å…³äºSpringç‰¹æ€§ä¸­IOCæè¿°é”™è¯¯çš„æ˜¯ï¼šA.IoCå°±æ˜¯æŒ‡ç¨‹åºä¹‹é—´çš„å…³ç³»ç”±ç¨‹åºä»£ç ç›´æ¥æ“æ§B.æ‰€è°“â€œæ§åˆ¶åè½¬â€æ˜¯æŒ‡æ§åˆ¶æƒç”±åº”ç”¨ä»£ç è½¬åˆ°å¤–éƒ¨å®¹å™¨ï¼Œå³æ§åˆ¶æƒçš„è½¬ç§»C.IoCå°†æ§åˆ¶åˆ›å»ºçš„', '2019-11-28 17:12:51', '2019-12-05 09:18:56', 17, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (48, 'dockerfile+docker-compose', 'Dockerfileä¸€ã€ç®€ä»‹1.1dockerfileä¸­å¸¸ç”¨çš„å‘½ä»¤åˆé›†!1.2dockerbuildåŸºäºdockerfileåˆ¶ä½œé•œåƒçš„å‘½ä»¤dockerbuildPATH|URL|-å‚æ•°1.3å‚', '2019-12-18 19:47:49', '2019-12-18 20:13:50', 4, 0, 0, '11,12', NULL, '', 1);
INSERT INTO `blog` VALUES (49, 'RocketMQå­¦ä¹ ç¬”è®°', 'å‰è¨€æœ¬æ–‡ç« å†…å®¹å‚è€ƒè‡ªï¼Œå¯¹å·²æœ‰å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œç²¾ç®€éƒ¨åˆ†å†…å®¹ï¼Œå¹¶ä¸”ä½¿ç”¨spring-cloud-starter-stream-rocketmqæ¥ä»£æ›¿Bç«™è§†é¢‘ä¸­çš„spring-booté›†æˆåŒ…ã€‚ä¿®æ”¹åçš„ä¸ªäººå®Œæ•´', '2019-12-23 20:54:20', '2019-12-24 09:55:07', 15, 0, 0, '16', NULL, '', 1);
INSERT INTO `blog` VALUES (50, 'Nginxä»£ç†å¸¸ç”¨é…ç½®', 'é…ç½®æ–‡ä»¶å†…å®¹1ï¼‰å…¨å±€å—2ï¼‰eventså—3ï¼‰httpå—åå‘ä»£ç†é…ç½®ä¾‹å­1ï¼‰å®Œæ•´æ¡ˆä¾‹confè¿è¡Œç”¨æˆ·usersomebody;å¯åŠ¨è¿›ç¨‹,é€šå¸¸è®¾ç½®æˆå’Œcpuçš„æ•°é‡ç›¸ç­‰worker_processes1;å…¨', '2019-12-25 15:02:45', '2019-12-25 15:09:22', 13, 0, 3, '11', NULL, '', 1);
INSERT INTO `blog` VALUES (52, 'jib-maven-pluginæ„å»ºé•œåƒ', 'åºè¨€åœ¨æœ¬æ¬¡æœŸæœ«è®¾è®¡å½“ä¸­ï¼Œåº”ä¸ºéœ€è¦åšéƒ¨ç½²è„šæœ¬ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯dockerfile+docker-composeçš„éƒ¨ç½²æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å¯¹vueé¡¹ç›®æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºvueä¸‹è½½ä¾èµ–ä¸æ‰“åŒ…æ˜¯åˆ†ç¦»å¼€æ¥çš„ï¼Œå³ä½¿ä¿®æ”¹äº†', '2020-01-04 15:10:26', '2020-01-04 15:10:26', 26, 0, 0, '1,12', NULL, '', 1);
INSERT INTO `blog` VALUES (53, 'SpringCloudAlibabaé€šè¿‡jibæ’ä»¶æ‰“åŒ…å‘å¸ƒåˆ°docker', 'åºè¨€åœ¨SpringBooté¡¹ç›®éƒ¨ç½²çš„æ—¶å€™ï¼Œæˆ‘äº†è§£åˆ°äº†Jibæ’ä»¶çš„å¼ºå¤§ï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥å¿«é€Ÿæ„å»ºé•œåƒå‘å¸ƒåˆ°æˆ‘ä»¬çš„é•œåƒä»“åº“å½“ä¸­å»ã€‚äºæ˜¯æˆ‘æ‰“ç®—åœ¨æ¯•è®¾å½“ä¸­åŠ ä¸Šè¿™ä¸ªåŠŸèƒ½ï¼Œå¹¶ä¸”æ•´åˆåˆ°githubactionsä¸­å»ã€‚é˜»', '2020-01-08 16:15:22', '2020-01-08 16:15:22', 6, 0, 0, '1,12', NULL, '', 1);
INSERT INTO `blog` VALUES (54, 'JVMå­¦ä¹ ç¬”è®°', '1ã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ!-çº¿ç¨‹ç§æœ‰çš„ï¼š-ç¨‹åºè®¡æ•°å™¨-è™šæ‹Ÿæœºæ ˆ-æœ¬åœ°æ–¹æ³•æ ˆ-çº¿ç¨‹å…±äº«çš„ï¼š-å †-æ–¹æ³•åŒº-ç›´æ¥å†…å­˜1.1ç¨‹åºè®¡æ•°å™¨ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚å­—', '2020-02-22 21:53:51', '2020-03-03 15:59:53', 49, 0, 1, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (55, 'Linuxå¸¸ç”¨æŒ‡ä»¤', '-cdï¼šcdå‘½ä»¤åé¢è·Ÿä¸€ä¸ªè·¯å¾„ï¼Œç”¨äºåˆ‡æ¢å½“å‰ç”¨æˆ·æ‰€åœ¨çš„è·¯å¾„ï¼Œå…¶ä¸­è·¯å¾„å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„-lsï¼šlsæ˜¯listçš„ç¼©å†™ã€‚æœ€å¸¸ç”¨çš„å‚æ•°æ˜¯-lï¼Œä¹Ÿå°±æ˜¯ls-lå‘½ä»¤ï¼Œä½œç”¨ä¸ºç”¨äºæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹çš„', '2020-03-05 11:55:56', '2020-04-11 22:19:24', 5, 0, 0, '8', NULL, '', 1);
INSERT INTO `blog` VALUES (56, 'è®¾è®¡æ¨¡å¼', 'ä¸€ã€å•ä¾‹æ¨¡å¼1.1é¥¿æ±‰æ¨¡å¼Java//é¥¿æ±‰å¼å•ä¾‹ç±».åœ¨ç±»åˆå§‹åŒ–æ—¶ï¼Œå·²ç»è‡ªè¡Œå®ä¾‹åŒ–publicclassSingleton1{privateSingleton1privatestaticfinalSin', '2020-03-08 21:45:42', '2020-04-15 16:01:18', 10, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (57, 'æ–‡ç« åˆ†äº«', 'è®¡ç®—æœºç½‘ç»œ(https://blog.csdn.net/qq_26896213/article/details/84594060?depth_1-utm_source=distribute.pc_re', '2020-03-12 17:12:15', '2020-03-27 12:35:30', 21, 0, 0, '12', NULL, '', 1);
INSERT INTO `blog` VALUES (58, 'NIO', 'æœ¬æ–‡ç« å¯¹åº”ä»£ç åœ°å€ï¼šä¸€ã€äº†è§£IOä¸NIOåŒºåˆ«!äºŒã€åˆè§Bufferç¼“å†²åŒº!(https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/iWfl', '2020-05-03 20:36:32', '2020-05-04 22:11:33', 8, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (59, 'Netty', 'å†…å®¹å‚è€ƒå°šç¡…è°·Nettyæ•™ç¨‹æœ‰äº†NIOï¼Œä¸ºä»€ä¹ˆè¿˜æœ‰Netty1.NIOä¸­epollç©ºè½®è¯¢é—®é¢˜2.NIOçš„ç±»åº“å’ŒAPIç¹æ‚ï¼Œä½¿ç”¨éº»çƒ¦ï¼šéœ€è¦æŒæ¡Selectorã€ServerSocketChannelã€S', '2020-05-16 11:43:28', '2020-05-26 20:22:08', 6, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (60, 'Netty-TCP', 'ä½¿ç”¨Nettyå¼€å¯TCPæœåŠ¡NettyæœåŠ¡ç«¯javapublicclassNettyServer{publicstaticvoidmainthrowsInterruptedExcept', '2020-05-28 10:42:26', '2020-05-28 22:52:21', 3, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (61, 'Netty-TaskQueue', 'Nettyä»»åŠ¡é˜Ÿåˆ—-ç”¨æˆ·ç¨‹åºè‡ªå®šä¹‰çš„æ™®é€šä»»åŠ¡javactx.channel-{try{Thread.sleep;ctx.writeAndFlush(Unpooled.copiedBuffer(\"å¤„ç†ç»“', '2020-05-31 14:31:29', '2020-05-31 14:31:29', 0, 0, 0, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (62, 'Netty-WebSocket', 'javapublicclassChatServer{privateintport;ChatServer{this.port=port;}publicvoidstartthrowsInterrupted', '2020-06-17 14:22:57', '2020-06-17 14:22:57', 15, 1, 1, '1', NULL, '', 1);
INSERT INTO `blog` VALUES (63, 'Github Hosts', 'é¡¹ç›®éƒ¨ç½²ä¸Šçº¿ågithubç¬¬ä¸‰æ–¹ç™»å½•ç¦»å¥‡çš„æ…¢ï¼Œå¹¶ä¸”å¤šæ¬¡å‡ºç°Connectionrefusedçš„é”™è¯¯ï¼Œå› æ­¤æ‰¾åˆ°äº†ä¸€ç§åŠæ³•æ˜¯é€šè¿‡ä¿®æ”¹hostsè§£å†³ã€‚Windowsä¸‹åœ¨C:/Windows/system32', '2020-07-23 19:00:55', '2020-07-23 19:00:55', 5, 0, 0, '12', NULL, 'https://www.jianshu.com/p/1a2013b38730', 2);

-- ----------------------------
-- Table structure for blog_content
-- ----------------------------
DROP TABLE IF EXISTS `blog_content`;
CREATE TABLE `blog_content`  (
                                 `id` int(0) UNSIGNED NOT NULL COMMENT 'ä¸»é”®ï¼Œå’Œå¯¹åº”åšå®¢ä¸€è‡´',
                                 `content` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'æ­£æ–‡',
                                 PRIMARY KEY (`id`) USING BTREE,
                                 CONSTRAINT `blog_content_ibfk_1` FOREIGN KEY (`id`) REFERENCES `blog` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of blog_content
-- ----------------------------
INSERT INTO `blog_content` VALUES (10, '## ç®€ä»‹\n\næœ¬åšå®¢å‰åç«¯åˆ†ç¦»çš„è½»é‡çº§ä¸ªäººåšå®¢ç³»ç»Ÿã€‚\n\næœ¬åšå®¢ç³»ç»Ÿç”±åç«¯æœåŠ¡å™¨ç³»ç»Ÿã€åå°ç®¡ç†ç³»ç»Ÿã€å‰å°ç³»ç»Ÿä¸‰ä¸ªå­ç³»ç»Ÿç»„æˆã€‚å…¶ä¸­ï¼Œåç«¯æœåŠ¡ç³»ç»ŸåŸºäºSpringBootï¼Œåå°ç®¡ç†ç³»ç»Ÿå’Œå‰å°ç³»ç»Ÿå‡åŸºäºVueã€‚æ¯ä¸ªå­ç³»ç»Ÿçš„è¯¦ç»†å†…å®¹å¯å‚çœ‹ç›¸åº”çš„Githubåœ°å€ã€‚\n\n## æŠ€æœ¯æ ˆ\n\nSpringBoot + Maven + Mybatis + PageHelper + MySQL + Redis + Quartz(æ¯å¤©å®šæ—¶å°†å½“å¤©çš„è¯„è®ºå‘é€åˆ°ç®¡ç†å‘˜é‚®ç®±)\n\n## ä¼ é€é—¨\n\n- [åç«¯æœåŠ¡ç³»ç»Ÿ](https://github.com/yhuihu/blog-back)\n- [åå°ç®¡ç†ç³»ç»Ÿ](https://github.com/yhuihu/yhhu_blog_admin)\n- [å‰å°ç³»ç»Ÿ](https://github.com/yhuihu/yhhu_blog_front)\n\n> æ³¨æ„ï¼šé¡¹ç›®çš„å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ä¸Šäº†ï¼Œæ‰€ä»¥å›¾ç‰‡è·¯å¾„ä¸ºåŸŸåå½¢å¼ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ”¹å†™ä¿å­˜åˆ°æœ¬åœ°\n## ç›®å‰é—®é¢˜\n- æ–‡ç« ä¸­çš„å›¾ç‰‡è¿˜æ— æ³•è¾¾åˆ°æ”¾å¤§æ•ˆæœï¼Œæ­£åœ¨å¤„ç†ä¸­ã€‚ï¼ˆå·²å®Œæˆï¼Œæœ‰è¿›ä¸€æ­¥å»ºè®®æ¬¢è¿ç•™è¨€ï¼‰\n- v-forä¸‹å¦‚ä½•è°ƒç”¨å…¨å±€å˜é‡ï¼Ÿè¯„è®ºåˆ é™¤æš‚æ—¶è¿˜æœªå®Œæˆï¼Œé‡åˆ°ç“¶é¢ˆ\n- ç”¨æˆ·ç›®å‰åªèƒ½é€šè¿‡githubç¬¬ä¸‰æ–¹ç™»å½•ï¼Œæ²¡æœ‰è¿›è¡Œç»‘å®šæ“ä½œï¼Œä¹‹åæœ‰å¿…è¦ä¼šè¿›è¡Œè¡¥å……\n- ç”±äºé‚®ç®±æ˜¯ä¸€å°å°å‘çš„ï¼Œè‡ªå·±æµ‹è¯•äº†ä¸€ä¸‹ï¼Œç®€ç›´æ˜¯è¢«è½°ç‚¸ï¼Œä¸‹ç‰ˆæœ¬åˆå¹¶æˆä¸€ä¸ªé‚®ä»¶ï¼ˆå·²ä¿®æ”¹ï¼‰\n## BlahBlah\n\nå¦‚æœæœ¬é¡¹ç›®å¯¹æ‚¨å­¦ä¹ Vueæˆ–SpringBootç­‰æœ‰æ‰€å¸®åŠ©çš„è¯ï¼Œè¯·å¸®å¿™ç‚¹é¢—â­å“¦ğŸ˜ï¼\n\nå¦‚æœæ‚¨å¯¹æœ¬é¡¹ç›®æœ‰ä»€ä¹ˆæ„è§æˆ–å»ºè®®ï¼Œä¹Ÿæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ã€‚\n\n## æ‰“èµé“¾æ¥\n![å¾®ä¿¡å›¾ç‰‡_20190826205030.jpg](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/NPZ9xcBMnrCduvtn4WWMITJi)     ![å¾®ä¿¡å›¾ç‰‡_20190826205212.jpg](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ScPrZMaVtT25quNbLSNtlYXk)');
INSERT INTO `blog_content` VALUES (11, '## åŸºæœ¬æ€æƒ³\n\nã€€ã€€å½’å¹¶æ’åºï¼ˆMERGE-SORTï¼‰æ˜¯åˆ©ç”¨å½’å¹¶çš„æ€æƒ³å®ç°çš„æ’åºæ–¹æ³•ï¼Œè¯¥ç®—æ³•é‡‡ç”¨ç»å…¸çš„åˆ†æ²»ï¼ˆdivide-and-conquerï¼‰ç­–ç•¥ï¼ˆåˆ†æ²»æ³•å°†é—®é¢˜åˆ†(divide)æˆä¸€äº›å°çš„é—®é¢˜ç„¶åé€’å½’æ±‚è§£ï¼Œè€Œæ²»(conquer)çš„é˜¶æ®µåˆ™å°†åˆ†çš„é˜¶æ®µå¾—åˆ°çš„å„ç­”æ¡ˆ\"ä¿®è¡¥\"åœ¨ä¸€èµ·ï¼Œå³åˆ†è€Œæ²»ä¹‹)ã€‚\n  \n### åˆ†è€Œæ²»ä¹‹\n\n![](http://localhost/api/upload/2019/07/24/17da2791-65ca-49f1-a26e-f36f28f4a098.png)\n\nå¯ä»¥çœ‹åˆ°è¿™ç§ç»“æ„å¾ˆåƒä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œæœ¬æ–‡çš„å½’å¹¶æ’åºæˆ‘ä»¬é‡‡ç”¨é€’å½’å»å®ç°ï¼ˆä¹Ÿå¯é‡‡ç”¨è¿­ä»£çš„æ–¹å¼å»å®ç°ï¼‰ã€‚åˆ†é˜¶æ®µå¯ä»¥ç†è§£ä¸ºå°±æ˜¯é€’å½’æ‹†åˆ†å­åºåˆ—çš„è¿‡ç¨‹ï¼Œé€’å½’æ·±åº¦ä¸ºlog2nã€‚\n\n## åˆå¹¶ç›¸é‚»æœ‰åºå­åºåˆ—\n\nã€€ã€€å†æ¥çœ‹çœ‹æ²»é˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸¤ä¸ªå·²ç»æœ‰åºçš„å­åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­çš„æœ€åä¸€æ¬¡åˆå¹¶ï¼Œè¦å°†[4,5,7,8]å’Œ[1,2,3,6]ä¸¤ä¸ªå·²ç»æœ‰åºçš„å­åºåˆ—ï¼Œåˆå¹¶ä¸ºæœ€ç»ˆåºåˆ—[1,2,3,4,5,6,7,8]ï¼Œæ¥çœ‹ä¸‹å®ç°æ­¥éª¤ã€‚\n  \n  ![](http://localhost/api/upload/2019/07/24/26f6b8ff-6d46-4578-b1c4-15df8ccf58df.png)\n  ![](http://localhost/api/upload/2019/07/24/8b75acaa-ef34-4566-a29c-7ac13fc58d98.png)\n  \n## ä»£ç å®ç°\n\n```java\npackage sortdemo;\n\nimport java.util.Arrays;\n\n/**\n * Created by chengxiao on 2016/12/8.\n */\npublic class MergeSort {\n    public static void main(String []args){\n        int []arr = {9,8,7,6,5,4,3,2,1};\n        sort(arr);\n        System.out.println(Arrays.toString(arr));\n    }\n    public static void sort(int []arr){\n        int []temp = new int[arr.length];//åœ¨æ’åºå‰ï¼Œå…ˆå»ºå¥½ä¸€ä¸ªé•¿åº¦ç­‰äºåŸæ•°ç»„é•¿åº¦çš„ä¸´æ—¶æ•°ç»„ï¼Œé¿å…é€’å½’ä¸­é¢‘ç¹å¼€è¾Ÿç©ºé—´\n        sort(arr,0,arr.length-1,temp);\n    }\n    private static void sort(int[] arr,int left,int right,int []temp){\n        if(left<right){\n            int mid = (left+right)/2;\n            sort(arr,left,mid,temp);//å·¦è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å·¦å­åºåˆ—æœ‰åº\n            sort(arr,mid+1,right,temp);//å³è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å³å­åºåˆ—æœ‰åº\n            merge(arr,left,mid,right,temp);//å°†ä¸¤ä¸ªæœ‰åºå­æ•°ç»„åˆå¹¶æ“ä½œ\n        }\n    }\n    private static void merge(int[] arr,int left,int mid,int right,int[] temp){\n        int i = left;//å·¦åºåˆ—æŒ‡é’ˆ\n        int j = mid+1;//å³åºåˆ—æŒ‡é’ˆ\n        int t = 0;//ä¸´æ—¶æ•°ç»„æŒ‡é’ˆ\n        while (i<=mid && j<=right){\n            if(arr[i]<=arr[j]){\n                temp[t++] = arr[i++];\n            }else {\n                temp[t++] = arr[j++];\n            }\n        }\n        while(i<=mid){//å°†å·¦è¾¹å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­\n            temp[t++] = arr[i++];\n        }\n        while(j<=right){//å°†å³åºåˆ—å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­\n            temp[t++] = arr[j++];\n        }\n        t = 0;\n        //å°†tempä¸­çš„å…ƒç´ å…¨éƒ¨æ‹·è´åˆ°åŸæ•°ç»„ä¸­\n        while(left <= right){\n            arr[left++] = temp[t++];\n        }\n    }\n}\n```\næ‰§è¡Œç»“æœ\n>[1, 2, 3, 4, 5, 6, 7, 8, 9]\n\n## æœ€å\n\nã€€ã€€å½’å¹¶æ’åºæ˜¯ç¨³å®šæ’åºï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§ååˆ†é«˜æ•ˆçš„æ’åºï¼Œèƒ½åˆ©ç”¨å®Œå…¨äºŒå‰æ ‘ç‰¹æ€§çš„æ’åºä¸€èˆ¬æ€§èƒ½éƒ½ä¸ä¼šå¤ªå·®ã€‚javaä¸­Arrays.sort()é‡‡ç”¨äº†ä¸€ç§åä¸ºTimSortçš„æ’åºç®—æ³•ï¼Œå°±æ˜¯å½’å¹¶æ’åºçš„ä¼˜åŒ–ç‰ˆæœ¬ã€‚ä»ä¸Šæ–‡çš„å›¾ä¸­å¯çœ‹å‡ºï¼Œæ¯æ¬¡åˆå¹¶æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œè€Œå®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦ä¸º|log2n|ã€‚æ€»çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)ã€‚è€Œä¸”ï¼Œå½’å¹¶æ’åºçš„æœ€å¥½ï¼Œæœ€åï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦å‡ä¸ºO(nlogn)ã€‚');
INSERT INTO `blog_content` VALUES (20, '## é—®é¢˜æè¿°\n\nVuexé€‚åˆäºä¸­å¤§å‹é¡¹ç›®ï¼Œåœ¨å°å‹é¡¹ç›®ä¸­ä½¿ç”¨å¾€å¾€æ˜¯æ€é¸¡ç”¨ç‰›åˆ€ã€‚\n\nå®˜æ–¹è¯´æ˜å¦‚ä¸‹:\n\n> å¦‚æœæ‚¨ä¸æ‰“ç®—å¼€å‘å¤§å‹å•é¡µåº”ç”¨ï¼Œä½¿ç”¨ Vuex å¯èƒ½æ˜¯ç¹çå†—ä½™çš„ã€‚ç¡®å®æ˜¯å¦‚æ­¤â€”â€”å¦‚æœæ‚¨çš„åº”ç”¨å¤Ÿç®€å•ï¼Œæ‚¨æœ€å¥½ä¸è¦ä½¿ç”¨ Vuexã€‚\n\nä½†æœ€è¿‘ä½¿ç”¨è‡ªå®šä¹‰çš„å…¨å±€å˜é‡æ—¶ï¼Œå´é‡åˆ°äº†`computed`è®¡ç®—å±æ€§ä¸èƒ½è·å–å…¨å±€å˜é‡å˜æ›´åçš„çŠ¶æ€çš„é—®é¢˜ã€‚\n\n```js\n// src/state/index.js\nexport default {\n	state1: \'\',\n	state2: \'\'\n}\n\n// main.js\nimport state from \'./state\'\nVue.prototype.$state = state\n\n// demo.vue\ncomputed: {\n    state1() {\n        console.log(\'in computed...\')\n        return this.$state.state1\n    }\n},\nwatch: {\n    state1: function(newValue) {\n        console.log(\'newValue: \' + newValue)\n    }\n}    \n```\n\n\n\nå½“é€šè¿‡å…¶ä»–æ–¹å¼æ”¹å˜`state1`çš„å€¼æ—¶ï¼Œå‘ç°`computed`å’Œ`watch`çš„ä»£ç å¹¶æ²¡æœ‰æ‰§è¡Œï¼ŒæŸ¥é˜…äº†ç›¸å…³èµ„æ–™æ‰å‘ç°è¿™ç§æ–¹å¼åˆ›å»ºçš„å…¨å±€å˜é‡**æ˜¯ä¸å¯äº¤äº’çš„**ã€‚\n\n## è§£å†³æ–¹æ³•\n\n```js\n// src/state/index.js\nexport default {\n	state1: \'\',\n	state2: \'\'\n}\n\n// main.js\nimport state from \'./state\'\nnew Vue({\n  el: \'#app\',\n  router,\n  components: { App },\n  template: \'<App/>\'\n  // å…³é”®åœ¨æ­¤å¤„ï¼Œæ³¨æ„æ­¤å¤„dataä¸æ˜¯å‡½æ•°å½¢å¼\n  data: { // only place where data is not a function\n    state\n  },\n})\n\n// demo.vue\ncomputed: {\n    state1() {\n        console.log(\'in computed...\')\n        return this.$root.state.state1\n    }\n},\nwatch: {\n    state1: function(newValue) {\n        console.log(\'newValue: \' + newValue)\n    }\n}  \n```\n\næŒ‰ä¸Šé¢å†™æ³•å°±èƒ½æˆåŠŸåˆ›å»ºå¯äº¤äº’çš„å…¨å±€å˜é‡äº†ã€‚\n\n\n\n## å‚è€ƒ\n\n[https://cn.vuejs.org/v2/guide/state-management.html#ç®€å•çŠ¶æ€ç®¡ç†èµ·æ­¥ä½¿ç”¨](https://cn.vuejs.org/v2/guide/state-management.html#ç®€å•çŠ¶æ€ç®¡ç†èµ·æ­¥ä½¿ç”¨)\n\n[https://stackoverflow.com/questions/51275301/how-to-react-to-a-global-variable-with-vue](https://stackoverflow.com/questions/51275301/how-to-react-to-a-global-variable-with-vue)');
INSERT INTO `blog_content` VALUES (33, '## å‰ææ¡ä»¶\n### å¦‚æœæ˜¯CentOS8,å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« [centos8.0å®‰è£…docker](https://www.cnblogs.com/ding2016/p/11592999.html)\n 1. Docker è¿è¡Œåœ¨ CentOS 7 ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 3.10 ä»¥ä¸Šã€‚\n 2. Docker è¿è¡Œåœ¨ CentOS-6.5 æˆ–æ›´é«˜çš„ç‰ˆæœ¬çš„ CentOS ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 2.6.32-431 æˆ–è€…æ›´é«˜ç‰ˆæœ¬ã€‚\n\n## ç§»é™¤æ—§ç‰ˆæœ¬ä»¥åŠç›¸å…³å†…å®¹\n\n```\n	sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-selinux \\\n                  docker-engine-selinux \\\n                  docker-engine\n```\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/201908102327229.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\n## å®‰è£…ä¾èµ–åŒ…\n```\nyum install -y yum-utils \\ device-mapper-persistent-data \\  lvm2\n```\n## æ›´æ–°å¹¶å®‰è£…Docker CE\n\n```\n//æ·»åŠ è½¯ä»¶æº\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n//æ›´æ–°å¹¶å®‰è£…docker-ce\nyum update && yum -y install docker-ce\n```\n### éªŒè¯å®‰è£…\n\n - å¯åŠ¨docker\n```\nsystemctl start docker\n```\n - æŸ¥çœ‹ä¿¡æ¯\n\n```\ndocker version\n```\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190810234533945.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\n## è®¾ç½®é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2019081023571344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\næ ¹æ®æç¤ºå¼€é€šæœåŠ¡åæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼ˆé•œåƒåŠ é€Ÿå™¨æœ‰å¾ˆå¤šï¼Œåœ¨æ­¤ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„ï¼‰\n![æ ¹æ®æ“ä½œæ–‡æ¡£æ“ä½œ](https://img-blog.csdnimg.cn/2019081023593413.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\næ ¹æ®æ“ä½œæ–‡æ¡£æ“ä½œå³å¯\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190811000152894.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\n### éªŒè¯é…ç½®\n\n```\ndocker info\n```\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190811000452194.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\n## å°è¯•å®‰è£…tomcaté•œåƒ\n\n```\ndocker pull tomcat\n```\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190811000711255.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\n## å¯åŠ¨tomcat\n\n```\ndocker run -p 8080:8080 tomcat\n```\n\n![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190811000930247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTYxMzY4OQ==,size_16,color_FFFFFF,t_70)\n\n## å¸¸ç”¨å‘½ä»¤\n1. æœç´¢å®¹å™¨é•œåƒ\ndocker search xxx\n2. ä¸‹è½½å®¹å™¨é•œåƒ\ndocker pull xxx\n3. å¯åŠ¨å®¹å™¨é•œåƒ\ndocker run \\<IMAGE ID>\n4. åœæ­¢ä¸€ä¸ªå®¹å™¨\ndocker stop xxx\n>å…ˆå‘SIGTERMä¿¡å·ç»™dockerï¼Œå…è®¸å…¶åœ¨ä¸€å®šæ—¶é—´ï¼ˆé»˜è®¤10sï¼‰å†…è¿›è¡Œä¸€äº›æ“ä½œï¼ˆä¾‹å¦‚èµ„æºå›æ”¶ï¼‰ï¼Œè‹¥è¿™æ®µæ—¶é—´å†…å®¹å™¨æœªåœæ­¢ï¼Œåˆ™å‘é€SIGKILLä¿¡å·å¼ºè¡Œæ€æ­»å®¹å™¨\n5. åœæ­¢ä¸€ä¸ªå®¹å™¨2\ndocker kill xxx\n>ç›´æ¥å‘é€SIGKILLä¿¡å·æ€æ­»å®¹å™¨ã€‚\n6. è¿è¡Œå·²åœæ­¢çš„å®¹å™¨\ndocker start <CONTAINER ID>\n7. åˆ é™¤å®¹å™¨\ndocker rm \\<CONTAINER ID>\n8. åˆ é™¤é•œåƒ\ndocker rmi \\<IMAGE ID>\n9. æ˜¾ç¤ºæ‰€æœ‰å®¹å™¨id\ndocker ps -aq\n10. åœæ­¢æ‰€æœ‰å®¹å™¨\ndocker stop $(docker ps -aq)\n11. åˆ é™¤æ‰€æœ‰å®¹å™¨\ndocker rm $(docker ps -aq)\n12. åˆ é™¤æ‰€æœ‰é•œåƒ\ndocker rmi $(docker images -q)\n13. å¤åˆ¶å®¹å™¨å†…å†…å®¹\ndocker cp mycontainer:/opt/file.txt /opt/local/docker\n\n\n\n\n\n');
INSERT INTO `blog_content` VALUES (34, '## å‰è¨€\næœ¬æ–‡ç« å†…å®¹æ¯”è¾ƒåŸºç¡€ï¼Œä¸ªäººå­¦ä¹ ä½¿ç”¨ï¼ˆå­¦åˆ°å¿ƒæ€çˆ†ç‚¸ï¼Œç™¾åº¦ä¸€å †è€æ—§æ“ä½œï¼Œä¸€å †å‘ï¼‰ï¼Œé…å¥—å®Œæ•´ä»£ç åœ°å€[Demo](https://github.com/yhuihu/SpringCloud)\n### Spring\næ˜¯ä¸€ä¸ªè½»é‡çº§çš„JAVAEEå¼€æºæ¡†æ¶ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¼ä¸šçº§å¼€å‘çš„å¤æ‚åº¦é—®é¢˜å¤æ‚åº¦->è€¦åˆåº¦\n\n### SpringBoot\næ–°ä¸€ä»£JAVAEEå¼€å‘æ ‡å‡†ï¼Œå¼€ç®±å³ç”¨çš„ç‰¹æ€§ï¼ˆä¸éœ€è¦è¿‡å¤šé…ç½®ï¼‰\n### å¾®æœåŠ¡æ¶æ„\næ›´å¥½çš„è¿›è¡Œåˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘ï¼Œæ‹†åˆ†å•ä½“åº”ç”¨ï¼Œå°†ä¸€ä¸ªåº”ç”¨æ‹†åˆ†æˆå¤šä¸ªæœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æ˜¯ä¸€ä¸ªå¯ä»¥ç‹¬ç«‹è¿è¡Œçš„é¡¹ç›®\n### åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘ä¸€å®šä¼šé‡åˆ°çš„é—®é¢˜\n1. å®¢æˆ·ç«¯å¦‚ä½•è®¿é—®\n2. æœåŠ¡é—´å¦‚ä½•é€šä¿¡\n3. æœåŠ¡å¦‚ä½•æ²»ç†\n4. æœåŠ¡æŒ‚äº†æ€ä¹ˆåŠ\n5. ç½‘ç»œæ˜¯ä¸å¯é çš„\n\n### è§£å†³æ–¹æ¡ˆ\nSpring Cloudæ˜¯ä¸€å¥—ç”Ÿæ€ï¼Œæ˜¯ä¸ºäº†è§£å†³å¾®æœåŠ¡æ¶æ„é‡åˆ°çš„é—®é¢˜ã€‚æƒ³è¦ç”¨Spring Cloudå¿…é¡»åŸºäºSpring Boot\n- Spring Cloud Netflixï¼ˆ18å¹´è¿›å…¥ç»´æŠ¤ï¼Œåœæ­¢æ›´æ–°ï¼‰\n- Apache Dubbo Zookeeper\n\n```\nDubboæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„JAVA RPCé€šä¿¡æ¡†æ¶\næœåŠ¡æ³¨å†Œäºå‘ç°ï¼ŒZookeeper\nAPIç½‘å…³ï¼Œæ²¡æœ‰ï¼Œå†æ‰¾ç¬¬ä¸‰æ–¹æˆ–è‡ªå·±å®ç°\n```\n- Spring Cloud Alibaba\n\n```\nSpring Cloud Alibaba è‡´åŠ›äºæä¾›å¾®æœåŠ¡å¼€å‘çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚\næ­¤é¡¹ç›®åŒ…å«å¼€å‘åˆ†å¸ƒå¼åº”ç”¨å¾®æœåŠ¡çš„å¿…éœ€ç»„ä»¶ï¼Œæ–¹ä¾¿å¼€å‘è€…é€šè¿‡ Spring Cloud ç¼–ç¨‹æ¨¡å‹è½»æ¾ä½¿ç”¨è¿™äº›ç»„ä»¶æ¥å¼€å‘åˆ†å¸ƒå¼åº”ç”¨æœåŠ¡ã€‚\nä¾æ‰˜ Spring Cloud Alibabaï¼Œæ‚¨åªéœ€è¦æ·»åŠ ä¸€äº›æ³¨è§£å’Œå°‘é‡é…ç½®ï¼Œå°±å¯ä»¥å°† Spring Cloud åº”ç”¨æ¥å…¥é˜¿é‡Œåˆ†å¸ƒå¼åº”ç”¨è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡é˜¿é‡Œä¸­é—´ä»¶æ¥è¿…é€Ÿæ­å»ºåˆ†å¸ƒå¼åº”ç”¨ç³»ç»Ÿã€‚\n```\n- ä¸‹ä¸€ä»£å¾®æœåŠ¡æ¶æ„æ ‡å‡† Service MeshæœåŠ¡ç½‘æ ¼(Istio)\n- å¼‚æ­¥éé˜»å¡é€šä¿¡\n\n```\nNetty -> NIOã€AIO\nHTTP -> åº”ç”¨å±‚ï¼Œè·¨é˜²ç«å¢™ï¼Œåœ¨ä¸åŒå±€åŸŸç½‘é—´é€šä¿¡\nRPC -> è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ŒTCPï¼ˆä¼ è¾“å±‚ï¼‰ \n        ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«\n        ç¼ºç‚¹ï¼šä¸èƒ½è·¨é˜²ç«å¢™ï¼Œä»…æ”¯æŒå±€åŸŸç½‘é€šä¿¡\n```\n\n### ä¸‹é¢ä¸ºä»£ç ç¯èŠ‚ï¼Œé¦–å…ˆè¯´æ˜å¯èƒ½é‡åˆ°çš„é—®é¢˜\nNacosåœ¨è¿›è¡ŒæœåŠ¡å‘ç°ä¸æ³¨å†Œçš„æ—¶å€™æ‰«æçš„ä¼˜å…ˆé¡ºåºä¸æ˜¯application.ymlï¼Œæ‰€ä»¥åœ¨è¿è¡Œçš„æ—¶å€™å¯èƒ½ä¼šå‡ºç°å‡ æ¬¡Nacosé…ç½®æ–‡ä»¶å­˜åœ¨é—®é¢˜çš„æƒ…å†µï¼Œä¸éœ€è¦ç†ä¼šï¼Œåœ¨æœ€ç»ˆå‡ºç°nacos registry, xxxx register finishedå³å¯é»˜è®¤æ³¨å†ŒæˆåŠŸï¼Œåœ¨Nacoså®¢æˆ·ç«¯æœåŠ¡åˆ—è¡¨å¯ä»¥æŸ¥çœ‹åˆ°ä¿¡æ¯ã€‚\n\n### ä»£ç ä¸å¤šä»‹ç»äº†ï¼Œéƒ½åœ¨githubä¸Šï¼Œä½¿ç”¨ä¸Šéƒ½æŒºç®€å•çš„ï¼Œè®²ä¸€ä¸‹æ“ä½œé¡ºåºä»¥åŠæ³¨æ„äº‹é¡¹\n1. åˆ›å»ºç»Ÿä¸€ä¾èµ–\n2. å®‰è£…Nacosï¼ˆæœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒï¼Œå®‰è£…çœ‹å®˜æ–¹æ–‡æ¡£ï¼‰[Nacos](https://nacos.io/zh-cn/docs/what-is-nacos.html)\n3. åˆ›å»ºæœåŠ¡æä¾›è€…\nåªéœ€æ³¨æ„ä¸€ä¸‹ymlçš„é…ç½®ï¼ŒControlleré‚£äº›å’Œä¹‹å‰ä¸€æ ·\n```Java\nserver:\n  //å¦‚æœæƒ³æµ‹è¯•è´Ÿè½½å‡è¡¡åªéœ€è¦å°†portæ¢ä¸€ä¸ªå¯åŠ¨å¤šä¸€ä¸ªç‰ˆæœ¬å°±è¡Œäº†\n  port: 8081\nspring:\n  application:\n    name: nacos-provider\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"\n```\n\n> æä¸€ä¸‹é…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºï¼šbootstrap.properties->bootstrap.yml->application.properties->application.yml\n\n4. åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…ï¼ˆæœ¬æ¡ˆä¾‹æåˆ°åŸå§‹çš„LoadBalanceClient å’Œ RestTemplate ç»“åˆçš„æ–¹å¼è¿˜æœ‰Feignæ–¹å¼ï¼‰\n\n```Java\n//LoadBalanceClientæ–¹å¼\nspring:\n  application:\n    name: nacos-consumer\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\nserver:\n  port: 9091\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"\n\n@Configuration\npublic class NacosConsumerConfiguration {\n\n    @Bean\n    public RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n}\n\n@RestController\npublic class ConsumerController {\n\n    @Autowired\n    private LoadBalancerClient loadBalancerClient;\n\n    @Autowired\n    private RestTemplate restTemplate;\n\n    @Value(\"${spring.application.name}\")\n    private String appName;\n\n    @GetMapping(value = \"/echo/app/name\")\n    public String echo() {\n        //ä½¿ç”¨ LoadBalanceClient å’Œ RestTemplate ç»“åˆçš„æ–¹å¼æ¥è®¿é—®\n        ServiceInstance serviceInstance = loadBalancerClient.choose(\"nacos-provider\");\n        String url = String.format(\"http://%s:%s/hello/%s\", serviceInstance.getHost(), serviceInstance.getPort(), appName);\n        return restTemplate.getForObject(url, String.class);\n    }\n}\n```\n\n```Java\n//Feignæ–¹å¼\nspring:\n  application:\n    name: nacos-consumer-feign\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\nserver:\n  port: 9092\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"\nfeign:\n  sentinel:\n    enabled: true\n\n@FeignClient(value = \"nacos-provider\")\npublic interface EchoService {\n    @GetMapping(value = \"/hello/{message}\")\n    String hello(@PathVariable(\"message\") String message);\n}\n\n\n@RestController\npublic class ConsumerController {\n\n    @Autowired\n    private EchoService echoService;\n    @Value(value =\"${spring.application.name}\")\n    private String name;\n    @GetMapping(value = \"/echo/hi\")\n    public String echo() {\n        return echoService.hello(\"Hi Feign\"+name);\n    }\n}\n```\n\n5. ç†”æ–­å™¨é…ç½®sentinel(æœåŠ¡æŒ‚äº†æ€ä¹ˆåŠ)\nè¿™é‡Œä»¥Feignä¸ºä¾‹å­è¯´æ˜\n\n```Java\nspring:\n  application:\n    name: nacos-consumer-feign\n  cloud:\n    //è¿™é‡Œä¸ºæ–°åŠ å†…å®¹\n    sentinel:\n      transport:\n        port: 8719\n        dashboard: localhost:8080\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n\nserver:\n  port: 9092\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"\nfeign:\n  sentinel:\n    enabled: true\n\n//ç¼–å†™fallback\n@Component\npublic class EchoServiceFallBack implements EchoService {\n    @Override\n    public String hello(String message) {\n        return \"è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ\";\n    }\n}\n\n//åªéœ€è¦åœ¨FeignClientä¸­åŠ ä¸€ä¸ªfallbackçš„é…ç½®å°±å¯ä»¥çœ‹åˆ°æ•ˆæœï¼Œå…·ä½“æµ‹è¯•æ–¹æ³•ä¸ºå°†æœåŠ¡æä¾›è€…åœæ‰å†è®¿é—®\n@FeignClient(value = \"nacos-provider\",fallback = EchoServiceFallBack.class)\npublic interface EchoService {\n\n    @GetMapping(value = \"/hello/{message}\")\n    String hello(@PathVariable(\"message\") String message);\n}\n```\n\n6. å®‰è£…ç†”æ–­å™¨ä»ªè¡¨ç›˜ç›‘æ§ï¼ˆæœ¬æ¥æƒ³åœ¨CentOSä¸‹å¼„çš„ï¼Œå¯æ˜¯å‘ç°å¼„äº†å‡ æ¬¡éƒ½ä¸è¡Œï¼Ÿï¼‰\nå¯åŠ¨å‘½ä»¤ï¼ˆå¯ä»¥è‡ªè¡ŒæŒ‡å®šç«¯å£å·ï¼‰ï¼šjava -Dserver.port=8080 -Dcsp.sentinel.dashboard.server=localhost:8080 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard.jar\n\n7. åˆ›å»ºSpring Cloud Gatewayç½‘å…³å¹¶è®¾ç½®è¿‡æ»¤å™¨ï¼ˆé›†æˆäº†webfluxï¼Œä¸è¦å•ç‹¬å†é…ç½®mvcï¼Œä¼šå‘ç”Ÿå†²çªã€‚ç”±ç½‘å…³æ§åˆ¶åæ‰€æœ‰æ¶ˆè´¹è€…å¯ä»¥é€šè¿‡åŒä¸€ä¸ªç«¯å£+æœåŠ¡åçš„æ–¹å¼è®¿é—®ï¼‰\n```Java\n//é…ç½®æ–‡ä»¶å¤ªå¤šå°±ä¸å‘äº†ï¼Œæœ‰å…´è¶£å¯ä»¥åˆ°githubä¸Šçœ‹\n@Component\npublic class AuthFilter implements GlobalFilter, Ordered {\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        //spring5çš„æ—¶å€™webfluxå°†httpServletRequestæ”¹äº†\n        //æŸ¥è¯¢ç¬¬ä¸€ä¸ªå‚æ•°åä¸ºtokençš„å­—æ®µå†…å®¹\n        String token = exchange.getRequest().getQueryParams().getFirst(\"token\");\n\n        if (token == null || token.isEmpty()) {\n            ServerHttpResponse response = exchange.getResponse();\n\n            // å°è£…é”™è¯¯ä¿¡æ¯\n            //googleçš„guava.jaræä¾›çš„å†™æ³•ï¼Œç›®çš„æ˜¯ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œä¸éœ€è¦ä½ æ‰‹åŠ¨å†™æ³›å‹ã€‚\n            Map<String, Object> responseData = Maps.newHashMap();\n            responseData.put(\"code\", HttpStatus.UNAUTHORIZED);\n            responseData.put(\"message\", \"éæ³•è¯·æ±‚\");\n            responseData.put(\"cause\", \"Token is empty\");\n\n            try {\n                // å°†ä¿¡æ¯è½¬æ¢ä¸º JSON\n                ObjectMapper objectMapper = new ObjectMapper();\n                byte[] data = objectMapper.writeValueAsBytes(responseData);\n\n                // è¾“å‡ºé”™è¯¯ä¿¡æ¯åˆ°é¡µé¢\n                DataBuffer buffer = response.bufferFactory().wrap(data);\n                response.setStatusCode(HttpStatus.UNAUTHORIZED);\n                response.getHeaders().add(\"Content-Type\", \"application/json;charset=UTF-8\");\n                return response.writeWith(Mono.just(buffer));\n            } catch (JsonProcessingException e) {\n                e.printStackTrace();\n            }\n        }\n\n        return chain.filter(exchange);\n    }\n\n    @Override\n    public int getOrder() {\n        return Ordered.LOWEST_PRECEDENCE;\n    }\n}\n```\n\n8. åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒç®¡ç†\n	1. å¦‚ä½•åœ¨æœåŠ¡ç«¯è®¾ç½®æ‰€éœ€è¦çš„é…ç½®\n	![å¾®ä¿¡æˆªå›¾_20190905095204.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ncJq7N0nyACBLYUcG0PErdKR)\n	![å¾®ä¿¡æˆªå›¾_20190905105429.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/hUkXS8TDeIE90DqmJ7UYSaPt)\n	2. å¦‚ä½•åœ¨å®¢æˆ·ç«¯ä¸­ä½¿ç”¨è¿™äº›é…ç½®ï¼ˆæ•²é»‘æ¿ï¼Œç”±äºé…ç½®æ–‡ä»¶åŠ è½½é¡ºåºçš„é—®é¢˜ï¼Œå¿…é¡»å°†ä¸€ä¸‹å†…å®¹å†™åˆ°bootstrap.ymlä¸­ï¼Œå¦‚æœè¿˜æ˜¯æ²¡ç”¨ï¼Œé‚£å°±å†™åˆ°bootstrap.propertiesä¸­ï¼Œä¸Šé¢æœ‰æåˆ°springé…ç½®æ–‡ä»¶åŠ è½½é¡ºåºï¼‰\n	```Java\n	spring.application.name=nacos-provider\n	# æŒ‡å®šæŸ¥æ‰¾åä¸º nacos-provider.properties çš„é…ç½®æ–‡ä»¶\n	spring.cloud.nacos.config.file-extension=properties\n	# Nacos Server çš„åœ°å€\n	spring.cloud.nacos.config.server-addr=localhost:8848\n	```\n	\n	æˆåŠŸæ ‡å¿—\n	![å¾®ä¿¡æˆªå›¾_20190905105609.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/KGqMSjEU3Ds11fCpbIf52iAS)\n	3.å¦‚ä½•è·å–ç¯å¢ƒé‡Œçš„æœ€æ–°å€¼ï¼Ÿ\n	ä¼ ç»Ÿçš„æ–¹æ³•æ˜¯@Value(\"${xxx}\")ï¼Œå¯æ˜¯è¿™æ ·è·å–çš„æ˜¯ä¸ä¼šå†å˜åŒ–çš„äº†\n	```Java\n	@Autowired\n    private ConfigurableApplicationContext applicationContext;\n	@GetMapping(\"/environment\")\n    public String test(){\n        return applicationContext.getEnvironment().getProperty(\"user.name\");\n    }\n	//è¿™æ ·å°±å¯ä»¥å®ç°åŠ¨æ€åˆ·æ–°äº†\n	``` \n	![å¾®ä¿¡æˆªå›¾_20190905110522.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/vOVXNgVz7oXlV16ExdsxuiSo)\n\n\n\n### spring-cloud-alibabaæ•´åˆdubbo è¾¾åˆ°å¯¹å†…RPC\n1. Dubboä»‹ç»\n	- [Dubbo](http://dubbo.apache.org/zh-cn/docs/user/preface/background.html)\n\n2. éœ€è¦æ–°åŠ å…¥çš„å†…å®¹\n```Java\n	   <dependency>\n                <groupId>org.apache.dubbo</groupId>\n                <artifactId>dubbo-registry-nacos</artifactId>\n                <version>${dubbo.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.alibaba</groupId>\n                <artifactId>dubbo-registry-nacos</artifactId>\n                <version>${dubbo-registry-nacos.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.apache.dubbo</groupId>\n                <artifactId>dubbo-spring-boot-actuator</artifactId>\n                <version>${dubbo.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.apache.dubbo</groupId>\n                <artifactId>dubbo</artifactId>\n                <version>${dubbo.version}</version>\n                <exclusions>\n                    <exclusion>\n                        <groupId>org.springframework</groupId>\n                        <artifactId>spring</artifactId>\n                    </exclusion>\n                    <exclusion>\n                        <groupId>javax.servlet</groupId>\n                        <artifactId>servlet-api</artifactId>\n                    </exclusion>\n                    <exclusion>\n                        <groupId>log4j</groupId>\n                        <artifactId>log4j</artifactId>\n                    </exclusion>\n                </exclusions>\n            </dependency>\n            <dependency>\n                <groupId>org.apache.dubbo</groupId>\n                <artifactId>dubbo-serialization-kryo</artifactId>\n                <version>${dubbo.version}</version>\n                <exclusions>\n                    <exclusion>\n                        <groupId>log4j</groupId>\n                        <artifactId>log4j</artifactId>\n                    </exclusion>\n                    <exclusion>\n                        <groupId>org.apache.dubbo</groupId>\n                        <artifactId>dubbo-common</artifactId>\n                    </exclusion>\n                </exclusions>\n            </dependency>\n```\n\n3. æœåŠ¡æä¾›è€…æ“ä½œï¼Œå°†APIä¸å…·ä½“å®ç°åŒºåˆ†å¼€\n![å¾®ä¿¡æˆªå›¾_20190909122713.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/NPNZfHEvkK7TSyjKu7znzOJq)\n![å¾®ä¿¡æˆªå›¾_20190909122731.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/Hgjhba0fqojfXgQklXjbzhvr)\néœ€è¦æ³¨æ„ï¼Œè¿™é‡Œçš„@serviceæ³¨è§£ä½¿ç”¨çš„æ˜¯dubboæä¾›çš„ï¼Œå‚æ•°å¿…é¡»åŠ ä¸Šversion\n\n4. æœåŠ¡æ¶ˆè´¹è€…æ“ä½œ\n![å¾®ä¿¡æˆªå›¾_20190909122853.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/6efRT7GYQTVbg1OAeYKgAlJV)\n@Referenceæ³¨è§£ç”¨äºæŒ‡å®šç‰ˆæœ¬å·ï¼Œå¯¹åº”æä¾›è€…çš„serviceæ³¨è§£ä¸­çš„version\n\n\n### Dubboå®ç°é«˜é€Ÿåºåˆ—åŒ–\nDubbo RPCæ˜¯Dubboä½“ç³»ä¸­æœ€æ ¸å¿ƒçš„ä¸€ç§é«˜æ€§èƒ½ï¼Œé«˜ååé‡çš„è¿œç¨‹è°ƒç”¨æ–¹å¼ï¼Œå¯ä»¥ç§°ä¹‹ä¸ºå¤šè·¯å¤ç”¨çš„TCPé•¿è¿æ¥è°ƒç”¨ï¼ˆç¢°åˆ°äº†å†è¯´ä¸‹UDPï¼ŒUDPæ˜¯å¹¿æ’­ï¼Œæ— è¿æ¥ï¼Œå‘äº†å¤§å®¶éƒ½ä¼šæœ‰ï¼Œå¯æ˜¯æ”¶ä¸æ”¶è¿˜æ˜¯å¾—çœ‹è‡ªå·±ï¼‰ï¼š\n- é•¿è¿æ¥ï¼šé¿å…äº†æ¯æ¬¡è°ƒç”¨æ–°å»ºTCPè¿æ¥ï¼Œæé«˜äº†è°ƒç”¨çš„å“åº”é€Ÿåº¦\n- HTTPæ˜¯å•è·¯çš„ï¼Œæ¯æ¬¡è®¿é—®éƒ½æ˜¯ä¸€ä¸ªè¿æ¥\n- å¤šè·¯å¤ç”¨å•ä¸ªTCPè¿æ¥å¯äº¤æ›¿ä¼ è¾“å¤šä¸ªè¯·æ±‚å’Œå“åº”çš„æ¶ˆæ¯ï¼Œé™ä½äº†è¿æ¥çš„ç­‰å¾…é—²ç½®æ—¶é—´ï¼Œä»è€Œå‡å°‘äº†åŒæ ·å¹¶å‘æ•°ä¸‹çš„ç½‘ç»œè¿æ¥æ•°ï¼Œæé«˜äº†ç³»ç»Ÿååé‡\n\nDubbo RPCä¸»è¦ç”¨äºä¸¤ä¸ªDubboç³»ç»Ÿä¹‹é—´çš„è¿œç¨‹è°ƒç”¨ï¼Œç‰¹åˆ«é€‚åˆé«˜å¹¶å‘ï¼Œå°æ•°æ®çš„äº’è”ç½‘åœºæ™¯ã€‚è€Œåºåˆ—åŒ–å¯¹äºè¿œç¨‹è°ƒç”¨çš„å“åº”é€Ÿåº¦ã€ååé‡ã€ç½‘ç»œå¸¦å®½æ¶ˆè€—ç­‰åŒæ ·ä¹Ÿèµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œæ˜¯æˆ‘ä»¬æå‡åˆ†å¸ƒå¼ç³»ç»Ÿæ€§èƒ½çš„æœ€å…³é”®çš„å› ç´ ä¹‹ä¸€ã€‚\n\nDubboä¸­æ”¯æŒçš„åºåˆ—åŒ–æ–¹å¼ï¼š\n1. dubboåºåˆ—åŒ–ï¼šä¸å»ºè®®ä½¿ç”¨\n2. hessian2åºåˆ—åŒ–ï¼šdubbo RPCé»˜è®¤å¯ç”¨çš„åºåˆ—åŒ–æ–¹å¼ï¼ˆä¸æ˜¯åŸç”Ÿçš„ï¼Œæ˜¯ç»è¿‡é˜¿é‡Œä¿®æ”¹è¿‡çš„ï¼‰\n3. jsonåºåˆ—åŒ–ï¼šfastjsonï¼Œdubboè‡ªå·±å®ç°çš„ç®€å•çš„jsonåº“ï¼Œéƒ½ä¸æ˜¯ç‰¹åˆ«æˆç†Ÿï¼Œæ€§èƒ½ä¸€èˆ¬ï¼Œä¸å¦‚ä¸Šé¢çš„ä¸¤ç§\n4. javaåºåˆ—åŒ–ï¼šJDKè‡ªå¸¦çš„åºåˆ—åŒ–ï¼Œæ€§èƒ½ä¹Ÿä¸€èˆ¬\n\n#### ä¸“é—¨é’ˆå¯¹Javaè¯­è¨€çš„åºåˆ—åŒ–æ–¹å¼ï¼šKryo\næ•´åˆè‡³éœ€è¦åŠ å…¥\n```Java\n            <dependency>\n                <groupId>org.apache.dubbo</groupId>\n                <artifactId>dubbo-serialization-kryo</artifactId>\n                <version>${dubbo-kryo.version}</version>\n                <exclusions>\n                    <exclusion>\n                        <groupId>log4j</groupId>\n                        <artifactId>log4j</artifactId>\n                    </exclusion>\n                    <exclusion>\n                        <groupId>org.apache.dubbo</groupId>\n                        <artifactId>dubbo-common</artifactId>\n                    </exclusion>\n                </exclusions>\n            </dependency>\n```\n\n### Dubboè´Ÿè½½å‡è¡¡\n#### æ¦‚è¿°\né›†ç¾¤è´Ÿè½½å‡è¡¡çš„æ—¶å€™ï¼ŒDubboæä¾›äº†å››ç§ç­–ç•¥\n1. éšæœº\nRandom LoadBalanceï¼šæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ï¼Œåœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼ˆé»˜è®¤ä½¿ç”¨è¿™ç§ç­–ç•¥ï¼‰\n2. è½®è¯¢\nRoundRobin LoadBalanceï¼šæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®è¯¢æ¯”ç‡ï¼Œå­˜åœ¨æ…¢çš„æä¾›è€…ç´¯è®¡è¯·æ±‚çš„é—®é¢˜ã€‚æ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šï¼ˆnacosé»˜è®¤å®ç°ï¼‰\n3. æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°\nLeastActive LoadBalanceï¼šç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ï¼Œä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚\n4. ä¸€è‡´æ€§ Hash\nConsistentHash LoadBalanceï¼šç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°ç»Ÿä¸€æä¾›è€…ã€‚å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹Ÿç»“ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶ä»–æä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚\n\n#### å¦‚ä½•é…ç½®è´Ÿè½½å‡è¡¡\nåœ¨ymlä¸­é…ç½®dubbo.provider.loadbalance:\nå¯ä»¥é…ç½®çš„å€¼åˆ†åˆ«æ˜¯ï¼šrandomï¼Œroundrobinï¼Œleastactiveï¼Œconsistenthash\n\n#### å¤–éƒ¨åŒ–é…ç½®\nä¹Ÿå°±æ˜¯ä½¿ç”¨nacosä½œä¸ºé…ç½®ç®¡ç†ä¸­å¿ƒï¼Œå…·ä½“ä»£ç çœ‹demoï¼Œå’Œä¸Šé¢çš„å•çº¯çš„spring-cloud-alibabaæ˜¯ä¸€æ ·çš„ã€‚\n\n\n### demoåœ°å€\n[spring-cloud-alibaba-dubbo](https://github.com/yhuihu/spring-cloud-alibaba-dubbo)\n');
INSERT INTO `blog_content` VALUES (35, '## è¯´æ˜ \næœ¬æ–‡ä»¥æœ¬ç½‘ç«™ä½œä¸ºæ¡ˆä¾‹è¿›è¡Œè¯´æ˜\n### SpringBootåç«¯ç³»ç»Ÿçš„æ‰“åŒ…ä»¥åŠéƒ¨ç½²\n- æ‰“åŒ…é¡¹ç›®æˆjaråŒ…(ç”±äºé¡¹ç›®ä¸ºä¸ªäººé¡¹ç›®ï¼Œæ‰€æœ‰è¡Œä¸ºç›´æ¥æ“ä½œä¸ªäººæœåŠ¡å™¨ï¼Œæ²¡æœ‰é…ç½®å¤šä¸ªé…ç½®æ–‡ä»¶)\n\n> IDEAæ“ä½œ\n\n![å¾®ä¿¡å›¾ç‰‡ç¼–è¾‘_20190826162745.jpg](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/TnfgL1LWc3N5F5CsqaWVGkbz)\n> æˆåŠŸæ ‡å¿—\n\n![å¾®ä¿¡å›¾ç‰‡_20190826162156.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/GEDZZj389uyvF0p6rZj8ccCw)\n\n> å‘½ä»¤è¡Œæ“ä½œ\n\nç§»åŠ¨åˆ°é¡¹ç›®ç›®å½•\nmvn clean package -Dmaven.test.skip=true\n![å¾®ä¿¡å›¾ç‰‡_20190826163135.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/03qeA9C8wDtp6O9Bkuytr1aA)\nåœ¨xshellä¸­ä½¿ç”¨rzå‘½ä»¤ä¸Šä¼ jaråŒ…(å¦‚æœé‡åˆ°rzæ— æ³•ä½¿ç”¨çš„æƒ…å†µå°±å…ˆæ‰§è¡Œyum install lrzszå®‰è£…ä¾èµ–)\n![å¾®ä¿¡å›¾ç‰‡_20190826163223.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/OljD06SVxfPDoQVv2jJfw8VM)\nåå°å¯åŠ¨jaråŒ…\nnohup java -jar blog-back-0.0.1-SNAPSHOT.jar &\næ­¤æ—¶å¯ä»¥åœ¨ç›¸åŒç›®å½•ä¸‹çœ‹åˆ°nohup.outï¼ŒjaråŒ…æ‰€æœ‰æ—¥å¿—éƒ½åœ¨é‡Œé¢\n\n### VUEé¡¹ç›®æ‰“åŒ…éƒ¨ç½²\n\nç›´æ¥ä½¿ç”¨npm run buildè¿›è¡Œæ‰“åŒ…\n> å¯èƒ½é‡åˆ°çš„é—®é¢˜ä»¥åŠæ³¨æ„äº‹é¡¹\n\n- buildä¹‹å‰è¯·ç¡®ä¿èƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå¦‚æœåœ¨buildçš„æ—¶å€™å‡ºç°é”™è¯¯ï¼Œå¯ä»¥å°è¯•å°†node_modulesæ–‡ä»¶å¤¹åˆ é™¤é‡æ–°æ‰§è¡Œnpm installï¼Œæ­¤å¤„å»ºè®®ä½¿ç”¨cnpm installï¼Œæœ¬äººåœ¨ä½¿ç”¨npm installå‡ºç°è¿‡åŒ…æŸåçš„æƒ…å†µã€‚\n- åœ¨è¯¥æ¡ˆä¾‹ä¸­VUEçš„éƒ¨ç½²æ˜¯ä½¿ç”¨expresså’Œpm2å®Œæˆçš„ï¼Œå› æ­¤ä¸ç”¨ä¿®æ”¹assetsPublicPathï¼\n- å¦‚æœæœ‰äººå‡ºç°é—®é¢˜æ­¤å¤„ä¼šç»§ç»­è¡¥å……\n\næ‰“åŒ…å®Œæˆåç›¸åŒç›®å½•ä¸‹ä¼šå‡ºç°distæ–‡ä»¶å¤¹\nåœ¨ç›®å½•ä¸­æ–°å»ºapp.jsæ–‡ä»¶ï¼Œå°†ä¸¤å†…å®¹ä¸€èµ·æ‰“åŒ…æˆå‹ç¼©åŒ…ä¸Šä¼ æœåŠ¡å™¨\n```\nconst fs = require(\'fs\'); //æ–‡ä»¶æ¨¡å—\nconst path = require(\'path\'); //è·¯å¾„æ¨¡å—\nconst express = require(\'express\'); //expressæ¡†æ¶æ¨¡å—\nconst app = express();\nconst hostName = \'localhost\'; //ip\nconst port = 8002; //ç«¯å£\napp.use(express.static(path.resolve(__dirname, \'./dist\'))); // è®¾ç½®é™æ€ç›®å½•(ä¾‹ï¼šapp.jsåœ¨demoç›®å½•ä¸‹ï¼Œé‚£ä¹ˆç›®å½•åˆ™ä¸ºdemo/dist)ã€‚\napp.get(\'*\', function (req, res) {\n  const html = fs.readFileSync(path.resolve(__dirname, \'./dist/index.html\'), \'utf-8\'); // è®¾ç½®æ‰€æœ‰è®¿é—®æœåŠ¡è¯·æ±‚é»˜è®¤è¿”å›index.htmlæ–‡ä»¶\n  res.send(html);\n});\napp.listen(port, hostName, function () {\n  console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨http://${hostName}:${port}`);\n```\n![å¾®ä¿¡å›¾ç‰‡_20190826164451.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/DKUN166zjiloUQHDQCyX3Ij5)\n\n- æ­¤åæ“ä½œéœ€è¦å…ˆåœ¨æœåŠ¡å™¨ä¸Šå®‰è£…node(è‡ªè¡Œç™¾åº¦)\n\nåœ¨app.js+distçš„ç›®å½•ä¸‹æ‰§è¡Œnpm initï¼Œä¸€è·¯å›è½¦åˆ°åº•\n![å¾®ä¿¡å›¾ç‰‡_20190826174658.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ozOBwAocnqrE675n6d9eysun)\n- é¡¹ç›®å®‰è£…expressæ¡†æ¶\ncnpm install express --save\n\næ­¤æ—¶é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚å›¾\n![å¾®ä¿¡å›¾ç‰‡_20190826175009.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/YNnTEZpuKN9MAiY6dZpOYxz4)\n- å¯åŠ¨é¡¹ç›®(pm2æ‰˜ç®¡æ–¹å¼)\npm2å®‰è£…npm install pm2 -g\n\npm2 start app.js --name xxx\nåé¢çš„--name xxxç”¨äºæŒ‡å®šè¯¥appçš„åç§°ï¼Œç±»ä¼¼äºdockerï¼Œå¯ä»¥ä¸æŒ‡å®šï¼Œç›´æ¥ç”¨pm2 start app.js\n![å¾®ä¿¡å›¾ç‰‡_20190826175145.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/jRrPJgAP0pRWSSzzHapjvLxj)\n\n- å¦‚æœæƒ³è¦ä½¿ç”¨åå‘ä»£ç†å¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ï¼Œå¦åˆ™å·²ç»å¯ä»¥æ­£å¸¸è¿è¡Œäº†\nå¦‚æœä¸ä½¿ç”¨åå‘ä»£ç†ï¼Œè®¿é—®çš„æ–¹å¼åº”è¯¥ä¸ºï¼šwww.xxx.xxx:ç«¯å£å·ï¼Œå¦‚æœä½¿ç”¨æ–¹å‘ä»£ç†ï¼Œåˆ™å¯ä»¥å°†æŸä¸ªåŸŸåè½¬å‘åˆ°ç‰¹å®šç«¯å£ä¸Šé¢ï¼Œä»è€Œè¾¾åˆ°çœç•¥ç«¯å£å·è®¿é—®ã€‚\n\nåœ¨æ­¤ä½¿ç”¨nginxä½œä¸ºæ–¹å‘ä»£ç†å·¥å…·ï¼Œå®‰è£…ç›´æ¥yumå®‰è£…å°±å¥½äº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚\nå®‰è£…å®Œæˆåå¯ä»¥åœ¨/etc/nginxä¸‹çœ‹åˆ°nginx.confé…ç½®æ–‡ä»¶\n![å¾®ä¿¡å›¾ç‰‡_20190826192950.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/IJyETkUVYDlsqfmm4JovM7Er)');
INSERT INTO `blog_content` VALUES (36, '### ä¸€ã€Javaå¤šçº¿ç¨‹å®ç°çš„å‡ ç§æ–¹å¼\n1. ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹ç±»\n\n\n```\npublic class study {\n    //1.å®šä¹‰ä¸€ä¸ªç»§æ‰¿Threadçš„å­ç±»\n    public static class testThread extends Thread {\n        int i=0;\n        testThread(String name) {\n            super(name);\n        }\n\n        //2.é‡å†™Threadçš„run()æ–¹æ³•\n        @Override\n        public void run() {\n            for (; i < 100; i++)\n                System.out.println(\"æˆ‘æ˜¯çº¿ç¨‹:\" + Thread.currentThread().getName() + \"----\" + i);\n        }\n    }\n\n    public static void main(String[] args) {\n        //3.åˆ›å»ºThreadå­ç±»å®ä¾‹\n        testThread thread1 = new testThread(\"1\");\n        testThread thread2 = new testThread(\"2\");\n        //4.å¯åŠ¨çº¿ç¨‹\n        thread1.start();\n        thread2.start();\n    }\n}\n```\n\n\n>è¿è¡Œä¸€éåå‘ç°çº¿ç¨‹1å’Œ2éƒ½å°†è¾“å‡º0-100ï¼Œå„çº¿ç¨‹æ•°æ®æ—¶ç‹¬ç«‹çš„\n\n2. å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹ç±»  \n\n\n```\n//1.å®šä¹‰Runnableæ¥å£å®ç°ç±»\nclass testRunnable implements Runnable {\n    private int i=0;\n    //  2.é‡å†™run()æ–¹æ³•\n    @Override\n    public void run() {\n        for(;i<100;i++){\n            System.out.println(i);\n        }\n    }\n}\n\npublic class study {\n\n    public static void main(String[] args) {\n        //3.åˆ›å»ºå®ä¾‹\n        testRunnable testRunnable=new testRunnable();\n        //4.å°†è¯¥å®ä¾‹ä½œä¸ºThreadçš„targetå¯¹è±¡\n        Thread thread=new Thread(testRunnable);\n        Thread thread1=new Thread(testRunnable);\n        //5.å¯åŠ¨çº¿ç¨‹\n        thread.start();\n        thread1.start();\n    }\n}\n```\n\n\n>è¿è¡Œåå¯ä»¥å‘ç°åªè¾“å‡º0-100ä¸­çš„æ•°å­—ä¸€éï¼Œè¯æ˜Runableæ˜¯å¯ä»¥å®ç°æ•°æ®å…±äº«çš„ï¼ˆå¤šä¸ªçº¿ç¨‹å…±äº«Threadè¿™ä¸ªRunableå¯¹è±¡ä»£ç ï¼‰\næ³¨æ„ï¼šè¿™æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå¤šè¿è¡Œå‡ æ¬¡å¯èƒ½ä¼šå‡ºç°æŸä¸ªæ•°å­—é‡å¤è¾“å‡ºçš„æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘äº’æ–¥é”\n\n3. é€šè¿‡Callableå’ŒFutureåˆ›å»ºçº¿ç¨‹\n\n\n```\n//1.åˆ›å»ºCallableæ¥å£çš„å®ç°ç±»\nclass testCallable implements Callable<Integer> {\n    private int i = 0;\n    //2.å®ç°callæ–¹æ³•\n    @Override\n    public Integer call() throws Exception {\n        int sum = 0;\n        for (; i < 100; i++) {\n            System.out.println(Thread.currentThread().getName() + \" \" + i);\n            sum += i;\n        }\n        return sum;\n    }\n}\n\npublic class study {\n\n    public static void main(String[] args) {\n        //3.åˆ›å»ºtestCallableå¯¹è±¡\n        Callable<Integer> testCallable=new testCallable();\n        //4.ç”±Callableåˆ›å»ºä¸€ä¸ªFutureTaskå¯¹è±¡\n        FutureTask<Integer> ft = new FutureTask<Integer>(testCallable);\n        for (int i = 0; i < 100; i++) {\n            System.out.println(Thread.currentThread().getName() + \" \" + i);\n            if (i == 30) {\n                //5.ç”±FutureTaskåˆ›å»ºä¸€ä¸ªThreadå¯¹è±¡\n                Thread thread = new Thread(ft);\n                //6.çº¿ç¨‹è¿›å…¥åˆ°å°±ç»ªçŠ¶æ€\n                thread.start();\n            }\n        }\n        System.out.println(\"ä¸»çº¿ç¨‹forå¾ªç¯æ‰§è¡Œå®Œæ¯•..\");\n        try {\n            int sum = ft.get();            //å–å¾—æ–°åˆ›å»ºçš„æ–°çº¿ç¨‹ä¸­çš„call()æ–¹æ³•è¿”å›çš„ç»“æœ\n            System.out.println(\"sum = \" + sum);\n        } catch (InterruptedException | ExecutionException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n\n### äºŒã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ\n![å›¾è§£](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/LIHsiIkUz5NMhXqUO2pAJBGA)\n\n1. æ–°å»ºçŠ¶æ€\nç”¨newå…³é”®å­—å’ŒThreadç±»æˆ–å…¶å­ç±»å»ºç«‹ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åï¼Œè¯¥çº¿ç¨‹å¯¹è±¡å°±å¤„äºæ–°å»ºçŠ¶æ€ã€‚å¤„äºæ–°ç”ŸçŠ¶æ€çš„çº¿ç¨‹æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œé€šè¿‡è°ƒç”¨startæ–¹æ³•è¿›å…¥å°±ç»ªçŠ¶æ€ï¼ˆrunnableï¼‰ã€‚\n>æ³¨æ„ï¼šä¸èƒ½å¯¹å·²ç»å¯åŠ¨çš„çº¿ç¨‹å†æ¬¡è°ƒç”¨start()æ–¹æ³•ï¼Œå¦åˆ™ä¼šå‡ºç°IllegalThreadStateExceptionå¼‚å¸¸ã€‚\n2.  å°±ç»ªçŠ¶æ€\nå¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹å·²ç»å…·å¤‡äº†è¿è¡Œæ¡ä»¶ï¼Œä½†è¿˜æ²¡æœ‰åˆ†é…åˆ°CPUï¼Œå¤„äºçº¿ç¨‹å°±ç»ªé˜Ÿåˆ—ï¼ˆå°½ç®¡æ˜¯é‡‡ç”¨é˜Ÿåˆ—å½¢å¼ï¼Œäº‹å®ä¸Šï¼ŒæŠŠå®ƒç§°ä¸ºå¯è¿è¡Œæ± è€Œä¸æ˜¯å¯è¿è¡Œé˜Ÿåˆ—ã€‚å› ä¸ºcpuçš„è°ƒåº¦ä¸ä¸€å®šæ˜¯æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºæ¥è°ƒåº¦çš„ï¼‰ï¼Œç­‰å¾…ç³»ç»Ÿä¸ºå…¶åˆ†é…CPUã€‚ç­‰å¾…çŠ¶æ€å¹¶ä¸æ˜¯æ‰§è¡ŒçŠ¶æ€ï¼Œå½“ç³»ç»Ÿé€‰å®šä¸€ä¸ªç­‰å¾…æ‰§è¡Œçš„Threadå¯¹è±¡åï¼Œå®ƒå°±ä¼šä»ç­‰å¾…æ‰§è¡ŒçŠ¶æ€è¿›å…¥æ‰§è¡ŒçŠ¶æ€ï¼Œç³»ç»ŸæŒ‘é€‰çš„åŠ¨ä½œç§°ä¹‹ä¸ºâ€œcpuè°ƒåº¦â€ã€‚ä¸€æ—¦è·å¾—CPUï¼Œçº¿ç¨‹å°±è¿›å…¥è¿è¡ŒçŠ¶æ€å¹¶è‡ªåŠ¨è°ƒç”¨è‡ªå·±çš„runæ–¹æ³•ã€‚\n3. è¿è¡ŒçŠ¶æ€\nå¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹ï¼Œå¦‚æœè·å¾—äº†cpuçš„è°ƒåº¦ï¼Œå°±ä¼šä»å°±ç»ªçŠ¶æ€å˜ä¸ºè¿è¡ŒçŠ¶æ€ï¼Œæ‰§è¡Œrun()æ–¹æ³•ä¸­çš„ä»»åŠ¡ã€‚å¦‚æœè¯¥çº¿ç¨‹å¤±å»äº†cpuèµ„æºï¼Œå°±ä¼šåˆä»è¿è¡ŒçŠ¶æ€å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚é‡æ–°ç­‰å¾…ç³»ç»Ÿåˆ†é…èµ„æºã€‚ä¹Ÿå¯ä»¥å¯¹åœ¨è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹è°ƒç”¨yield()æ–¹æ³•ï¼Œå®ƒå°±ä¼šè®©å‡ºcpuèµ„æºï¼Œå†æ¬¡å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚\n\næ³¨ï¼š å½“å‘ç”Ÿå¦‚ä¸‹æƒ…å†µæ˜¯ï¼Œçº¿ç¨‹ä¼šä»è¿è¡ŒçŠ¶æ€å˜ä¸ºé˜»å¡çŠ¶æ€ï¼š\n\n- CPUæ‰§è¡Œç‰‡å·²ç»ç”¨å®Œï¼ŒJVMåˆ‡æ¢åˆ°å…¶ä»–çº¿ç¨‹æ‰§è¡Œ\n- çº¿ç¨‹è°ƒç”¨sleep()\n- çº¿ç¨‹è°ƒç”¨äº†é˜»å¡IOæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¹‹å‰ï¼Œçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡\n- çº¿ç¨‹è¯•å›¾è·å–è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰çš„åŒæ­¥ç›‘è§†å™¨\n- çº¿ç¨‹åœ¨ç­‰å¾…æŸä¸ªé€šçŸ¥ï¼ˆnotifyï¼‰\n- ç¨‹åºè°ƒç”¨äº†çº¿ç¨‹çš„suspend()å°†çº¿ç¨‹æŒ‚èµ·ã€‚ï¼ˆå®¹æ˜“æ­»é”ï¼Œä¸æ¨èï¼‰\n\n4. é˜»å¡çŠ¶æ€\nåœ¨é˜»å¡çŠ¶æ€çš„çº¿ç¨‹ä¸èƒ½è¿›å…¥å°±ç»ªé˜Ÿåˆ—ã€‚åªæœ‰å½“å¼•èµ·é˜»å¡çš„åŸå› æ¶ˆé™¤æ—¶ï¼Œå¦‚ç¡çœ æ—¶é—´å·²åˆ°ï¼Œæˆ–ç­‰å¾…çš„I/Oè®¾å¤‡ç©ºé—²ä¸‹æ¥ï¼Œçº¿ç¨‹ä¾¿è½¬å…¥å°±ç»ªçŠ¶æ€ï¼Œé‡æ–°åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…ï¼Œè¢«ç³»ç»Ÿé€‰ä¸­åä»åŸæ¥åœæ­¢çš„ä½ç½®å¼€å§‹ç»§ç»­è¿è¡Œã€‚\n5. æ­»äº¡çŠ¶æ€\nå½“çº¿ç¨‹çš„run()æ–¹æ³•æ‰§è¡Œå®Œï¼Œæˆ–è€…è¢«å¼ºåˆ¶æ€§åœ°ç»ˆæ­¢ï¼Œå°±è®¤ä¸ºå®ƒæ­»å»ã€‚è¿™ä¸ªçº¿ç¨‹å¯¹è±¡ä¹Ÿè®¸æ˜¯æ´»çš„ï¼Œä½†æ˜¯ï¼Œå®ƒå·²ç»ä¸æ˜¯ä¸€ä¸ªå•ç‹¬æ‰§è¡Œçš„çº¿ç¨‹ã€‚çº¿ç¨‹ä¸€æ—¦æ­»äº¡ï¼Œå°±ä¸èƒ½å¤ç”Ÿã€‚ å¦‚æœåœ¨ä¸€ä¸ªæ­»å»çš„çº¿ç¨‹ä¸Šè°ƒç”¨start()æ–¹æ³•ï¼Œä¼šæŠ›å‡ºjava.lang.IllegalThreadStateExceptionå¼‚å¸¸ã€‚\n\n### ä¸‰ã€çº¿ç¨‹ç®¡ç†\n1. çº¿ç¨‹ç¡çœ ---sleepæ–¹æ³•\nå¦‚æœæˆ‘ä»¬éœ€è¦è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œåˆ™å¯ä»¥é€šè¿‡è°ƒç”¨Threadçš„sleepæ–¹æ³•ã€‚\n\n>æ³¨æ„ï¼š\nï¼ˆ1ï¼‰sleepæ˜¯é™æ€æ–¹æ³•ï¼Œæœ€å¥½ä¸è¦ç”¨Threadçš„å®ä¾‹å¯¹è±¡è°ƒç”¨å®ƒï¼Œå› ä¸ºå®ƒç¡çœ çš„å§‹ç»ˆæ˜¯å½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Œè€Œä¸æ˜¯è°ƒç”¨å®ƒçš„çº¿ç¨‹å¯¹è±¡ï¼Œå®ƒåªå¯¹æ­£åœ¨è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹å¯¹è±¡æœ‰æ•ˆã€‚\nï¼ˆ2ï¼‰Javaçº¿ç¨‹è°ƒåº¦æ˜¯Javaå¤šçº¿ç¨‹çš„æ ¸å¿ƒï¼Œåªæœ‰è‰¯å¥½çš„è°ƒåº¦ï¼Œæ‰èƒ½å……åˆ†å‘æŒ¥ç³»ç»Ÿçš„æ€§èƒ½ï¼Œæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚ä½†æ˜¯ä¸ç®¡ç¨‹åºå‘˜æ€ä¹ˆç¼–å†™è°ƒåº¦ï¼Œåªèƒ½æœ€å¤§é™åº¦çš„å½±å“çº¿ç¨‹æ‰§è¡Œçš„æ¬¡åºï¼Œè€Œä¸èƒ½åšåˆ°ç²¾å‡†æ§åˆ¶ã€‚å› ä¸ºä½¿ç”¨sleepæ–¹æ³•ä¹‹åï¼Œçº¿ç¨‹æ˜¯è¿›å…¥é˜»å¡çŠ¶æ€çš„ï¼Œåªæœ‰å½“ç¡çœ çš„æ—¶é—´ç»“æŸï¼Œæ‰ä¼šé‡æ–°è¿›å…¥åˆ°å°±ç»ªçŠ¶æ€ï¼Œè€Œå°±ç»ªçŠ¶æ€è¿›å…¥åˆ°è¿è¡ŒçŠ¶æ€ï¼Œæ˜¯ç”±ç³»ç»Ÿæ§åˆ¶çš„ï¼Œæˆ‘ä»¬ä¸å¯èƒ½ç²¾å‡†çš„å»å¹²æ¶‰å®ƒï¼Œæ‰€ä»¥å¦‚æœè°ƒç”¨Thread.sleep(1000)ä½¿å¾—çº¿ç¨‹ç¡çœ 1ç§’ï¼Œå¯èƒ½ç»“æœä¼šå¤§äº1ç§’ã€‚\n\n2. çº¿ç¨‹è®©æ­¥-yield\nyield()æ–¹æ³•å’Œsleep()æ–¹æ³•æœ‰ç‚¹ç›¸ä¼¼ï¼Œå®ƒä¹Ÿæ˜¯Threadç±»æä¾›çš„ä¸€ä¸ªé™æ€çš„æ–¹æ³•ï¼Œå®ƒä¹Ÿå¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œè®©å‡ºcpuèµ„æºç»™å…¶ä»–çš„çº¿ç¨‹ã€‚ä½†æ˜¯å’Œsleep()æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è¿›å…¥åˆ°å°±ç»ªçŠ¶æ€ã€‚yield()æ–¹æ³•åªæ˜¯è®©å½“å‰çº¿ç¨‹æš‚åœä¸€ä¸‹ï¼Œé‡æ–°è¿›å…¥å°±ç»ªçš„çº¿ç¨‹æ± ä¸­ï¼Œè®©ç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦å™¨é‡æ–°è°ƒåº¦å™¨é‡æ–°è°ƒåº¦ä¸€æ¬¡ï¼Œå®Œå…¨å¯èƒ½å‡ºç°è¿™æ ·çš„æƒ…å†µï¼šå½“æŸä¸ªçº¿ç¨‹è°ƒç”¨yield()æ–¹æ³•ä¹‹åï¼Œçº¿ç¨‹è°ƒåº¦å™¨åˆå°†å…¶è°ƒåº¦å‡ºæ¥é‡æ–°è¿›å…¥åˆ°è¿è¡ŒçŠ¶æ€æ‰§è¡Œã€‚\n>å®é™…ä¸Šï¼Œå½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº†yield()æ–¹æ³•æš‚åœä¹‹åï¼Œä¼˜å…ˆçº§ä¸å½“å‰çº¿ç¨‹ç›¸åŒï¼Œæˆ–è€…ä¼˜å…ˆçº§æ¯”å½“å‰çº¿ç¨‹æ›´é«˜çš„å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ›´æœ‰å¯èƒ½è·å¾—æ‰§è¡Œçš„æœºä¼šï¼Œå½“ç„¶ï¼Œåªæ˜¯æœ‰å¯èƒ½ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¯èƒ½ç²¾ç¡®çš„å¹²æ¶‰cpuè°ƒåº¦çº¿ç¨‹ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š\n\n```\npublic class Test1 {  \n    public static void main(String[] args) throws InterruptedException {  \n        new MyThread(\"ä½çº§\", 1).start();  \n        new MyThread(\"ä¸­çº§\", 5).start();  \n        new MyThread(\"é«˜çº§\", 10).start();  \n    }  \n}  \n  \nclass MyThread extends Thread {  \n    public MyThread(String name, int pro) {  \n        super(name);// è®¾ç½®çº¿ç¨‹çš„åç§°  \n        this.setPriority(pro);// è®¾ç½®ä¼˜å…ˆçº§  \n    }  \n  \n    @Override  \n    public void run() {  \n        for (int i = 0; i < 30; i++) {  \n            System.out.println(this.getName() + \"çº¿ç¨‹ç¬¬\" + i + \"æ¬¡æ‰§è¡Œï¼\");  \n            if (i % 5 == 0)  \n                Thread.yield();  \n        }  \n    }  \n}\n```\n\n>æ³¨ï¼šå…³äºsleep()æ–¹æ³•å’Œyield()æ–¹çš„åŒºåˆ«å¦‚ä¸‹ï¼š\nâ‘ ã€sleepæ–¹æ³•æš‚åœå½“å‰çº¿ç¨‹åï¼Œä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œåªæœ‰å½“ç¡çœ æ—¶é—´åˆ°äº†ï¼Œæ‰ä¼šè½¬å…¥å°±ç»ªçŠ¶æ€ã€‚è€Œyieldæ–¹æ³•è°ƒç”¨å ï¼Œæ˜¯ç›´æ¥è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œæ‰€ä»¥æœ‰å¯èƒ½åˆšè¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œåˆè¢«è°ƒåº¦åˆ°è¿è¡ŒçŠ¶æ€ã€‚\nâ‘¡ã€sleepæ–¹æ³•å£°æ˜æŠ›å‡ºäº†InterruptedExceptionï¼Œæ‰€ä»¥è°ƒç”¨sleepæ–¹æ³•çš„æ—¶å€™è¦æ•è·è¯¥å¼‚å¸¸ï¼Œæˆ–è€…æ˜¾ç¤ºå£°æ˜æŠ›å‡ºè¯¥å¼‚å¸¸ã€‚è€Œyieldæ–¹æ³•åˆ™æ²¡æœ‰å£°æ˜æŠ›å‡ºä»»åŠ¡å¼‚å¸¸ã€‚\nâ‘¢ã€sleepæ–¹æ³•æ¯”yieldæ–¹æ³•æœ‰æ›´å¥½çš„å¯ç§»æ¤æ€§ï¼Œé€šå¸¸ä¸è¦ä¾é yieldæ–¹æ³•æ¥æ§åˆ¶å¹¶å‘çº¿ç¨‹çš„æ‰§è¡Œã€‚\n\n### æ€»ç»“\n\nå®ç°Runnableæ¥å£ç›¸æ¯”ç»§æ‰¿Threadç±»æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š\n\n1. å¯ä»¥é¿å…ç”±äºJavaçš„å•ç»§æ‰¿ç‰¹æ€§è€Œå¸¦æ¥çš„å±€é™ï¼›\n2. å¢å¼ºç¨‹åºçš„å¥å£®æ€§ï¼Œä»£ç èƒ½å¤Ÿè¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œä»£ç ä¸æ•°æ®æ˜¯ç‹¬ç«‹çš„ï¼›\n3. é€‚åˆå¤šä¸ªç›¸åŒç¨‹åºä»£ç çš„çº¿ç¨‹åŒºå¤„ç†åŒä¸€èµ„æºçš„æƒ…å†µã€‚\n\nå®ç°Runnableæ¥å£å’Œå®ç°Callableæ¥å£çš„åŒºåˆ«:\n1. Callableè§„å®šçš„æ–¹æ³•æ˜¯call(),Runnableè§„å®šçš„æ–¹æ³•æ˜¯run()\n2. Callableçš„ä»»åŠ¡æ‰§è¡Œåå¯è¿”å›å€¼ï¼Œè€ŒRunnableçš„ä»»åŠ¡æ˜¯ä¸èƒ½è¿”å›å€¼(æ˜¯void)\n3. callæ–¹æ³•å¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œrunæ–¹æ³•ä¸å¯ä»¥\n4. è¿è¡ŒCallableä»»åŠ¡å¯ä»¥æ‹¿åˆ°ä¸€ä¸ªFutureå¯¹è±¡ï¼Œè¡¨ç¤ºå¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚å®ƒæä¾›äº†æ£€æŸ¥è®¡ç®—æ˜¯å¦å®Œæˆçš„æ–¹æ³•ï¼Œä»¥ç­‰å¾…è®¡ç®—çš„å®Œæˆï¼Œå¹¶æ£€ç´¢è®¡ç®—çš„ç»“æœã€‚é€šè¿‡Futureå¯¹è±¡å¯ä»¥äº†è§£ä»»åŠ¡æ‰§è¡Œæƒ…å†µï¼Œå¯å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œï¼Œè¿˜å¯è·å–æ‰§è¡Œç»“æœã€‚\n5. åŠ å…¥çº¿ç¨‹æ± è¿è¡Œï¼ŒRunnableä½¿ç”¨ExecutorServiceçš„executeæ–¹æ³•ï¼ŒCallableä½¿ç”¨submitæ–¹æ³•ã€‚\n\n#### ä¸Šè¿°å‚è€ƒå¤šå¤„æ¦‚å¿µæ€»ç»“è€Œå‡ºï¼Œå¦‚æœéœ€è¦æ›´æ·±å±‚æ¬¡çš„ä½¿ç”¨ï¼Œå¯ä»¥çœ‹å‚è€ƒé“¾æ¥ä¸­çš„Javaå¤šçº¿ç¨‹è¯¦è§£\n## å‚è€ƒ\n[ javaå¤šçº¿ç¨‹â€”Threadã€Runnableå’ŒCallableåŒºåˆ«](https://blog.csdn.net/u012501054/article/details/80384996)\n\n[Javaå¤šçº¿ç¨‹è¯¦è§£](https://www.cnblogs.com/snow-flower/p/6114765.html)');
INSERT INTO `blog_content` VALUES (37, '## æ¦‚å¿µä»‹ç»éƒ¨åˆ†ï¼Œä¸æƒ³çœ‹å¯ä»¥è‡ªè¡Œè·³åˆ°åé¢å®æˆ˜\n### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ï¼Ÿ\n1. æ“ä½œçš„æ˜¯é‡ç”¨å­˜åœ¨çš„çº¿ç¨‹ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºã€æ¶ˆäº¡çš„å¼€é”€ï¼Œæ€§èƒ½ä½³ã€‚\n2. å¯æœ‰æ•ˆæ§åˆ¶æœ€å¤§å¹¶å‘çº¿ç¨‹æ•°ï¼Œæé«˜ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨ç‡ï¼ŒåŒæ—¶é¿å…è¿‡å¤šèµ„æºç«äº‰ï¼Œé¿å…å µå¡ã€‚\n3. æä¾›å®šæ—¶æ‰§è¡Œã€å®šæœŸæ‰§è¡Œã€å•çº¿ç¨‹ã€å¹¶å‘æ•°æ§åˆ¶ç­‰åŠŸèƒ½ã€‚\n\n### Javaçš„äº”ç§çº¿ç¨‹æ± ä»‹ç»\n1. newCachedThreadPoolåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚(ç”¨è¿‡å‡ æ¬¡ï¼Œå¯èƒ½å› ä¸ºç”µè„‘å°æ¸£ï¼Œå¯¼è‡´çº¿ç¨‹ä¸å¤Ÿç”¨æ—¶ä¸å¤Ÿå†…å­˜åˆ›å»ºæ–°çº¿ç¨‹æŠ¥é”™)\n2. newFixedThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚\n3. newScheduledThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚\n4. newSingleThreadExecutor åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œæ­¤çº¿ç¨‹æ± ä¿è¯æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæŒ‰ç…§ä»»åŠ¡çš„æäº¤é¡ºåºæ‰§è¡Œã€‚\n5. newWorkStealingPoolåˆ›å»ºä¸€ä¸ªæ‹¥æœ‰å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—çš„çº¿ç¨‹æ± ï¼Œå¯ä»¥å‡å°‘è¿æ¥æ•°ï¼Œåˆ›å»ºå½“å‰å¯ç”¨cpuæ•°é‡çš„çº¿ç¨‹æ¥å¹¶è¡Œæ‰§è¡Œï¼Œé€‚ç”¨äºå¤§è€—æ—¶çš„æ“ä½œï¼Œå¯ä»¥å¹¶è¡Œæ¥æ‰§è¡Œ\n\n>Excutorsåˆ›å»ºçº¿ç¨‹æ± è²Œä¼¼ä¸è¢«æ¨èï¼Œæ¨èå®ç”¨threadPoolExecutorï¼Œåç»­æœ‰æ—¶é—´ä¼šè¡¥å……ç›¸å…³å†…å®¹ã€‚ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ new ThreadPoolExecutor å®ä¾‹çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©ã€‚\n\n### çº¿ç¨‹æ± ä½¿ç”¨demoï¼ˆä»£ç éƒ½è·‘è¿‡ï¼Œæ²¡é—®é¢˜ï¼Œä¸è´´ç»“æœå›¾äº†ï¼‰\n- newCachedThreadPool\n```\nclass test implements Runnable {\n    private static int i=0;\n    @Override\n    public void run() {\n        for (;i<100;i++)\n            System.out.println(i);\n    }\n}\npublic class PoolStudy {\n    public static void main(String[] args) {\n        ExecutorService pool = Executors.newCachedThreadPool();\n        long start = System.currentTimeMillis();\n        pool.execute(new test());\n        pool.execute(new test());\n        pool.execute(new test());\n        System.out.println(\"cache: \" + (System.currentTimeMillis() - start));\n    }\n}\n```\n\n>è·‘ä¸€éä¼šå‘ç°æ‰§è¡Œå®Œæˆä¸ä¼šé©¬ä¸Šç»“æŸï¼Œé»˜è®¤éœ€è¦ç­‰å¾…60ç§’æ— æ“ä½œæ‰ä¼šç»ˆæ­¢æˆ–å›æ”¶\n\n- newFixedThreadPool\n```\npublic class PoolStudy {\n    public static void main(String[] args) {\n        ExecutorService fixedThreadPool = Executors.newFixedThreadPool(3);\n        for (int i = 0; i < 10; i++) {\n            final int index = i;\n            fixedThreadPool.execute(new Runnable() {\n                @Override\n                public void run() {\n                    try {\n                        System.out.println(index);\n                        Thread.sleep(2000);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            });\n        }\n        fixedThreadPool.shutdown();\n    }\n}\n```\n\n>é€šè¿‡shutdown()æ–¹æ³•é‡Šæ”¾çº¿ç¨‹ï¼Œå¦åˆ™ä¼šä¸€ç›´å­˜åœ¨\n\n- newScheduledThreadPool\n```\npublic class PoolStudy {\n    public static void main(String[] args) {\n        ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(5);\n        scheduledThreadPool.schedule(new Runnable() {\n            @Override\n            public void run() {\n                System.out.println(\"delay 3 seconds\");\n            }\n        }, 3, TimeUnit.SECONDS);\n    }\n}\n```\n\n- newSingleThreadExecutor \n```\npublic class PoolStudy {\n    public static void main(String[] args) {\n        ExecutorService singleThreadExecutor = Executors.newSingleThreadExecutor();\n        for (int i = 0; i < 10; i++) {\n            final int index = i;\n            singleThreadExecutor.execute(new Runnable() {\n                @Override\n                public void run() {\n                    try {\n                        System.out.println(Thread.currentThread().getName()+index);\n                        Thread.sleep(1000);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            });\n        }\n        singleThreadExecutor.shutdown();\n    }\n}\n```\n\n- newWorkStealingPool\n```\npublic class PoolStudy {\n    public static void main(String[] args) {\n        // è®¾ç½®å¹¶è¡Œçº§åˆ«ä¸º2ï¼Œå³é»˜è®¤æ¯æ—¶æ¯åˆ»åªæœ‰2ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œ\n        ExecutorService m = Executors.newWorkStealingPool(2);\n        for (int i = 1; i <= 10; i++) {\n            final int count=i;\n            Future future=m.submit(new Runnable() {\n                @Override\n                public void run() {\n                    Date now=new Date();\n                    System.out.println(\"çº¿ç¨‹\" + Thread.currentThread() + \"å®Œæˆä»»åŠ¡ï¼š\"\n                            + count+\"   æ—¶é—´ä¸ºï¼š\"+	now.getSeconds());\n                    try {\n                        Thread.sleep(1000);//æ­¤ä»»åŠ¡è€—æ—¶1s\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            });\n        }\n        while(true){\n            //ä¸»çº¿ç¨‹é™·å…¥æ­»å¾ªç¯ï¼Œæ¥è§‚å¯Ÿç»“æœï¼Œå¦åˆ™æ˜¯çœ‹ä¸åˆ°ç»“æœçš„\n        }\n    }\n}\n```\n\n> è¯´æ˜ï¼šçº¿ç¨‹æ‰§è¡Œä»»åŠ¡æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯excute(new Runable(){...})ï¼Œä¸€ç§æ˜¯submit(new Runable(){...})ã€‚ä¸åŒç‚¹åœ¨äºsubmitæ˜¯å¯ä»¥æ¥å—åˆ°è¿”å›ä¿¡æ¯çš„ï¼Œé€šè¿‡ä¸Šè¿°ä¾‹å­çš„future.get()å¯ä»¥è·å–åˆ°ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸè¿”å›çš„æ˜¯nullã€‚\n\n### Javaçˆ¬è™«æ–¹æ³•\n\n1. é€šè¿‡è‡ªåŠ¨åŒ–é©±åŠ¨seleniumæ¥å®Œæˆæ“ä½œï¼Œä¸æ¨èï¼Œé€Ÿåº¦æ…¢ï¼Œå ç”¨å†…å­˜é«˜\n2. jsoupï¼Œæ¨èï¼Œç›´æ¥è·å–htmlè¿›è¡Œè§£æï¼Œä»¥ä¸‹å†…å®¹é€šè¿‡jsoupæ¥å®Œæˆ\n\n#### é€šè¿‡Jsoup+å¤šçº¿ç¨‹æ–¹æ³•çˆ¬å–HTMLå†…å®¹è§£æï¼ˆè±†ç“£å›¾ä¹¦çš„å°é¢å›¾ç‰‡ä¸ºä¾‹å­ï¼‰\n1. å‰å¾€[https://book.douban.com/](https://book.douban.com/)äº†è§£htmlç»“æ„\n![å¾®ä¿¡å›¾ç‰‡_20190827191502.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/dMAUaqIE5m4fAoHAiNCNwsd8)\nå¤šè§‚å¯Ÿå‡ ä¸ªï¼Œå‘ç°å›¾ç‰‡éƒ½æ˜¯åœ¨classå±æ€§ä¸ºcoverçš„divä¸‹çš„imgï¼Œè¿™å°±å¾ˆæ–¹ä¾¿äº†ï¼Œç›´æ¥ä¸€æ­¥åˆ°ä½è¿›å…¥ä»£ç ç¯èŠ‚\n```\n    public static void main(String[] args) {\n        String url=\"https://book.douban.com/\";\n        // 2 è§£æ html\n        try {\n            Document doc = Jsoup.connect(url).get();\n            //ä» Doc çš„æ ‘å½¢ç»“æ„ä¸­æŸ¥æ‰¾ img æ ‡ç­¾\n            //.class é€‰æ‹©å™¨\n            Elements els = doc.select(\".cover img\");\n            System.out.println(els.size());\n            // åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± \n            ExecutorService pool = Executors.newFixedThreadPool(9);\n            for(Element e : els) {\n                // <img src=\"\"  width=\"\"  height=\"\" />\n                String src = e.attr(\"src\");\n                System.out.println(src);\n                // ä¸‹è½½æ¯å¼ å›¾ç‰‡\n                pool.execute(new DownloadTask(src));\n            }\n            //é‡Šæ”¾èµ„æº\n            pool.shutdown();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n    }\n```\n\n#### é€šè¿‡Jsoup+å¤šçº¿ç¨‹æ–¹æ³•çˆ¬å–JSONå†…å®¹è§£æï¼ˆè±†ç“£ç”µå½±ä¸ºä¾‹å­ï¼‰\n\n![å¾®ä¿¡æˆªå›¾_20190827205211.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/RZslPpd3vjvgYAUl74xwD0E8)\n\nåœ¨networkä¸­ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°è¯·æ±‚æ•°æ®çš„åœ°å€\næˆ‘ä»¬è¯•ä¸€ä¸‹ç›´æ¥è®¿é—®è¯¥åœ°å€çœ‹çœ‹è·å¾—äº†ä»€ä¹ˆæ•°æ®\n![å¾®ä¿¡æˆªå›¾_20190827205310.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/i3IouiYFdfFfZWXVK9cUkRfg)\n\næœä¸å…¶ç„¶ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ç”µå½±æ•°æ®ä¿¡æ¯äº†ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨Jsoupæ¥å¤„ç†è¿™äº›æ•°æ®å‘¢ï¼Ÿ\nåœ¨å¯¹JSONæ•°æ®å¤„ç†çš„æ—¶å€™ï¼Œæˆ‘çš„æ¡ˆä¾‹ä¸­ä½¿ç”¨çš„æ˜¯é˜¿é‡Œçš„fastJson\n```\npublic class Moive {\n    public static void main(String[] args) throws IOException {\n        String savePath = \"D:\" + File.separator + \"èµ„æº\" + File.separator + \"è±†ç“£ç”µå½±æ’è¡Œæ¦œ\" + File.separator;\n        File file = new File(savePath);\n        if (!file.exists()) {\n            if (!file.mkdirs())\n                System.out.println(\"ç³»ç»Ÿæ“ä½œå‡ºç°å¼‚å¸¸ã€‚\");\n        }\n        ExecutorService pool = Executors.newFixedThreadPool(10);\n        for (int i = 0; i < 10; i++) {\n            String url = \"https://movie.douban.com/j/search_subjects?type=movie&tag=%E8%B1%86%E7%93%A3%E9%AB%98%E5%88%86&sort=rank&page_limit=20&page_start=\" + String.valueOf(i * 20);\n            //å°è¯•çˆ¬10é¡µç”µå½±ï¼ŒæŒ‰è‡ªå·±éœ€æ±‚æ›´æ”¹\n            Connection.Response res = Jsoup.connect(url).ignoreContentType(true).execute();\n            JSONObject json = JSONObject.parseObject(res.body());\n            JSONArray jsonArray = json.getJSONArray(\"subjects\");\n            for (Object o : jsonArray) {\n                JSONObject object = (JSONObject) o;\n                //ç”µå½±åç§°\n                //System.out.println(object.getString(\"title\"));\n                //å›¾ç‰‡é“¾æ¥\n                //System.out.println(object.getString(\"cover\"));\n                // ä¸‹è½½æ¯å¼ å›¾ç‰‡\n                pool.execute(new Download(object.getString(\"title\"), object.getString(\"cover\")));\n            }\n        }\n        pool.shutdown();\n    }\n}\n```\n\n\nè¯·æ±‚çš„æ–¹æ³•éƒ½æŒºç®€å•çš„ï¼Œæ²¡æœ‰ä¸“é—¨é˜²æ­¢çˆ¬è™«çš„æ‹¦æˆªï¼Œä¸éœ€è¦è®¾ç½®è¯·æ±‚å¤´ä¹‹ç±»çš„å°±å¯ä»¥ç›´æ¥æ•è·åˆ°æ•°æ®ï¼Œä¸å¾—ä¸è¯´å¤šçº¿ç¨‹åœ¨çˆ¬è™«ä¸­çœŸæ˜¯ä¸€ä¸ªåˆ©å™¨ï¼Œåœ¨å¯¹è±†ç“£ç”µå½±è¿›è¡Œçš„10é¡µå†…å®¹çˆ¬è™«ä¸­ï¼Œä¸€å…±200å¼ å›¾ç‰‡ï¼Œæ€»æ¶ˆè€—æ—¶é—´ä¸åˆ°20ç§’ã€‚ã€‚ã€‚ä¸‹è½½æ–‡ä»¶çš„ä»£ç å°±ä¸æ”¾äº†ï¼Œå¦‚æœæœ‰éœ€è¦å¯ä»¥åœ¨ç•™è¨€ä¸­ç•™ä¸‹ä½ çš„è”ç³»æ–¹å¼ã€‚\n\n>æœ¬æ¡ˆä¾‹ä»…ä½œä¸ºå‚è€ƒï¼Œæ²¡æœ‰å¾ˆæ·±å…¥çš„æ“ä½œï¼Œä¾‹å¦‚å¦‚ä½•ç¿»é¡µç­‰ç­‰ï¼Œå¦‚æœéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶å¯ä»¥è‡ªè¡Œç™¾åº¦æˆ–ç•™è¨€è”ç³»æˆ‘ã€‚å®Œæ•´DEMOä¹Ÿå¯ä»¥åœ¨ç•™è¨€ä¸­ç•™ä¸‹è”ç³»æ–¹å¼è·å–ï¼Œå¦‚æœçœ‹åˆ°ä¼šå›å¤ã€‚\n\n## å‚è€ƒ\n[Java å››ç§çº¿ç¨‹æ± newCachedThreadPool,newFixedThreadPool,newScheduledThreadPool,newSingleThreadExecutor](https://www.cnblogs.com/zhujiabin/p/5404771.html)');
INSERT INTO `blog_content` VALUES (38, '### ç®€ä»‹\nçœ‹äº†å¤šçº¿ç¨‹çˆ¬è™«çš„æ–‡ç« åï¼Œå¯¹å¤šçº¿ç¨‹åº”è¯¥æœ‰ä¸€å®šçš„äº†è§£äº†ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ThreadPoolExecutoræ¥åˆ›å»ºçº¿ç¨‹æ± è€Œä¸ä½¿ç”¨Executorså‘¢ï¼Ÿå±…ç„¶é˜¿é‡Œçˆ¸çˆ¸éƒ½è¯´äº†ä¸è¦ä½¿ç”¨Executorsäº†ï¼Œé‚£è‚¯å®šæ˜¯æœ‰ç¼ºé™·å•Š\nä¸‹é¢å¼€å§‹åˆ†æä¸€ä¸‹Executorsçš„æºä»£ç ï¼ˆè¿™é‡Œåªæ”¾å‡ºå…³é”®ä»£ç ï¼Œè¯¦ç»†çš„è‡ªè¡ŒæŸ¥çœ‹ï¼‰\n```\n    public static ExecutorService newFixedThreadPool(int nThreads) {\n        return new ThreadPoolExecutor(nThreads, nThreads,\n                                      0L, TimeUnit.MILLISECONDS,\n                                      new LinkedBlockingQueue<Runnable>());\n    }\n    public static ExecutorService newWorkStealingPool(int parallelism) {\n        return new ForkJoinPool\n            (parallelism,\n             ForkJoinPool.defaultForkJoinWorkerThreadFactory,\n             null, true);\n    }\n    public static ExecutorService newSingleThreadExecutor() {\n        return new FinalizableDelegatedExecutorService\n            (new ThreadPoolExecutor(1, 1,\n                                    0L, TimeUnit.MILLISECONDS,\n                                    new LinkedBlockingQueue<Runnable>()));\n    }\n    public static ExecutorService newCachedThreadPool() {\n        return new ThreadPoolExecutor(0, Integer.MAX_VALUE,\n                                      60L, TimeUnit.SECONDS,\n                                      new SynchronousQueue<Runnable>());\n    }\n    public static ScheduledExecutorService newSingleThreadScheduledExecutor() {\n        return new DelegatedScheduledExecutorService\n            (new ScheduledThreadPoolExecutor(1));\n    }\n```\n\nè¿™æ˜¯Executors.javaå¯¹çº¿ç¨‹æ± çš„é»˜è®¤å®ç°æ–¹æ³•ï¼Œå¯ä»¥çœ‹å‡ºæ¥ä»–ä»¬å…¶å®ä¹Ÿæ˜¯è°ƒç”¨ThreadPoolExecutoræ¥å®Œæˆçº¿ç¨‹æ± çš„åˆ›å»ºçš„ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥çœ‹å‡ºè¿™å¾ˆå®¹æ˜“é€ æˆOOMçš„æƒ…å†µï¼ˆout of memoryï¼‰\n- newFixedThreadPool å’ŒSingleThreadPool\nå †ç§¯çš„è¯·æ±‚é˜Ÿåˆ—ä¼šé€ æˆå†…å­˜å¢å¤§,ç”šè‡³OOM\n- newCachedThreadPool å’ŒnewScheduledThreadPool\næœ€å¤§çº¿ç¨‹é‡ Integer.MAX_VALUE ,å¯èƒ½å¼•å‘OOM\n\nä¸‹é¢æ¥è¯¦ç»†è¯´æ˜ä¸€ä¸‹ThreadPoolExecutor\n```\n    public ThreadPoolExecutor(int corePoolSize,\n                              int maximumPoolSize,\n                              long keepAliveTime,\n                              TimeUnit unit,\n                              BlockingQueue<Runnable> workQueue,\n                              RejectedExecutionHandler handler) {\n        this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,\n             Executors.defaultThreadFactory(), handler);\n    }\n```\n\nè¿™æ˜¯ThreadPoolExecutorçš„æ„é€ å‡½æ•°ï¼Œæ¯ä¸ªå­—æ®µçš„æ„æ€æ˜¯\n- corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•°é‡ï¼Œå½“æœ‰æ–°ä»»åŠ¡åœ¨execute()æ–¹æ³•æäº¤æ—¶ï¼Œä¼šæ‰§è¡Œä»¥ä¸‹åˆ¤æ–­ï¼š\nå¦‚æœè¿è¡Œçš„çº¿ç¨‹å°‘äº corePoolSizeï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ï¼Œå³ä½¿çº¿ç¨‹æ± ä¸­çš„å…¶ä»–çº¿ç¨‹æ˜¯ç©ºé—²çš„ï¼›\nå¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äºç­‰äº corePoolSize ä¸”å°äº maximumPoolSizeï¼Œåˆ™åªæœ‰å½“workQueueæ»¡æ—¶æ‰åˆ›å»ºæ–°çš„çº¿ç¨‹å»å¤„ç†ä»»åŠ¡ï¼›\nå¦‚æœè®¾ç½®çš„corePoolSize å’Œ maximumPoolSizeç›¸åŒï¼Œåˆ™åˆ›å»ºçš„çº¿ç¨‹æ± çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œè¿™æ—¶å¦‚æœæœ‰æ–°ä»»åŠ¡æäº¤ï¼Œè‹¥workQueueæœªæ»¡ï¼Œåˆ™å°†è¯·æ±‚æ”¾å…¥workQueueä¸­ï¼Œç­‰å¾…æœ‰ç©ºé—²çš„çº¿ç¨‹å»ä»workQueueä¸­å–ä»»åŠ¡å¹¶å¤„ç†ï¼›\nå¦‚æœè¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤§äºç­‰äºmaximumPoolSizeï¼Œè¿™æ—¶å¦‚æœworkQueueå·²ç»æ»¡äº†ï¼Œåˆ™é€šè¿‡handleræ‰€æŒ‡å®šçš„ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡ï¼›\næ‰€ä»¥ï¼Œä»»åŠ¡æäº¤æ—¶ï¼Œåˆ¤æ–­çš„é¡ºåºä¸º corePoolSize â€“> workQueue â€“> maximumPoolSizeã€‚\n- maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•°é‡ï¼›\n- workQueueï¼šç­‰å¾…é˜Ÿåˆ—ï¼Œå½“ä»»åŠ¡æäº¤æ—¶ï¼Œå¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äºç­‰äºcorePoolSizeçš„æ—¶å€™ï¼ŒæŠŠè¯¥ä»»åŠ¡å°è£…æˆä¸€ä¸ªWorkerå¯¹è±¡æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ï¼›å½“æäº¤ä¸€ä¸ªæ–°çš„ä»»åŠ¡åˆ°çº¿ç¨‹æ± ä»¥å, çº¿ç¨‹æ± ä¼šæ ¹æ®å½“å‰çº¿ç¨‹æ± ä¸­æ­£åœ¨è¿è¡Œç€çš„çº¿ç¨‹çš„æ•°é‡æ¥å†³å®šå¯¹è¯¥ä»»åŠ¡çš„å¤„ç†æ–¹å¼ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å¤„ç†æ–¹å¼:\n	1. ç›´æ¥åˆ‡æ¢ï¼šè¿™ç§æ–¹å¼å¸¸ç”¨çš„é˜Ÿåˆ—æ˜¯SynchronousQueueï¼Œä½†ç°åœ¨è¿˜æ²¡æœ‰ç ”ç©¶è¿‡è¯¥é˜Ÿåˆ—ï¼Œè¿™é‡Œæš‚æ—¶è¿˜æ²¡æ³•ä»‹ç»ï¼›\n	2. ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ï¼šä¸€èˆ¬ä½¿ç”¨åŸºäºé“¾è¡¨çš„é˜»å¡é˜Ÿåˆ—LinkedBlockingQueueã€‚å¦‚æœä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¸­èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°å°±æ˜¯corePoolSizeï¼Œè€ŒmaximumPoolSizeå°±ä¸ä¼šèµ·ä½œç”¨äº†ï¼ˆåé¢ä¹Ÿä¼šè¯´åˆ°ï¼‰ã€‚å½“çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„æ ¸å¿ƒçº¿ç¨‹éƒ½æ˜¯RUNNINGçŠ¶æ€æ—¶ï¼Œè¿™æ—¶ä¸€ä¸ªæ–°çš„ä»»åŠ¡æäº¤å°±ä¼šæ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚\n	3. ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼šä¸€èˆ¬ä½¿ç”¨ArrayBlockingQueueã€‚ä½¿ç”¨è¯¥æ–¹å¼å¯ä»¥å°†çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°é‡é™åˆ¶ä¸ºmaximumPoolSizeï¼Œè¿™æ ·èƒ½å¤Ÿé™ä½èµ„æºçš„æ¶ˆè€—ï¼Œä½†åŒæ—¶è¿™ç§æ–¹å¼ä¹Ÿä½¿å¾—çº¿ç¨‹æ± å¯¹çº¿ç¨‹çš„è°ƒåº¦å˜å¾—æ›´å›°éš¾ï¼Œå› ä¸ºçº¿ç¨‹æ± å’Œé˜Ÿåˆ—çš„å®¹é‡éƒ½æ˜¯æœ‰é™çš„å€¼ï¼Œæ‰€ä»¥è¦æƒ³ä½¿çº¿ç¨‹æ± å¤„ç†ä»»åŠ¡çš„ååç‡è¾¾åˆ°ä¸€ä¸ªç›¸å¯¹åˆç†çš„èŒƒå›´ï¼Œåˆæƒ³ä½¿çº¿ç¨‹è°ƒåº¦ç›¸å¯¹ç®€å•ï¼Œå¹¶ä¸”è¿˜è¦å°½å¯èƒ½çš„é™ä½çº¿ç¨‹æ± å¯¹èµ„æºçš„æ¶ˆè€—ï¼Œå°±éœ€è¦åˆç†çš„è®¾ç½®è¿™ä¸¤ä¸ªæ•°é‡ã€‚\n		1. å¦‚æœè¦æƒ³é™ä½ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—ï¼ˆåŒ…æ‹¬CPUçš„ä½¿ç”¨ç‡ï¼Œæ“ä½œç³»ç»Ÿèµ„æºçš„æ¶ˆè€—ï¼Œä¸Šä¸‹æ–‡ç¯å¢ƒåˆ‡æ¢çš„å¼€é”€ç­‰ï¼‰, å¯ä»¥è®¾ç½®è¾ƒå¤§çš„é˜Ÿåˆ—å®¹é‡å’Œè¾ƒå°çš„çº¿ç¨‹æ± å®¹é‡, ä½†è¿™æ ·ä¹Ÿä¼šé™ä½çº¿ç¨‹å¤„ç†ä»»åŠ¡çš„ååé‡ã€‚\n		2. å¦‚æœæäº¤çš„ä»»åŠ¡ç»å¸¸å‘ç”Ÿé˜»å¡ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘é€šè¿‡è°ƒç”¨ setMaximumPoolSize() æ–¹æ³•æ¥é‡æ–°è®¾å®šçº¿ç¨‹æ± çš„å®¹é‡ã€‚\n		3. å¦‚æœé˜Ÿåˆ—çš„å®¹é‡è®¾ç½®çš„è¾ƒå°ï¼Œé€šå¸¸éœ€è¦å°†çº¿ç¨‹æ± çš„å®¹é‡è®¾ç½®å¤§ä¸€ç‚¹ï¼Œè¿™æ ·CPUçš„ä½¿ç”¨ç‡ä¼šç›¸å¯¹çš„é«˜ä¸€äº›ã€‚ä½†å¦‚æœçº¿ç¨‹æ± çš„å®¹é‡è®¾ç½®çš„è¿‡å¤§ï¼Œåˆ™åœ¨æäº¤çš„ä»»åŠ¡æ•°é‡å¤ªå¤šçš„æƒ…å†µä¸‹ï¼Œå¹¶å‘é‡ä¼šå¢åŠ ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¹‹é—´çš„è°ƒåº¦å°±æ˜¯ä¸€ä¸ªè¦è€ƒè™‘çš„é—®é¢˜ï¼Œå› ä¸ºè¿™æ ·åè€Œæœ‰å¯èƒ½é™ä½å¤„ç†ä»»åŠ¡çš„ååé‡ã€‚\n- keepAliveTimeï¼šçº¿ç¨‹æ± ç»´æŠ¤çº¿ç¨‹æ‰€å…è®¸çš„ç©ºé—²æ—¶é—´ã€‚å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äºcorePoolSizeçš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ä¼šç­‰å¾…ï¼Œç›´åˆ°ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº†keepAliveTimeï¼›\n- threadFactoryï¼šå®ƒæ˜¯ThreadFactoryç±»å‹çš„å˜é‡ï¼Œç”¨æ¥åˆ›å»ºæ–°çº¿ç¨‹ã€‚é»˜è®¤ä½¿ç”¨Executors.defaultThreadFactory() æ¥åˆ›å»ºçº¿ç¨‹ã€‚ä½¿ç”¨é»˜è®¤çš„ThreadFactoryæ¥åˆ›å»ºçº¿ç¨‹æ—¶ï¼Œä¼šä½¿æ–°åˆ›å»ºçš„çº¿ç¨‹å…·æœ‰ç›¸åŒçš„NORM_PRIORITYä¼˜å…ˆçº§å¹¶ä¸”æ˜¯éå®ˆæŠ¤çº¿ç¨‹ï¼ŒåŒæ—¶ä¹Ÿè®¾ç½®äº†çº¿ç¨‹çš„åç§°ã€‚\n- handlerï¼šå®ƒæ˜¯RejectedExecutionHandlerç±»å‹çš„å˜é‡ï¼Œè¡¨ç¤ºçº¿ç¨‹æ± çš„é¥±å’Œç­–ç•¥ã€‚å¦‚æœé˜»å¡é˜Ÿåˆ—æ»¡äº†å¹¶ä¸”æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œè¿™æ—¶å¦‚æœç»§ç»­æäº¤ä»»åŠ¡ï¼Œå°±éœ€è¦é‡‡å–ä¸€ç§ç­–ç•¥å¤„ç†è¯¥ä»»åŠ¡ã€‚çº¿ç¨‹æ± æä¾›äº†4ç§ç­–ç•¥ï¼š\n	1. AbortPolicyï¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™æ˜¯é»˜è®¤ç­–ç•¥ï¼›\n	2. CallerRunsPolicyï¼šç”¨è°ƒç”¨è€…æ‰€åœ¨çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼›\n	3. DiscardOldestPolicyï¼šä¸¢å¼ƒé˜»å¡é˜Ÿåˆ—ä¸­é æœ€å‰çš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ï¼›\n	4. DiscardPolicyï¼šç›´æ¥ä¸¢å¼ƒä»»åŠ¡ï¼›\n\n\n\n\n### å‚è€ƒ\n[ThreadPoolExecutor ä½¿ç”¨](https://blog.csdn.net/qq_27712229/article/details/89081396)\n');
INSERT INTO `blog_content` VALUES (39, '### Tips\n#### æœ€è¿‘æ‰“ç®—åœ¨é¡¹ç›®ä¸­åŠ å…¥quartzä»»åŠ¡è°ƒåº¦ï¼Œå®ç°å®šæ—¶å¤‡ä»½æ•°æ®åº“ï¼Œå®šæ—¶å‘é€é‚®ä»¶æé†’çš„åŠŸèƒ½ï¼Œæœ€è¿‘æ—¶é—´æœ‰é™ï¼Œå…ˆæŠŠcronçš„ç”¨æ³•äº†è§£ä¸€ä¸‹ï¼Œè¯¦ç»†çš„åé¢æœ‰ç©ºå†åš\n### ä¸€ã€ç»“æ„\n	\n    Seconds Minutes Hours DayofMonth Month DayofWeek Year(å¯é€‰)\n    cornä»å·¦åˆ°å³ï¼ˆç”¨ç©ºæ ¼éš”å¼€ï¼‰ï¼šç§’ åˆ† å°æ—¶ æœˆä»½ä¸­çš„æ—¥æœŸ æœˆä»½ æ˜ŸæœŸå‡  å¹´ä»½(å¯é€‰)\n\n### äºŒã€å„å­—æ®µçš„å«ä¹‰\n![å¾®ä¿¡å›¾ç‰‡_20190829165207.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/cbmJbzPmgkUvSvzDXkcrpqGB)\n#### *æ³¨æ„äº‹é¡¹\næ¯ä¸ªå­—æ®µå¯ä»¥å‡ºç°çš„å­—ç¬¦æ³¨æ„è§‚å¯Ÿä¸Šè¡¨\n#### ç‰¹æ®Šå­—ç¬¦è§£é‡Š\n1. \\*ï¼šè¡¨ç¤ºåŒ¹é…è¯¥åŸŸçš„ä»»æ„å€¼ã€‚å‡å¦‚åœ¨MinutesåŸŸä½¿ç”¨*, å³è¡¨ç¤ºæ¯åˆ†é’Ÿéƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚\n2. ? ï¼šç”¨åœ¨Day-of-Monthå’ŒDay-of-Weekä¸­ï¼ŒæŒ‡â€œæ²¡æœ‰å…·ä½“çš„å€¼â€ã€‚å½“ä¸¤ä¸ªå­è¡¨è¾¾å¼å…¶ä¸­ä¸€ä¸ªè¢«æŒ‡å®šäº†å€¼ä»¥åï¼Œä¸ºäº†é¿å…å†²çªï¼Œéœ€è¦å°†å¦å¤–ä¸€ä¸ªçš„å€¼è®¾ä¸ºâ€œ?â€ã€‚ä¾‹å¦‚ï¼šæƒ³åœ¨æ¯æœˆ20æ—¥è§¦å‘è°ƒåº¦ï¼Œä¸ç®¡20å·æ˜¯æ˜ŸæœŸå‡ ï¼Œåªèƒ½ç”¨å¦‚ä¸‹å†™æ³•ï¼š0 0 0 20 * ?ï¼Œå…¶ä¸­æœ€åä»¥ä¸ºåªèƒ½ç”¨â€œ?â€ï¼Œè€Œä¸èƒ½ç”¨â€œ*â€\n3. \\- ï¼šè¡¨ç¤ºæŒ‡å®šèŒƒå›´ã€‚\n4. , ï¼šè¡¨ç¤ºåˆ—å‡ºæšä¸¾å€¼ã€‚ä¾‹å¦‚ï¼šåœ¨Minuteså­è¡¨è¾¾å¼ä¸­ï¼Œâ€œ5,20â€è¡¨ç¤ºåœ¨5åˆ†é’Ÿå’Œ20åˆ†é’Ÿè§¦å‘ã€‚\n5. / ï¼šè¢«ç”¨äºæŒ‡å®šå¢é‡ã€‚ä¾‹å¦‚ï¼šåœ¨Minuteså­è¡¨è¾¾å¼ä¸­ï¼Œâ€œ0/15â€è¡¨ç¤ºä»0åˆ†é’Ÿå¼€å§‹ï¼Œæ¯15åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚\"3/20\"è¡¨ç¤ºä»ç¬¬ä¸‰åˆ†é’Ÿå¼€å§‹ï¼Œæ¯20åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚å’Œ\"3,23,43\"ï¼ˆè¡¨ç¤ºç¬¬3ï¼Œ23ï¼Œ43åˆ†é’Ÿè§¦å‘ï¼‰çš„å«ä¹‰ä¸€æ ·ã€‚\n6. L ï¼šç”¨åœ¨day-of-monthå’Œday-of-weekå­—ä¸²ä¸­ã€‚å®ƒæ˜¯å•è¯â€œlastâ€çš„ç¼©å†™ã€‚å®ƒåœ¨ä¸¤ä¸ªå­è¡¨è¾¾å¼ä¸­çš„å«ä¹‰æ˜¯ä¸åŒçš„ã€‚\n	1. \\- åœ¨day-of-monthä¸­ï¼Œâ€œLâ€è¡¨ç¤ºä¸€ä¸ªæœˆçš„æœ€åä¸€å¤©ï¼Œä¸€æœˆ31å·ï¼Œ3æœˆ30å·ã€‚\n	2. åœ¨day-of-weekä¸­ï¼Œâ€œLâ€è¡¨ç¤ºä¸€ä¸ªæ˜ŸæœŸçš„æœ€åä¸€å¤©ï¼Œä¹Ÿå°±æ˜¯â€œ7â€æˆ–è€…â€œSATâ€\n7. \\# ï¼šåªèƒ½ç”¨åœ¨day-of-weekå­—æ®µã€‚ç”¨æ¥æŒ‡å®šè¿™ä¸ªæœˆçš„ç¬¬å‡ ä¸ªå‘¨å‡ ã€‚ä¾‹ï¼šåœ¨day-of-weekå­—æ®µç”¨\"6#3\" or \"FRI#3\"æŒ‡è¿™ä¸ªæœˆç¬¬3ä¸ªå‘¨äº”ï¼ˆ6æŒ‡å‘¨äº”ï¼Œ3æŒ‡ç¬¬3ä¸ªï¼‰ã€‚å¦‚æœæŒ‡å®šçš„æ—¥æœŸä¸å­˜åœ¨ï¼Œè§¦å‘å™¨å°±ä¸ä¼šè§¦å‘ã€‚\n8. W ï¼šâ€œWeekdayâ€çš„ç¼©å†™ã€‚åªèƒ½ç”¨åœ¨day-of-monthå­—æ®µã€‚ç”¨æ¥æå™æœ€æ¥è¿‘æŒ‡å®šå¤©çš„å·¥ä½œæ—¥ï¼ˆå‘¨ä¸€åˆ°å‘¨äº”ï¼‰ã€‚ä¾‹å¦‚ï¼šåœ¨day-of-monthå­—æ®µç”¨â€œ15Wâ€æŒ‡â€œæœ€æ¥è¿‘è¿™ä¸ªæœˆç¬¬15å¤©çš„å·¥ä½œæ—¥â€ï¼Œå³å¦‚æœè¿™ä¸ªæœˆç¬¬15å¤©æ˜¯å‘¨å…­ï¼Œé‚£ä¹ˆè§¦å‘å™¨å°†ä¼šåœ¨è¿™ä¸ªæœˆç¬¬14å¤©å³å‘¨äº”è§¦å‘ï¼›å¦‚æœè¿™ä¸ªæœˆç¬¬15å¤©æ˜¯å‘¨æ—¥ï¼Œé‚£ä¹ˆè§¦å‘å™¨å°†ä¼šåœ¨è¿™ä¸ªæœˆç¬¬ 16å¤©å³å‘¨ä¸€è§¦å‘ï¼›å¦‚æœè¿™ä¸ªæœˆç¬¬15å¤©æ˜¯å‘¨äºŒï¼Œé‚£ä¹ˆå°±åœ¨è§¦å‘å™¨è¿™å¤©è§¦å‘ã€‚æ³¨æ„ä¸€ç‚¹ï¼šè¿™ä¸ªç”¨æ³•åªä¼šåœ¨å½“å‰æœˆè®¡ç®—å€¼ï¼Œä¸ä¼šè¶Šè¿‡å½“å‰æœˆã€‚â€œWâ€å­—ç¬¦ä»…èƒ½åœ¨ day-of-monthæŒ‡æ˜ä¸€å¤©ï¼Œä¸èƒ½æ˜¯ä¸€ä¸ªèŒƒå›´æˆ–åˆ—è¡¨ã€‚ä¹Ÿå¯ä»¥ç”¨â€œLWâ€æ¥æŒ‡å®šè¿™ä¸ªæœˆçš„æœ€åä¸€ä¸ªå·¥ä½œæ—¥ï¼Œå³æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ã€‚\n\n### ä¸‰ã€ä¾‹å­\nä»¥æœ¬åšå®¢æ¶‰åŠçš„ä¸€å°äº›å†…å®¹è¿›è¡Œè¯´æ˜\n```\n    @Scheduled(cron = \"0 00 08 * * ? \")\n    public void sendEmail() {\n        System.out.println(\"ç°åœ¨æ˜¯:\" + new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\").format(new Date()) + \",å¼€å§‹å‘é€é‚®ä»¶\");\n        StringBuilder sendText = new StringBuilder();\n        String blogUrl = \"è¯¥æ¡åšå®¢åœ°å€ï¼šhttp://blog.yhhu.xyz/#/blog/\";\n        List<SendComment> list = sendCommentService.findAll();\n        for (SendComment item : list) {\n            sendText.append(item.getReaderName()).append(\"åœ¨ã€Š\").append(item.getTitle()).append(\"ã€‹ä¸‹å›å¤----\")\n                    .append(item.getContent()).append(\"----\").append(blogUrl)\n                    .append(item.getBlogId()).append(\"\\n\");\n            sendCommentService.deleteById(item.getId());\n        }\n        if(list.size()>0) {\n            emailTool.sendSimpleMail(to,\"Blogæ¯æ—¥è¯„è®º\",String.valueOf(sendText));\n        }\n        System.out.println(\"ä»Šå¤©çš„é‚®ä»¶å·²ç»å‘é€å®Œæˆäº†\");\n    }\n```\n\n> è¿™ä¸€æ®µä»£ç è¡¨æ˜ï¼Œåœ¨æ¯å¤©æ—©ä¸Š8ç‚¹å‘é€é‚®ä»¶\n\n```\n    @Scheduled(cron = \"0 00 00 ? * MON \")\n    public void saveDataBase() throws IOException, MessagingException {\n        System.out.println(\"ç°åœ¨æ˜¯:\" + new SimpleDateFormat(\"yyyy-MM-dd\").format(new Date()) + \",å¼€å§‹å¤‡ä»½æ•°æ®åº“\");\n        File file = new File(savePath);\n        if (!file.exists())\n            file.mkdirs();\n        String window_cmd = \"cmd /c mysqldump -u\" + dataBaseUserName + \" -p\" + dataBasePassword + \" vueblog >\"\n                + savePath + new SimpleDateFormat(\"yyyy-MM-dd\").format(new Date())\n                + \".sql\";\n        String fileUrl=savePath + new SimpleDateFormat(\"yyyy-MM-dd\").format(new Date()) + \".sql\";\n        String[] centOS_cmd = {\"/bin/sh\",\"-c\",\"mysqldump -u\" + dataBaseUserName + \" -p\"\n                + dataBasePassword + \" \" + dataBaseName + \" > \"\n                + fileUrl};\n        Process process = Runtime.getRuntime().exec(centOS_cmd);\n        System.out.println(\"å¼€å§‹å°†æ•°æ®åº“å‘é€åˆ°ç®¡ç†å‘˜é‚®ç®±ã€‚\");\n        emailTool.sendAttachmentsMail(to,\"æ•°æ®åº“å¤‡ä»½\",\"å½“å‰æ—¶é—´ä¸ºï¼š\"+ new SimpleDateFormat(\"yyyy-MM-dd HH:mm\").format(new Date()),fileUrl);\n        File file1=new File(fileUrl);\n        if(!file1.delete()){\n            logger.error(\"åˆ é™¤å¤‡ä»½æ•°æ®å¼‚å¸¸\");\n        }\n    }\n```\n\n>æ¯å‘¨ä¸€å¤‡ä»½ä¸€æ¬¡æ•°æ®åº“\n\n\n### ç½‘ä¸Šæ‰¾çš„ä¸€äº›ä¾‹å­\n```\næ¯éš”5ç§’æ‰§è¡Œä¸€æ¬¡ï¼š*/5 * * * * ?\n\næ¯éš”1åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼š0 */1 * * * ?\n\næ¯å¤©23ç‚¹æ‰§è¡Œä¸€æ¬¡ï¼š0 0 23 * * ?\n\næ¯å¤©å‡Œæ™¨1ç‚¹æ‰§è¡Œä¸€æ¬¡ï¼š0 0 1 * * ?\n\næ¯æœˆ1å·å‡Œæ™¨1ç‚¹æ‰§è¡Œä¸€æ¬¡ï¼š0 0 1 1 * ?\n\næ¯æœˆæœ€åä¸€å¤©23ç‚¹æ‰§è¡Œä¸€æ¬¡ï¼š0 0 23 L * ?\n\næ¯å‘¨æ˜ŸæœŸå¤©å‡Œæ™¨1ç‚¹å®è¡Œä¸€æ¬¡ï¼š0 0 1 ? * L\n\nåœ¨26åˆ†ã€29åˆ†ã€33åˆ†æ‰§è¡Œä¸€æ¬¡ï¼š0 26,29,33 * * * ?\n\næ¯å¤©çš„0ç‚¹ã€13ç‚¹ã€18ç‚¹ã€21ç‚¹éƒ½æ‰§è¡Œä¸€æ¬¡ï¼š0 0 0,13,18,21 * * ?\n```');
INSERT INTO `blog_content` VALUES (40, '## ç¯å¢ƒå®‰è£…\n\nç•¥\n\n## å®æˆ˜\n\n~~~bash\n$ mongo    //è¿›å…¥mongodb\n> help     //å¸®åŠ©\n> exit     //é€€å‡º\n$ mongo\n> show dbs;  //æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“\n> use test;  //ä½¿ç”¨æŸä¸ªæ•°æ®åº“\n> show collections;  //æ˜¾ç¤ºé›†åˆï¼Œç›¸å½“äºmysqlçš„è¡¨\n> db.createCollection(\"hello\");  //åˆ›å»ºé›†åˆ\n> db.createCollection(\"blog\");   \n> db.createCollection(\"tag\");\n> show collections;\n> show dbs;\n> db.stats();  //è¯¥æ•°æ®åº“çš„çŠ¶æ€\n> db.dropDatabase();  //åˆ é™¤æœ¬æ•°æ®åº“\n> show dbs;\n~~~\n\n~~~bash\n$ mongo\n> show dbs;\n> use test;\n> show collections;\n> db.createCollection(\"users\");\n> show collections;\n> db.users.renameCollection(\"staff\"); // users -> staff\n> show collections;\n> db.staff.drop();  //åˆ é™¤æ•´ä¸ªé›†åˆ\n> show collections;\n> db.dropDatabase();\n> show dbs;\n~~~\n\n~~~bash\n$ mongo\n> use test;\n> show collections;\n> db.createCollection(\"hello\");\n> db.hello.insert(\n... {\n...     \"title\": \"æµ‹è¯•ä¸€ä¸‹æ·»åŠ \",\n...     \"content\": \"å·²ç»å¼€å§‹å†™åšå®¢äº†ï¼Œå¤ªæ¿€åŠ¨äº†ã€‚\"\n... }\n... );  //æ·»åŠ æ•°æ®\n> show collections;\n> db.hello.find(); //æ˜¾ç¤ºhelloé›†åˆä¸­æ‰€æœ‰æ•°æ®\n> for(var i = 0; i <=10; i++ ) {\n...     db.hello.insert({\n...         title: \"æˆ‘çš„ç¬¬\" + i + \"ç¯‡åšå®¢\"\n...     });\n... }		//æ‰¹é‡æ’å…¥æ•°æ®\n> db.hello.find();\n> db.hello.count();   //ç»Ÿè®¡æ¡æ•°\n> db.hello.remove({});   //åˆ é™¤æ‰€æœ‰\n> db.hello.count();\n> db.hello.find();\n~~~\n\n![å¾®ä¿¡å›¾ç‰‡_20190904090406.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/0mHxOVJdtwvpv8ashXPBTmhK)\nå¯ä»¥å‘ç°è¡¨ä¸­çš„å­—æ®µæ˜¯å¯ä»¥ä¸ä¸€è‡´çš„ã€‚\n\næ¡ä»¶æŸ¥è¯¢\n* db.[collection_name].find({\"\":\"\"})\n* $gte, $gt, $lte, $lt\n* $eq, $ne\n* æ­£åˆ™è¡¨è¾¾å¼:/k/, /^k/\n* db.[collection_name].distinct(\"field_name\");\n* db.[collection_name].find({\"\":\"\", \"\":\"\"})\n* db.[collection_name].find({$or:[{...},{...}]});\n* db.[collection_name].find({\"\": {$in: [...]}});\n* db.[collection_name].find({\"\": {$exists: true}});\n\n~~~bash\n> db.hello.find({\"tag\": \"1\"});        //tagç­‰äº1\n> db.hello.find({\"tag\": {$gte: 4}});  //tagå¤§äºç­‰äº4\n> db.hello.find({\"tag\": {$gt: 4}});   //tagå¤§äº4\n> db.hello.find({\"tag\": {$lte: 4}});  //å°äºç­‰äº4\n> db.hello.find({\"tag\": {$lt: 4}});   //å°äº4\n> db.hello.find({\"title\": /u/});    //titleä¸­åŒ…å«u\n> db.hello.find({\"title\": /^R/});   //ä»¥Rå¼€å¤´\n> db.hello.find({\"title\": /^U/});   //ä»¥Uå¼€å¤´\n> db.hello.distinct(\"target\");    //æ˜¾ç¤ºtargetçš„ç§ç±»(é™¤é‡ï¼Œåªè¾“å‡ºä¸€é)\n\n> db.hello.find({\"title\": /3/, \"tag\":{$gte:5} });  //æ ‡é¢˜å¸¦æœ‰3å¹¶ä¸”tagå¤§äºç­‰äº5\n> db.hello.find({$or: [{\"title\": /u/}, {\"tag\":{$gte:4}}] });  //æ ‡é¢˜å¸¦æœ‰3æˆ–tagå¤§äºç­‰äº5\n> db.hello.find({\"tag\": {$in: [3,4]} }); //tagç­‰äº3æˆ–4\n> db.hello.insert({ \"title\":\"æ¡ä»¶æµ‹è¯•\", \"istop\": true });\n> db.hello.find({\"istop\": {$exists: true} });  //æŸ¥æ‰¾istopå­—æ®µå­˜åœ¨çš„æ•°æ®\n~~~\n\næŠ½å‡ºæŒ‡å®šçš„å­—æ®µ\n* db.[collection_name].find({}, {field1: true, field2: 1})\n\n~~~bash\n> db.hello.find();\n//trueå’Œ1æ˜¯ä¸€æ ·çš„\n> db.hello.find({}, {title:true, tag:1});\n> db.hello.find({}, {title:true, tag:1, _id:0});\n~~~\n\næ’åºåˆ†é¡µ\n* sort()\n* limit()\n* skip()\n\n~~~bash\n> db.hello.find();\n//{_id:0}è¡¨ç¤ºä¸è¾“å‡ºid\n> db.hello.find({}, {_id:0}).sort({tag:1});   //tagå‡åºæ’åºï¼Œæ²¡æœ‰tagçš„ä¼šè¢«æ’åœ¨æœ€å‰é¢ã€‚ã€‚ã€‚\n> db.hello.find({}, {_id:0}).sort({tag:-1});  //å€’åº\n> db.hello.find({}, {_id:0}).limit(3);    //é»˜è®¤æ’åºçš„å‰ä¸‰æ¡        \n> db.hello.find({}, {_id:0}).sort({tag:-1}).limit(3);  //å€’åºçš„åä¸‰æ¡\n> db.hello.findOne({}, {_id:0});   //åªå–ç¬¬ä¸€æ¡\n> db.hello.find({}, {_id:0});\n> db.hello.find({}, {_id:0}).limit(3);\n> db.hello.find({}, {_id:0}).skip(3).limit(3);  //è·³è¿‡å‰ä¸‰æ¡ï¼Œå†æ‰¾ä¸‰æ¡ã€‚ä¹Ÿå°±æ˜¯åˆ†é¡µäº†\n~~~\n\næ–‡æ¡£æ›´æ–°\n* update(\\<filter>, \\<update>, \\<options>)\n\næ›´æ–°æ“ä½œå¾ˆå¤æ‚ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£\n\n~~~bash\n> db.hello.findOne({\"title\":\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"});\n> db.hello.update({\"title\":\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {$set: {\"tag\": 10} });  //ç»™titleä¸ºxxxxçš„æ•°æ®è®¾ç½®tag\n> db.hello.find();\n> db.hello.update({\"title\":\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {\"tag\": 99});    //***è¿™ä¸ªè¯­å¥ååˆ†å±é™©ï¼Œä¼šç›´æ¥æŠŠåŸæ¥çš„titleä¸ºxxxçš„æ•°æ®ç›´æ¥æŠ¹æ‰ï¼Œæ›¿æ¢æˆ\"tag\":99ã€‚åˆ é™¤æ—§æ–‡æ¡£ï¼Œç”Ÿæˆæ–°æ–‡æ¡£\n> db.hello.find();\n> db.hello.update({\"tag\":5}, {$set: {\"tag\": 50}});   //åªæ›´æ–°ä¸€æ¡\n> db.hello.find();\n> db.hello.update({\"tag\":5}, {$set: {\"tag\": 50}}, {multi: true}); //å…¨éƒ¨æ›´æ–°\n> db.hello.find();\n> db.hello.update({\"tag\":50}, {$set: {\"tag\": 60}}, {multi: true});\n> db.hello.find();\n> æ‰¹é‡æ›´æ–°(å¦‚æœå­˜åœ¨åŒåçš„ï¼Œé‚£å°±æŠŠtitleæ”¹æˆ_idæ¥åˆ¤æ–­å”¯ä¸€ï¼Œmongodbæ˜¯æ”¯æŒjavascriptçš„)\n> db.hello.find({\"title\":/æˆ‘çš„/}).forEach( \n	function(item){\n		 db.hello.update({\"title\":item.title},{$set:{\"tag\":1}}) \n	} \n  )\n~~~\n\nç‰¹æ®Šå‡½æ•°\n\n* $inc:é€’åŠ \n* $mul:ç›¸ä¹˜\n* $rename:æ”¹å\n* $set:æ–°å¢orä¿®æ”¹\n* $unset:å­—æ®µåˆ é™¤\n\n~~~bash\n> db.hello.find({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {$inc: {tag: 1}});  //åŠ æ³•\n> db.hello.find({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {$mul: {tag: 2}});  //ä¹˜æ³•\n> db.hello.find({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {$rename: {\"tag\": \"score\"}}); //å­—æ®µé‡å‘½å\n> db.hello.find({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {$set: {\"istop\": true}});  //å¢åŠ å­—æ®µ\n> db.hello.find({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {$unset: {\"istop\": true}});  //åˆ é™¤å­—æ®µ\n> db.hello.find({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"}, {_id:0});\n~~~\n\nç‰¹æ®Šæ›´æ–°\n\n* upsert:æœ‰åˆ™æ›´æ–°ï¼Œæ— åˆ™è¿½åŠ \n* remove:æ¡ä»¶åˆ é™¤æ•°æ®\n\n~~~bash\n> db.hello.find({}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬nç¯‡åšå®¢\"}, {title:\"æˆ‘çš„ç¬¬nç¯‡åšå®¢\", \"score\":2,\"tag\":\"game\"}); //æ­¤æ—¶æ²¡æœ‰è¿™æ¡æ•°æ®ï¼Œfindçš„æ—¶å€™ä¹Ÿæ²¡æœ‰\n> db.hello.find({}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬nç¯‡åšå®¢\"}, {title:\"æˆ‘çš„ç¬¬nç¯‡åšå®¢\", \"score\":2,\"tag\":\"test\"}, {upsert:true});  //è¿½åŠ äº†ä¸€æ¡æ–°è®°å½•\n> db.hello.find({}, {_id:0});\n> db.hello.update({title:\"æˆ‘çš„ç¬¬nç¯‡åšå®¢\"}, {title:\"æˆ‘çš„ç¬¬nç¯‡åšå®¢\", \"score\":7,\"tag\":\"test\"}, {upsert:true});  //ä¿®æ”¹åŸæœ‰æ•°æ®\n> db.hello.find({}, {_id:0});\n> db.hello.remove({title:\"æˆ‘çš„ç¬¬0ç¯‡åšå®¢\"});\n> db.hello.find({}, {_id:0});\n~~~\n\nä½¿ç”¨ç´¢å¼•ï¼ˆç›¸å½“äºä¸»é”®ï¼Œä¾¿äºåŠ å¿«é€Ÿåº¦ï¼Œæ»¥ç”¨ç´¢å¼•åè€Œä¼šå½±å“æ€§èƒ½ï¼‰\n\n* getIndexes()\n* createIndex({...}, {...})\n* dropIndex({...})\n\n~~~bash\n> db.hello.getIndexes();  //é»˜è®¤_idä¸ºç´¢å¼•\n> db.hello.createIndex({rank:-1});\n> db.hello.getIndexes();\n> db.hello.dropIndex({rank:-1});\n> db.hello.getIndexes();\n> db.hello.createIndex({title:1}, {unique:true});\n> db.hello.getIndexes();\n> db.hello.find({}, {_id:0});\n> db.hello.insert({title:\"æ€ªç‰©çŒäººä¸–ç•Œè¯„æµ‹\"});\n~~~\n\nå¤‡ä»½å’Œæ¢å¤\n\n* mongodump\n* mongorestore\n\n~~~bash\n> db.hello.find({}, {_id:0});\n> exit\n$ mkdir dbbak\n$ cd dbbak\n$ mongodump -d test\n$ ls\n$ mongo test\n> db.hello.find({}, {_id:0});\n> db.hello.remove({});\n> db.hello.find({}, {_id:0});\n> exit\n$ mongorestore --drop\n$ mongo test\n> db.hello.find({}, {_id:0});\n> exit\n$ mongodump --help\n~~~\n\n\n## SpringBootä¸­ä½¿ç”¨MongoDBå®ç°CRUD\n\n#### å¼•å…¥springé›†æˆçš„MongoDBä¾èµ–\n\n```\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-mongodb</artifactId>\n        </dependency>\n```\n\n#### propertiesé…ç½®\n```\nspring.data.mongodb.host=localhost\nspring.data.mongodb.database=test\nspring.data.mongodb.port=27017\n```\n\n#### åˆ›å»ºdaoå±‚\n```\n@Repository\npublic interface UserRepository extends MongoRepository<User, ObjectId> {\n\n}\n```\n\nä»£ç æœ‰ç‚¹ä¹±ï¼Œä¸è´´äº†ï¼Œä¹‹åè¡¥ä¸€ä¸ªå®Œæ•´demo');
INSERT INTO `blog_content` VALUES (41, '## ä»€ä¹ˆæ˜¯ oAuth\noAuth åè®®ä¸ºç”¨æˆ·èµ„æºçš„æˆæƒæä¾›äº†ä¸€ä¸ªå®‰å…¨çš„ã€å¼€æ”¾è€Œåˆç®€æ˜“çš„æ ‡å‡†ã€‚ä¸ä»¥å¾€çš„æˆæƒæ–¹å¼ä¸åŒä¹‹å¤„æ˜¯ oAuth çš„æˆæƒä¸ä¼šä½¿ç¬¬ä¸‰æ–¹è§¦åŠåˆ°ç”¨æˆ·çš„å¸å·ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åä¸å¯†ç ï¼‰ï¼Œå³ç¬¬ä¸‰æ–¹æ— éœ€ä½¿ç”¨ç”¨æˆ·çš„ç”¨æˆ·åä¸å¯†ç å°±å¯ä»¥ç”³è¯·è·å¾—è¯¥ç”¨æˆ·èµ„æºçš„æˆæƒï¼Œå› æ­¤ oAuth æ˜¯å®‰å…¨çš„ã€‚\n\n## ä»€ä¹ˆæ˜¯ Spring Security\nSpring Security æ˜¯ä¸€ä¸ªå®‰å…¨æ¡†æ¶ï¼Œå‰èº«æ˜¯ Acegi Securityï¼Œèƒ½å¤Ÿä¸º Spring ä¼ä¸šåº”ç”¨ç³»ç»Ÿæä¾›å£°æ˜å¼çš„å®‰å…¨è®¿é—®æ§åˆ¶ã€‚Spring Security åŸºäº Servlet è¿‡æ»¤å™¨ã€IOC å’Œ AOPï¼Œä¸º Web è¯·æ±‚å’Œæ–¹æ³•è°ƒç”¨æä¾›èº«ä»½ç¡®è®¤å’Œæˆæƒå¤„ç†ï¼Œé¿å…äº†ä»£ç è€¦åˆï¼Œå‡å°‘äº†å¤§é‡é‡å¤ä»£ç å·¥ä½œã€‚\n\n## å®¢æˆ·ç«¯æˆæƒæ¨¡å¼\nå®¢æˆ·ç«¯å¿…é¡»å¾—åˆ°ç”¨æˆ·çš„æˆæƒï¼ˆauthorization grantï¼‰ï¼Œæ‰èƒ½è·å¾—ä»¤ç‰Œï¼ˆaccess tokenï¼‰ã€‚oAuth 2.0 å®šä¹‰äº†å››ç§æˆæƒæ–¹å¼ã€‚\n- implicitï¼šç®€åŒ–æ¨¡å¼ï¼Œä¸æ¨èä½¿ç”¨\n- authorization codeï¼šæˆæƒç æ¨¡å¼ï¼ˆæœ¬æ–‡ç« é‡‡ç”¨è¿™ç§æ¨¡å¼ï¼‰\n- resource owner password credentialsï¼šå¯†ç æ¨¡å¼\n- client credentialsï¼šå®¢æˆ·ç«¯æ¨¡å¼\n\n## ä¸ªäººå¯¹oAuth2è®¤è¯è¿‡ç¨‹çš„ç†è§£\n![å¾®ä¿¡æˆªå›¾_20190908104104.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/eZJgoJPD6oeOkYGzMBUZdy0t)\n\n## ç¼–ç éƒ¨åˆ†\n1. åˆ›å»ºé¡¹ç›®å·¥ç¨‹ï¼Œæœ¬æ–‡ç« é‡‡ç”¨å¤šmoduleæ–¹å¼\nä¸»è¦æ˜¯é…ç½®ä¸€ä¸ªpomï¼Œæ–‡ç« ç»“æŸåä»£ç ä¼šå‘åˆ°githubï¼Œè¿™é‡Œä¸å¤åˆ¶äº†\n2. åˆ›å»ºç»Ÿä¸€ä¾èµ–\nç»Ÿä¸€ä¾èµ–ä¸­é…ç½®org.springframework.cloud\nspringboot2.1.xéœ€è¦ä½¿ç”¨Greenwichç‰ˆæœ¬\n3. åˆ›å»ºè®¤è¯æœåŠ¡å™¨æ¨¡å—ï¼ˆå†…å­˜æ¨¡æ‹Ÿç‰ˆæœ¬ï¼‰\n```\n@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfiguration extends AuthorizationServerConfigurerAdapter {\n    // æ³¨å…¥ WebSecurityConfiguration ä¸­é…ç½®çš„ BCryptPasswordEncoder\n    @Autowired\n    private BCryptPasswordEncoder passwordEncoder;\n\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        // é…ç½®å®¢æˆ·ç«¯\n        clients\n                // ä½¿ç”¨å†…å­˜è®¾ç½®\n                .inMemory()\n                // client_id\n                .withClient(\"client\")\n                // client_secret\n                .secret(passwordEncoder.encode(\"secret\"))\n                // æˆæƒç±»å‹\n                .authorizedGrantTypes(\"authorization_code\")\n                // æˆæƒèŒƒå›´\n                .scopes(\"app\")\n                // æ³¨å†Œå›è°ƒåœ°å€\n                .redirectUris(\"http://blog.yhhu.xyz\");\n    }\n}\n```\n\n```\n@Configuration\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true, jsr250Enabled = true)\npublic class WebSecurityConfiguration extends WebSecurityConfigurerAdapter {\n    @Bean\n    public BCryptPasswordEncoder passwordEncoder() {\n        // è®¾ç½®é»˜è®¤çš„åŠ å¯†æ–¹å¼\n        return new BCryptPasswordEncoder();\n    }\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n\n        auth.inMemoryAuthentication()\n                // åœ¨å†…å­˜ä¸­åˆ›å»ºç”¨æˆ·å¹¶ä¸ºå¯†ç åŠ å¯†\n                .withUser(\"user\").password(passwordEncoder().encode(\"123456\")).roles(\"USER\")\n                .and()\n                .withUser(\"admin\").password(passwordEncoder().encode(\"123456\")).roles(\"ADMIN\");\n    }\n}\n```\n\n>SpringSecurityæä¾›é»˜è®¤çš„ç™»å½•ç•Œé¢ï¼Œå¹¶ä¸”æä¾›RestfulAPI\n\n```\nspring:\n  application:\n    name: oauth2-server\nserver:\n  port: 8080\n```\n\n==å¿…é¡»éµå¾ªè¿™æ ·çš„è¯·æ±‚url==\nè·å–codeï¼šåœ¨æµè§ˆå™¨ç›´æ¥è®¿é—®http://localhost:8080/oauth/authorize?client_id=client&response_type=code\né€šè¿‡codeè·å–access_tokenï¼šhttp://client:secret@localhost:8080/oauth/token\n>è¿™é‡Œéœ€è¦å¸¦ä¸¤ä¸ªå‚æ•°,é‡‡ç”¨x-www-form-urlencodedæ–¹å¼ï¼Œgrant_typeä¸ºauthorization_codeï¼Œcodeä¸ºä¸Šä¸€æ­¥è·å–åˆ°çš„å†…å®¹\nurlè¯´æ˜ï¼šclient:secretä¸æ˜¯å›ºå®šçš„ï¼Œè¿™å–å†³äºä½ åœ¨AuthorizationServerConfigurationä¸­withClientå’Œsecretçš„è®¾ç½®\n\n![å¾®ä¿¡æˆªå›¾_20190908123558.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/QcPQvmtVsDEy7IbadNNxVA5F)\n\n4. åˆ›å»ºè®¤è¯æœåŠ¡å™¨æ¨¡å—ï¼ˆJDBCç‰ˆæœ¬ï¼‰\n    1. åˆ›å»ºä¸€ä¸ªoauthæ•°æ®åº“ï¼Œå®˜æ–¹ç»™çš„è¡¨ç¤ºH2çš„ï¼Œmysqlæœ‰ç‚¹æ”¹åŠ¨ï¼Œç™¾åº¦æ‰¾äº†ä¸€ä¸ª\n    ```\n    CREATE TABLE `clientdetails` (\n      `appId` varchar(128) NOT NULL,\n      `resourceIds` varchar(256) DEFAULT NULL,\n      `appSecret` varchar(256) DEFAULT NULL,\n      `scope` varchar(256) DEFAULT NULL,\n      `grantTypes` varchar(256) DEFAULT NULL,\n      `redirectUrl` varchar(256) DEFAULT NULL,\n      `authorities` varchar(256) DEFAULT NULL,\n      `access_token_validity` int(11) DEFAULT NULL,\n      `refresh_token_validity` int(11) DEFAULT NULL,\n      `additionalInformation` varchar(4096) DEFAULT NULL,\n      `autoApproveScopes` varchar(256) DEFAULT NULL,\n      PRIMARY KEY (`appId`)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n    CREATE TABLE `oauth_access_token` (\n      `token_id` varchar(256) DEFAULT NULL,\n      `token` blob,\n      `authentication_id` varchar(128) NOT NULL,\n      `user_name` varchar(256) DEFAULT NULL,\n      `client_id` varchar(256) DEFAULT NULL,\n      `authentication` blob,\n      `refresh_token` varchar(256) DEFAULT NULL,\n      PRIMARY KEY (`authentication_id`)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n    CREATE TABLE `oauth_approvals` (\n      `userId` varchar(256) DEFAULT NULL,\n      `clientId` varchar(256) DEFAULT NULL,\n      `scope` varchar(256) DEFAULT NULL,\n      `status` varchar(10) DEFAULT NULL,\n      `expiresAt` timestamp NULL DEFAULT NULL,\n      `lastModifiedAt` timestamp NULL DEFAULT NULL\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n    CREATE TABLE `oauth_client_details` (\n      `client_id` varchar(128) NOT NULL,\n      `resource_ids` varchar(256) DEFAULT NULL,\n      `client_secret` varchar(256) DEFAULT NULL,\n      `scope` varchar(256) DEFAULT NULL,\n      `authorized_grant_types` varchar(256) DEFAULT NULL,\n      `web_server_redirect_uri` varchar(256) DEFAULT NULL,\n      `authorities` varchar(256) DEFAULT NULL,\n      `access_token_validity` int(11) DEFAULT NULL,\n      `refresh_token_validity` int(11) DEFAULT NULL,\n      `additional_information` varchar(4096) DEFAULT NULL,\n      `autoapprove` varchar(256) DEFAULT NULL,\n      PRIMARY KEY (`client_id`)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n    CREATE TABLE `oauth_client_token` (\n      `token_id` varchar(256) DEFAULT NULL,\n      `token` blob,\n      `authentication_id` varchar(128) NOT NULL,\n      `user_name` varchar(256) DEFAULT NULL,\n      `client_id` varchar(256) DEFAULT NULL,\n      PRIMARY KEY (`authentication_id`)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n    CREATE TABLE `oauth_code` (\n      `code` varchar(256) DEFAULT NULL,\n      `authentication` blob\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n    CREATE TABLE `oauth_refresh_token` (\n      `token_id` varchar(256) DEFAULT NULL,\n      `token` blob,\n      `authentication` blob\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n    ```\n    2. æ“ä½œä¸€ä¸‹oauth_client_detailsè¡¨\n    éœ€è¦è®¾ç½®çš„å†…å®¹ä¸ºclient_idï¼Œclient_secretï¼Œscopeï¼Œauthorized_grant_typesï¼Œweb_server_redirect_uriï¼Œæ³¨æ„client_secretæ˜¯ç»è¿‡åŠ å¯†çš„\n    ![å¾®ä¿¡æˆªå›¾_20190908131112.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/AfzUmYxR1ZqNVt1ccpa5oRl3)\n\nè‡³æ­¤å®ŒæˆéªŒè¯åŠŸèƒ½ï¼Œå…¶ä»–æ“ä½œå’Œå†…å­˜ç‰ˆéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå®Œæˆåå¯ä»¥åœ¨æ•°æ®åº“ä¸­çœ‹åˆ°çœ‹åˆ°tokenç›¸å…³ä¿¡æ¯\n\n## RBACï¼ˆRole-Based Access Controlï¼ŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰\nå¢åŠ äº†å‡ ä¸ªè¡¨ï¼Œæ¨¡å‹å¦‚ä¸‹\n\n![å¾®ä¿¡å›¾ç‰‡_20190908141858.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/zR33HRXmlfxJbiPGGInoOXft)\n\nå¯ä»¥åšçš„ç®€å•ä¸€ç‚¹ï¼Œå¯æ˜¯è¿™æ ·åšåŠŸèƒ½æ›´åŠ å®Œå¤‡ï¼Œå•å•åœ¨userè¡¨ä¸­æ’å…¥roleåˆ—çš„è¯ä¸ä¾¿äºç®¡ç†\n\nä¸‹é¢å¼€å§‹å…·ä½“å®ç°\n\n1. åœ¨è®¤è¯æœåŠ¡å™¨ç«¯æ’é™¤tokenæ£€æŸ¥çš„æƒé™åˆ¤æ–­\n```Java\n    @Override\n    public void configure(WebSecurity web) throws Exception {\n        web.ignoring().antMatchers(\"/oauth/check_token\");\n    }\n```\n\n2. åˆ›å»ºä¸€ä¸ªserviceï¼ŒæŸ¥è¯¢ç”¨æˆ·ä½¿ç”¨ï¼ˆä»£ç ç•¥ï¼‰\n3. å°†æˆæƒæ¨¡å¼ç”±å†…å­˜æ¨¡å¼æ”¹ä¸ºuserDetailServiceæ–¹å¼\n```Java\n    @Autowired\n    private DataSource dataSource;\n\n    @Bean\n    public TokenStore tokenStore() {\n        // åŸºäº JDBC å®ç°ï¼Œä»¤ç‰Œä¿å­˜åˆ°æ•°æ®\n        return new JdbcTokenStore(dataSource);\n    }\n\n    @Bean\n    public ClientDetailsService jdbcClientDetails() {\n        // åŸºäº JDBC å®ç°ï¼Œéœ€è¦äº‹å…ˆåœ¨æ•°æ®åº“é…ç½®å®¢æˆ·ç«¯ä¿¡æ¯\n        return new JdbcClientDetailsService(dataSource);\n    }\n\n    @Override\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception \n    {\n        // è®¾ç½®ä»¤ç‰Œ\n        endpoints.tokenStore(tokenStore());\n    }\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth.userDetailsService(userDetailsService());\n    }\n```\n\n4. è®¤è¯ä¸­å¿ƒUserDetailæƒé™åˆ¤æ–­é€»è¾‘\n```Java\npublic class UserDetailServiceImpl implements UserDetailsService {\n    @Autowired\n    private TbUserService tbUserService;\n    @Autowired\n    private TbPermissionService tbPermissionService;\n    @Override\n    public UserDetails loadUserByUsername(String s) throws UsernameNotFoundException {\n        TbUser tbUser = tbUserService.getByUsername(s);\n        List<GrantedAuthority> grantedAuthorities= Lists.newArrayList();\n        if (tbUser != null) {\n            List<TbPermission> tbPermissions = tbPermissionService.selectByUserId(tbUser.getId());\n            tbPermissions.forEach(item -> {\n                GrantedAuthority grantedAuthority = new SimpleGrantedAuthority(item.getEnname());\n                grantedAuthorities.add(grantedAuthority);\n            });\n            return new User(tbUser.getUsername(),tbUser.getPassword(),grantedAuthorities);\n        }\n        return null;\n    }\n}\n```\n\n5. å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæƒé™æ§åˆ¶æ–¹æ³•ï¼Ÿï¼ˆé€šè¿‡permissionä¸­urlå¯¹åº”çš„æ–¹å¼æ¥åˆ¤æ–­æƒé™ï¼‰\n> å®šä¹‰æƒé™åˆ¤æ–­ç±»\n\n```java\n@Component(\"permission\")\npublic class PermissionCheck {\n    private AntPathMatcher antPathMatcher = new AntPathMatcher();\n\n    public boolean hasPermission(HttpServletRequest request, Authentication authentication) {\n        boolean hasPermission = false;\n	//å–å‡ºå½“å‰tokenå¯¹åº”ç”¨æˆ·æ‰€æ‹¥æœ‰çš„æƒé™\n        Collection<? extends GrantedAuthority> authorities = authentication.getAuthorities();\n        for (GrantedAuthority authority : authorities) {\n            if (antPathMatcher.match(authority.getAuthority(), request.getRequestURI())) {\n                hasPermission = true;\n                break;\n            }\n        }\n        return hasPermission;\n    }\n}\n```\n\n> åœ¨èµ„æºæœåŠ¡å™¨ä¸­é…ç½®access(\"\")æ–¹æ³•æ¥è°ƒç”¨hasPermissionæ–¹æ³•\n\n```java\npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n        http.exceptionHandling()\n                .and()\n                //ç®¡ç†sessionçš„åˆ›å»ºç­–ç•¥æ°¸è¿œä¸ä¼šåˆ›å»ºHttpSessionï¼Œå®ƒä¸ä¼šä½¿ç”¨HttpSessionæ¥è·å–SecurityContext\n                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n                //ALWAYSæ€»æ˜¯åˆ›å»ºHttpSession\n                //IF_REQUIREDSpring Securityåªä¼šåœ¨éœ€è¦æ—¶åˆ›å»ºä¸€ä¸ªHttpSession\n                //NEVERSpring Securityä¸ä¼šåˆ›å»ºHttpSessionï¼Œä½†å¦‚æœå®ƒå·²ç»å­˜åœ¨ï¼Œå°†å¯ä»¥ä½¿ç”¨HttpSession\n                .and()\n                .authorizeRequests()\n                .anyRequest().access(\"@permission.hasPermission(request,authentication)\");\n        // ä»¥ä¸‹ä¸ºé…ç½®æ‰€éœ€ä¿æŠ¤çš„èµ„æºè·¯å¾„åŠæƒé™ï¼Œéœ€è¦ä¸è®¤è¯æœåŠ¡å™¨é…ç½®çš„æˆæƒéƒ¨åˆ†å¯¹åº”\n//                .antMatchers(\"/**\").hasAuthority(\"SystemContent\");\n    }\n}\n```\n\n## å®Œæ•´ä»£ç åœ°å€\n[oauth2](https://github.com/yhuihu/oauth2)');
INSERT INTO `blog_content` VALUES (42, '## ä¸ºä»€ä¹ˆè¦åšå†…ç½‘ç©¿é€\nåœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œç›®å‰ä¸»æµçš„æ–¹æ¡ˆéƒ½æ˜¯å‰åç«¯åˆ†ç¦»çš„ï¼Œé‚£ä¹ˆå‰åç«¯ä¸åœ¨ä¸€å°ç”µè„‘ä¸Šï¼Œæµ‹è¯•çš„æ—¶å€™å‰ç«¯äººå‘˜éœ€è¦ä¸€ä¸ªå¯ä»¥è®¿é—®çš„serverï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšå†…ç½‘ç©¿é€ï¼Œå°†æœ¬åœ°ç«¯å£æš´éœ²åˆ°å…¬ç½‘ä¸­å»ï¼Œä½¿å¾—å‰ç«¯äººå‘˜å¯ä»¥ç›´æ¥è°ƒç”¨æ¥å£ã€‚\n\n## frp\n[frp](https://github.com/fatedier/frp)æ˜¯ä¸€ä¸ªå¼€æºçš„å†…ç½‘ç©¿é€è½¯ä»¶ï¼Œè¯¦ç»†å†…å®¹å¯ä»¥åˆ°githubä¸Šå»çœ‹ã€‚\n\n## æ­£é¢˜\nè¦åšå†…ç½‘ç©¿é€ï¼Œè¿˜æ˜¯éœ€è¦ä¸€ä¸ªæœåŠ¡å™¨çš„ï¼Œè¿™é‡Œå‡è®¾ä½ å·²ç»æœ‰ä¸€ä¸ªæœåŠ¡å™¨äº†\n1. ä¸‹è½½å¹¶è§£å‹frp\n\n![å¾®ä¿¡æˆªå›¾_20190911194636.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/yb10bicxcl1EfXqmTddDRKpf)\n\nè¿™æ˜¯è§£å‹åçš„ç›®å½•ç»“æ„ï¼Œfrpså¯¹åº”serverç«¯ï¼Œfrpcå¯¹åº”clientç«¯\n\n2. ä¿®æ”¹frps.ini\n\n![Inkedå¾®ä¿¡æˆªå›¾_20190911194745_LI.jpg](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/qeldUn2txVbWGofM5X3fDyJu)\n   - bind_portæä¾›clientç«¯ç»‘å®šçš„ç«¯å£ã€‚\n   - vhost_http_portå†…ç½‘ç©¿é€åè®¿é—®æ‰€ä½¿ç”¨çš„ç«¯å£\n   - dashboardå¼€å¤´çš„ä¸ºæ§åˆ¶å°çš„ä¸€äº›é…ç½®\n   - privilege_tokenæ˜¯ä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œclientç«¯ä¹Ÿè¦æ‹¥æœ‰åŒæ ·çš„tokenæ‰èƒ½è¿æ¥ä¸Š\n\n3. å¯åŠ¨æœåŠ¡å™¨ç«¯\n\n```bash\n//åå°è¿è¡Œæ–¹æ³•\nnohup ./frps -c ./frps.ini &\n\ncat nohup.out\n```\n\n![å¾®ä¿¡æˆªå›¾_20190911195146.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/eA8ZPv5IkmhvyzG2WK3Dh1xQ)\n\næœåŠ¡å™¨ç«¯é…ç½®å®Œæˆ\n\n4. å®¢æˆ·ç«¯é…ç½®\n\n```\n[common]\n\nserver_addr = xxxxx //æœåŠ¡å™¨åœ°å€\n\nserver_port = 7088  //å¯¹åº”bind_port\n\nprivilege_token = 8d262f2b-6dba-xxxxxxxxxx   //token\n\n[http]\ntype=http\nlocal_ip = 127.0.0.1    //æœ¬åœ°åœ°å€ï¼Œä¸€èˆ¬éƒ½æ˜¯localhost\nlocal_port = 9001       //è¦åšå†…ç½‘ç©¿é€çš„ç«¯å£\ncustom_domains = test.yhhu.xyz  //å¯¹åº”åŸŸåï¼Œä¸ç”¨ä¹Ÿå¯ä»¥ï¼Œç”¨äº†å¯ä»¥é€šè¿‡nginxå»æ‰ç«¯å£å·ï¼ˆxxxx:6081ï¼‰\n```\n \n\n5. å¯åŠ¨å®¢æˆ·ç«¯\n\n\n![å¾®ä¿¡æˆªå›¾_20190911195426.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/phzP6yEnH2TmKAmYAKkBu4E6)\n\n6. æµ‹è¯•\n\n\n![å¾®ä¿¡æˆªå›¾_20190911195535.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/kA07yQnLgiXxzkVPd8mHZZoQ)\n\n![å¾®ä¿¡æˆªå›¾_20190911195556.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/wGHsgvpI1J4ODNwWMr84bVOQ)\n\n## æ€»ç»“\n\næ²¡ä»€ä¹ˆéš¾çš„ï¼Œå…³é”®è¦æ³¨æ„ä¸€ç‚¹ï¼Œå¦‚æœä½ é…ç½®äº†domainï¼Œä¹Ÿå°±æ˜¯åŸŸåæ–¹å¼ï¼Œé‚£ä¹ˆåº”è¯¥ä¼šç”¨åˆ°nginxï¼Œé‚£ä¹ˆnginxçš„é…ç½®å¦‚ä¸‹\n\n```bash\n  server {\n        listen       80;\n        #listen       [::]:80 default_server;\n        server_name  test.yhhu.xyz;\n        root         /usr/share/nginx/html;\n        include /etc/nginx/default.d/*.conf;\n        location / {\n            proxy_pass http://127.0.0.1:6081;\n            #ä¸‹é¢è¿™4ä¸ªä¸å¯ä¸Šï¼Œè¿‡æ¥äººçš„ç»éªŒ-ï¼Œ-\n            proxy_set_header Host $host:$server_port;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Real-PORT $remote_port;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        }\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n```');
INSERT INTO `blog_content` VALUES (43, '### å‡†å¤‡å·¥ä½œ\n1. äº†è§£Javaæ˜¯å¦‚ä½•åˆ›å»ºçº¿ç¨‹çš„\n2. äº†è§£Javaæ˜¯å¦‚ä½•åˆå§‹åŒ–çº¿ç¨‹æ± çš„\næœ¬èŠ‚ä»£ç åœ°å€[æ‰‹å†™çº¿ç¨‹](https://github.com/yhuihu/Java-Study/tree/master/Thread)\n\n### ä¸ºä»€ä¹ˆè¦ç”¨FutureTask\nFutureTaskå¯ä»¥è·å–åˆ°çº¿ç¨‹æ‰§è¡Œçš„ç»“æœï¼Œè€Œç›´æ¥ä½¿ç”¨Runableæ˜¯æ²¡åŠæ³•è·å–åˆ°çº¿ç¨‹æ‰§è¡Œçš„ç»“æœçš„\n\n### ç¼–ç \n1. å…ˆæ¥çœ‹çœ‹ç›®å‰æˆ‘ä»¬æ˜¯å¦‚ä½•ä½¿ç”¨FutureTaskçš„\n```Java\npublic class Test {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        Callable<String> work1=new Callable<String>() {\n            @Override\n            public String call() throws Exception {\n                System.out.println(\"æµ‹è¯•æ–¹æ³•1\");\n                return \"æ–¹æ³•1æ‰§è¡Œå®Œæ¯•\";\n            }\n        };\n        Callable<String> work2=new Callable<String>() {\n            @Override\n            public String call() throws Exception {\n                System.out.println(\"æµ‹è¯•æ–¹æ³•2\");\n                return \"æ–¹æ³•2æ‰§è¡Œå®Œæ¯•\";\n            }\n        };\n        FutureTask<String> task1=new FutureTask<>(work1);\n        FutureTask<String> task2=new FutureTask<>(work2);\n        new Thread(task1).start();\n        new Thread(task2).start();\n        String result1=task1.get();\n        String result2=task2.get();\n        System.out.println(result1);\n        System.out.println(result2);\n\n    }\n}\n```\n\n> æ‰§è¡Œç»“æœ\n\n![å¾®ä¿¡æˆªå›¾_20190925162834.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/HCDlBO0QcMKvOCFrGTWjVM1C)\n\n2. åˆ›å»ºä¸€ä¸ªåä¸ºMyFutureTaskçš„ç±»ï¼Œå¹¶åšä¸€ä¸ªæœ€ç®€å•çš„å®ç°\n```Java\npublic class MyFutureTask<T> implements Runnable {\n    private Callable<T> callable;\n    private T result;\n\n    public MyFutureTask(Callable<T> callable) {\n        this.callable = callable;\n    }\n\n    @Override\n    public void run() {\n        //ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ\n        try {\n            result = callable.call();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\nè¿™ä¸€éƒ¨åˆ†æœ€å…³é”®çš„æ˜¯è¦æ˜ç™½å°†Callableä½œä¸ºå‚æ•°æ„é€ å®ä¾‹ï¼Œå› ä¸ºåœ¨runæ–¹æ³•ä¸­æˆ‘ä»¬æ˜¯è¦é€šè¿‡callableçš„callæ–¹æ³•æ¥æ‰§è¡Œä¸šåŠ¡é€»è¾‘å¹¶è·å–ç»“æœçš„\n\n3. å®Œå–„\nå…ˆæå‡ºé—®é¢˜ï¼šåœ¨ç”¨FutureTaskçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªç–‘é—®ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•ä¿è¯get()æ–¹æ³•ä¸€å®šèƒ½è·å–åˆ°å€¼å¾—ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜å°±è¦æ¶‰åŠåˆ°æˆ‘ä»¬å¦‚ä½•è®©getæ–¹æ³•è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæˆä¹‹åå†è¿”å›å€¼äº†ã€‚\n```Java\npublic class MyFutureTask<T> implements Runnable {\n    private static final String ERROR = \"EXP\";\n    private static final String FINISH = \"END\";\n    private static final String NEW = \"NEW\";\n    private Callable<T> callable;\n    private volatile String state = NEW;\n    private T result;\n    private LinkedBlockingQueue<Thread> waiters = new LinkedBlockingQueue<>();\n\n    public MyFutureTask(Callable<T> callable) {\n        this.callable = callable;\n    }\n\n    @Override\n    public void run() {\n        //ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ\n        try {\n            result = callable.call();\n        } catch (Exception e) {\n            state = ERROR;\n            e.printStackTrace();\n        } finally {\n            if (!state.equals(ERROR)) {\n                state = FINISH;\n            }\n        }\n\n        Thread waiter = waiters.poll();\n        while (waiter != null) {\n            LockSupport.unpark(waiter);\n            waiter = waiters.poll();\n        }\n    }\n\n    public T get() throws Exception {\n        //æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œéœ€è¦ç­‰å¾…\n        if (ERROR.equals(state)) {\n            throw new Exception(\"é”™è¯¯\");\n        }\n        while (!FINISH.equals(state)) {\n            waiters.add(Thread.currentThread());\n            LockSupport.park(); //è¿›å…¥é˜»å¡çŠ¶æ€\n        }\n        return result;\n    }\n}\n```\n\n- æˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªçŠ¶æ€ERROR,FINISH,NEWåˆ†åˆ«å¯¹åº”å½“å‰çº¿ç¨‹çš„å„ç§çŠ¶æ€\n- LinkedBlockingQueueæ˜¯ä¸€ä¸ªåŸºäºé“¾è¡¨çš„é˜Ÿåˆ—ï¼Œè¿™é‡Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çº¿ç¨‹\n\n>æ€è·¯\n\n- å…ˆçœ‹getæ–¹æ³•\nå½“æˆ‘ä»¬è°ƒç”¨getæ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šåˆ¤æ–­ä¸€ä¸‹å½“å‰çº¿ç¨‹çš„æ‰§è¡Œæƒ…å†µï¼Œå¦‚æœæ²¡æœ‰è¾¾åˆ°FINISHï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šè¿›å…¥æ­»å¾ªç¯ï¼Œå¹¶å°†å½“å‰çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—å½“ä¸­å»ã€‚\n\n- å†çœ‹runæ–¹æ³•\nrunæ–¹æ³•æ‰§è¡Œå®Œæˆçš„æ—¶å€™ï¼Œå°†ç»“æœä¿å­˜åˆ°resultï¼Œå¦‚æœå‡ºç°äº†å¼‚å¸¸ï¼Œé‚£ä¹ˆå®šä¹‰çŠ¶æ€ä¸ºERRORï¼Œæœ€ç»ˆï¼Œæˆ‘ä»¬è¦å°†é˜Ÿåˆ—ä¸­æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ¿€æ´»ï¼Œæ¿€æ´»è¿‡åä¼šåœ¨æ­¤è¿›å…¥getæ–¹æ³•é‡Œçš„whileå¾ªç¯ã€‚\n\n4. æµ‹è¯•ï¼Œç”¨æˆ‘ä»¬è‡ªå·±çš„MyFutureTaskæ›¿æ¢FutureTask\n```Java\npublic class Test {\n    public static void main(String[] args) throws Exception {\n        Callable<String> work1=new Callable<String>() {\n            @Override\n            public String call() throws Exception {\n                System.out.println(\"æµ‹è¯•æ–¹æ³•1\");\n                return \"æ–¹æ³•1æ‰§è¡Œå®Œæ¯•\";\n            }\n        };\n        Callable<String> work2=new Callable<String>() {\n            @Override\n            public String call() throws Exception {\n                System.out.println(\"æµ‹è¯•æ–¹æ³•2\");\n                return \"æ–¹æ³•2æ‰§è¡Œå®Œæ¯•\";\n            }\n        };\n        MyFutureTask<String> task1=new MyFutureTask<>(work1);\n        MyFutureTask<String> task2=new MyFutureTask<>(work2);\n        new Thread(task1).start();\n        new Thread(task2).start();\n        String result1=task1.get();\n        String result2=task2.get();\n        System.out.println(result1);\n        System.out.println(result2);\n\n    }\n}\n```\n\n![å¾®ä¿¡æˆªå›¾_20190925164446.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/P6xT6EVD3eHPkU8OTBCAYWKV)\nç»“æœæ­£ç¡®\n\n\n5. æ‰‹å†™çº¿ç¨‹æ± \n```Java\npublic class FixedSizeThreadPool {\n    private BlockingQueue<Runnable> blockingQueue;\n    private LinkedBlockingQueue<Thread> workers;\n\n    /**\n     * @param pollSize çº¿ç¨‹æ± æ•°é‡\n     * @param taskSize ä»»åŠ¡æ•°é‡\n     * @return\n     **/\n    public FixedSizeThreadPool(int pollSize, int taskSize) {\n        if (pollSize <= 0 || taskSize <= 0) {\n            throw new IllegalArgumentException(\"éæ³•å‚æ•°\");\n        }\n        this.blockingQueue = new LinkedBlockingQueue<>(taskSize);\n        this.workers = new LinkedBlockingQueue<>(pollSize);\n\n        for (int i = 0; i < pollSize; i++) {\n            Worker worker = new Worker(this);\n            worker.start();\n            ;\n            workers.add(worker);\n        }\n    }\n\n    public Boolean submit(Runnable task) {\n        if (isWorking) {\n            return this.blockingQueue.offer(task);\n        } else {\n            return false;\n        }\n    }\n\n    private volatile boolean isWorking = true;\n\n    public void shutdown() {\n        this.isWorking = false;\n        for (Thread thread : workers) {\n            if(thread.getState().equals(Thread.State.BLOCKED)){\n                thread.interrupt();\n            }\n        }\n    }\n\n    public static class Worker extends Thread {\n        private FixedSizeThreadPool pool;\n\n        public Worker(FixedSizeThreadPool pool) {\n            this.pool = pool;\n        }\n\n        @Override\n        public void run() {\n            while (this.pool.isWorking || this.pool.blockingQueue.size() > 0) {\n                Runnable task = null;\n                try {\n                    //é˜»å¡æ–¹æ³•è·å–ä»»åŠ¡\n                    if (this.pool.isWorking) {\n                        task = this.pool.blockingQueue.take();\n                    } else {\n                        task = this.pool.blockingQueue.poll();\n                    }\n\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                if (task != null) {\n                    task.run();\n                    System.out.println(\"çº¿ç¨‹\" + Thread.currentThread().getName() + \"æ‰§è¡Œå®Œæ¯•\");\n                }\n            }\n        }\n    }\n\n    public static void main(String[] args) {\n        FixedSizeThreadPool fixedSizeThreadPool = new FixedSizeThreadPool(3, 6);\n        for (int i = 0; i < 6; i++) {\n            fixedSizeThreadPool.submit(new Runnable() {\n                @Override\n                public void run() {\n                    System.out.println(\"æ”¾å…¥ä¸€ä¸ªçº¿ç¨‹\");\n                    try {\n                        Thread.sleep(2000L);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            });\n        }\n        fixedSizeThreadPool.shutdown();\n    }\n}\n```\n\nå¥½åƒæ²¡å•¥éš¾åº¦ï¼Œè®¤çœŸçœ‹ä¸€ä¸‹åº”è¯¥å°±èƒ½æ‡‚äº†ã€‚');
INSERT INTO `blog_content` VALUES (44, '### ç›¸å…³ä»£ç åœ°å€\n[æ’åº](https://github.com/yhuihu/Java-Study/tree/master/sort)\n### å†’æ³¡æ’åº\n- æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢å®ƒä»¬ä¸¤ä¸ªï¼›\n- å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ï¼Œè¿™æ ·åœ¨æœ€åçš„å…ƒç´ åº”è¯¥ä¼šæ˜¯æœ€å¤§çš„æ•°ï¼›\n- é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼›\n- é‡å¤æ­¥éª¤1~3ï¼Œç›´åˆ°æ’åºå®Œæˆã€‚\n\n![640.gif](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/BbuMRqNNeUqSGIT8Ope1vToz)\n```java\n    /**\n     * å†’æ³¡æ’åº\n     *\n     * @param array\n     */\n    public static void bubbleSort(int[] array) {\n        int flag;\n        if (array.length == 0) {\n            return;\n        }\n        for (int i = 0; i < array.length; i++) {\n            flag = 0;\n            for (int j = 0; j < array.length - 1 - i; j++) {\n                if (array[j + 1] < array[j]) {\n                    int temp = array[j + 1];\n                    array[j + 1] = array[j];\n                    array[j] = temp;\n                    flag = 1;\n                }\n            }\n            if (flag == 0) {\n                break;\n            }\n        }\n    }\n```\n\n### é€‰æ‹©æ’åº\nnä¸ªè®°å½•çš„ç›´æ¥é€‰æ‹©æ’åºå¯ç»è¿‡n-1è¶Ÿç›´æ¥é€‰æ‹©æ’åºå¾—åˆ°æœ‰åºç»“æœã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š\n- åˆå§‹çŠ¶æ€ï¼šæ— åºåŒºä¸ºR[1..n]ï¼Œæœ‰åºåŒºä¸ºç©ºï¼›\n- ç¬¬iè¶Ÿæ’åº(i=1,2,3â€¦n-1)å¼€å§‹æ—¶ï¼Œå½“å‰æœ‰åºåŒºå’Œæ— åºåŒºåˆ†åˆ«ä¸ºR[1..i-1]å’ŒR(i..nï¼‰ã€‚è¯¥è¶Ÿæ’åºä»å½“å‰æ— åºåŒºä¸­-é€‰å‡ºå…³é”®å­—æœ€å°çš„è®°å½• R[k]ï¼Œå°†å®ƒä¸æ— åºåŒºçš„ç¬¬1ä¸ªè®°å½•Räº¤æ¢ï¼Œä½¿R[1..i]å’ŒR[i+1..n)åˆ†åˆ«å˜ä¸ºè®°å½•ä¸ªæ•°å¢åŠ 1ä¸ªçš„æ–°æœ‰åºåŒºå’Œè®°å½•ä¸ªæ•°å‡å°‘1ä¸ªçš„æ–°æ— åºåŒºï¼›\n- n-1è¶Ÿç»“æŸï¼Œæ•°ç»„æœ‰åºåŒ–äº†ã€‚\n\n\n![640 1.gif](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/7eCfHzQiNzTK94nahFGt6G2Y)\n```java\n    /**\n     * é€‰æ‹©æ’åº\n     *\n     * @param array\n     */\n    public static void selectionSort(int[] array) {\n        if (array.length == 0) {\n            return;\n        }\n        for (int i = 0; i < array.length; i++) {\n            int minIndex = i;\n            for (int j = i; j < array.length; j++) {\n                //æ‰¾åˆ°æœ€å°çš„æ•°\n                if (array[j] < array[minIndex]) {\n                    //å°†æœ€å°æ•°çš„ç´¢å¼•ä¿å­˜\n                    minIndex = j;\n                }\n            }\n            if (minIndex != i) {\n                int temp = array[minIndex];\n                array[minIndex] = array[i];\n                array[i] = temp;\n            }\n        }\n    }\n```\n\n### æ’å…¥æ’åº\nä¸€èˆ¬æ¥è¯´ï¼Œæ’å…¥æ’åºéƒ½é‡‡ç”¨in-placeåœ¨æ•°ç»„ä¸Šå®ç°ã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š\n- ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åºï¼›\n- å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼›\n- å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®ï¼›\n- é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®ï¼›\n- å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®åï¼›\n- é‡å¤æ­¥éª¤2~5ã€‚\n\n![640 2.gif](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/wJ6facTkKijKw9CKSvoQIsgK)\n```java\n    /**\n     * æ’å…¥æ’åº\n     *\n     * @param array\n     */\n    public static void insertionSort(int[] array) {\n        int i, j, k;\n        for (i = 1; i < array.length; i++) {\n            int temp = array[i];\n            for (j = i - 1; j >= 0; j--) {\n                if (array[j] > temp) {\n                    array[j + 1] = array[j];\n                } else {\n                    break;\n                }\n            }\n            array[j + 1] = temp;\n        }\n    }\n```\n\n### å¸Œå°”æ’åº\nå…ˆå°†æ•´ä¸ªå¾…æ’åºçš„è®°å½•åºåˆ—åˆ†å‰²æˆä¸ºè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå…·ä½“ç®—æ³•æè¿°ï¼š\n- é€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—t1ï¼Œt2ï¼Œâ€¦ï¼Œtkï¼Œå…¶ä¸­ti>tjï¼Œtk=1ï¼›\n- æŒ‰å¢é‡åºåˆ—ä¸ªæ•°kï¼Œå¯¹åºåˆ—è¿›è¡Œk è¶Ÿæ’åºï¼›\n- æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸ºm çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»…å¢é‡å› å­ä¸º1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚\n\n![å¾®ä¿¡æˆªå›¾_20191008114253.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/uUnNkJHtKpafEBTTFD6i4TI8)\n```java\n    /**\n     * å¸Œå°”æ’åº\n     *\n     * @param array\n     */\n    public static void shellSort(int[] array) {\n        int len = array.length;\n        int temp, gap = len / 2;\n        while (gap > 0) {\n            for (int i = gap; i < len; i++) {\n                temp = array[i];\n                int preIndex = i - gap;\n                while (preIndex >= 0 && array[preIndex] > temp) {\n                    array[preIndex + gap] = array[preIndex];\n                    preIndex -= gap;\n                }\n                array[preIndex + gap] = temp;\n            }\n            gap /= 2;\n        }\n    }\n```\n\n### å½’å¹¶æ’åº\nå½’å¹¶æ’åºï¼ˆMERGE-SORTï¼‰æ˜¯åˆ©ç”¨å½’å¹¶çš„æ€æƒ³å®ç°çš„æ’åºæ–¹æ³•ï¼Œè¯¥ç®—æ³•é‡‡ç”¨ç»å…¸çš„åˆ†æ²»ï¼ˆdivide-and-conquerï¼‰ç­–ç•¥ï¼ˆåˆ†æ²»æ³•å°†é—®é¢˜åˆ†(divide)æˆä¸€äº›å°çš„é—®é¢˜ç„¶åé€’å½’æ±‚è§£ï¼Œè€Œæ²»(conquer)çš„é˜¶æ®µåˆ™å°†åˆ†çš„é˜¶æ®µå¾—åˆ°çš„å„ç­”æ¡ˆ\"ä¿®è¡¥\"åœ¨ä¸€èµ·ï¼Œå³åˆ†è€Œæ²»ä¹‹)ã€‚\n\n![å¾®ä¿¡æˆªå›¾_20191008114737.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/7fW78Ne6jGGYwXA03idQQhh9)\nå†æ¥çœ‹çœ‹æ²»é˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸¤ä¸ªå·²ç»æœ‰åºçš„å­åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­çš„æœ€åä¸€æ¬¡åˆå¹¶ï¼Œè¦å°†[4,5,7,8]å’Œ[1,2,3,6]ä¸¤ä¸ªå·²ç»æœ‰åºçš„å­åºåˆ—ï¼Œåˆå¹¶ä¸ºæœ€ç»ˆåºåˆ—[1,2,3,4,5,6,7,8]ï¼Œæ¥çœ‹ä¸‹å®ç°æ­¥éª¤ã€‚\n![å¾®ä¿¡æˆªå›¾_20191008114948.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/rlwWDFKIYuhjWdYovoYuXlTp)\n![å¾®ä¿¡æˆªå›¾_20191008115001.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/0VEYPdhhxiWJzeT50Eh900ps)\nç®—æ³•æ€è·¯ï¼š\n- æŠŠé•¿åº¦ä¸ºnçš„è¾“å…¥åºåˆ—åˆ†æˆä¸¤ä¸ªé•¿åº¦ä¸ºn/2çš„å­åºåˆ—ï¼›\n- å¯¹è¿™ä¸¤ä¸ªå­åºåˆ—åˆ†åˆ«é‡‡ç”¨å½’å¹¶æ’åºï¼›\n- å°†ä¸¤ä¸ªæ’åºå¥½çš„å­åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ€ç»ˆçš„æ’åºåºåˆ—ã€‚\n\n![640 3.gif](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/Q1Fcq2bJZf2U21DmeLKXmwgR)\n\n```java\n    public static void sort(int[] arr) {\n        int[] temp = new int[arr.length];\n        //åœ¨æ’åºå‰ï¼Œå…ˆå»ºå¥½ä¸€ä¸ªé•¿åº¦ç­‰äºåŸæ•°ç»„é•¿åº¦çš„ä¸´æ—¶æ•°ç»„ï¼Œ\n        //é¿å…é€’å½’ä¸­é¢‘ç¹å¼€è¾Ÿç©ºé—´\n        sort(arr, 0, arr.length - 1, temp);\n    }\n\n    private static void sort(int[] arr, int left, int right, int[] temp) {\n        int mid = (left + right) / 2;\n        // å­æ•°ç»„é•¿åº¦å¤§äº1æ—¶ï¼Œè¿›è¡Œæ‹†åˆ†\n        if (left < right) {\n            //å·¦è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å·¦å­åºåˆ—æœ‰åº\n            sort(arr, left, mid, temp);\n            //å³è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å³å­åºåˆ—æœ‰åº\n            sort(arr, mid + 1, right, temp);\n        }\n        //å°†ä¸¤ä¸ªæœ‰åºå­æ•°ç»„åˆå¹¶æ“ä½œ\n        merge(arr, left, mid, right, temp);\n    }\n\n    private static void merge(int[] arr, int left, int mid, int right, int[] temp) {\n        //å·¦åºåˆ—æŒ‡é’ˆ\n        int i = left;\n        //å³åºåˆ—æŒ‡é’ˆ\n        int j = mid + 1;\n        //ä¸´æ—¶æ•°ç»„æŒ‡é’ˆ\n        int t = 0;\n        while (i <= mid && j <= right) {\n            if (arr[i] <= arr[j]) {\n                temp[t++] = arr[i++];\n            } else {\n                temp[t++] = arr[j++];\n            }\n        }\n        //å°†å·¦è¾¹å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­\n        while (i <= mid) {\n            temp[t++] = arr[i++];\n        }\n        //å°†å³åºåˆ—å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­\n        while (j <= right) {\n            temp[t++] = arr[j++];\n        }\n        t = 0;\n        //å°†tempä¸­çš„å…ƒç´ å…¨éƒ¨æ‹·è´åˆ°åŸæ•°ç»„ä¸­\n        while (left <= right) {\n            arr[left++] = temp[t++];\n        }\n    }\n```\n\n### å¿«é€Ÿæ’åº\n![19403173bf6002ba2c0b90b.gif](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/Jx5PuV9EdnbrkW7YUEsJr4YZ)\n```java\npublic class QuickSort {\n    private static int count;\n\n    /**\n     * æµ‹è¯•\n     *\n     * @param args\n     */\n    public static void main(String[] args) {\n        int[] num = {3, 45, 78, 64, 52, 11, 64, 55, 99, 11, 18};\n        System.out.println(arrayToString(num, \"æœªæ’åº\"));\n        quickSort(num, 0, num.length - 1);\n        System.out.println(arrayToString(num, \"æ’åº\"));\n        System.out.println(\"æ•°ç»„ä¸ªæ•°ï¼š\" + num.length);\n        System.out.println(\"å¾ªç¯æ¬¡æ•°ï¼š\" + count);\n\n    }\n\n    /**\n     * å¿«é€Ÿæ’åº\n     *\n     * @param num   æ’åºçš„æ•°ç»„\n     * @param left  æ•°ç»„çš„å‰é’ˆ\n     * @param right æ•°ç»„åé’ˆ\n     */\n    private static void quickSort(int[] num, int left, int right) {\n        //å¦‚æœleftç­‰äºrightï¼Œå³æ•°ç»„åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œç›´æ¥è¿”å›\n        if (left >= right) {\n            return;\n        }\n        //è®¾ç½®æœ€å·¦è¾¹çš„å…ƒç´ ä¸ºåŸºå‡†å€¼\n        int key = num[left];\n        //æ•°ç»„ä¸­æ¯”keyå°çš„æ”¾åœ¨å·¦è¾¹ï¼Œæ¯”keyå¤§çš„æ”¾åœ¨å³è¾¹ï¼Œkeyå€¼ä¸‹æ ‡ä¸ºi\n        int i = left;\n        int j = right;\n        while (i < j) {\n            //jå‘å·¦ç§»ï¼Œç›´åˆ°é‡åˆ°æ¯”keyå°çš„å€¼\n            while (num[j] >= key && i < j) {\n                j--;\n            }\n            //iå‘å³ç§»ï¼Œç›´åˆ°é‡åˆ°æ¯”keyå¤§çš„å€¼\n            while (num[i] <= key && i < j) {\n                i++;\n            }\n            //iå’ŒjæŒ‡å‘çš„å…ƒç´ äº¤æ¢\n            if (i < j) {\n                int temp = num[i];\n                num[i] = num[j];\n                num[j] = temp;\n            }\n        }\n        num[left] = num[i];\n        num[i] = key;\n        count++;\n        quickSort(num, left, i - 1);\n        quickSort(num, i + 1, right);\n    }\n\n    /**\n     * å°†ä¸€ä¸ªintç±»å‹æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸²\n     *\n     * @param arr\n     * @param flag\n     * @return\n     */\n    private static String arrayToString(int[] arr, String flag) {\n        String str = \"æ•°ç»„ä¸º(\" + flag + \")ï¼š\";\n        for (int a : arr) {\n            str += a + \"\\t\";\n        }\n        return str;\n    }\n}\n```\n\n\n### å‚è€ƒ\n[åå¤§ç»å…¸æ’åºç®—æ³•æœ€å¼ºæ€»ç»“](https://mp.weixin.qq.com/s?__biz=MzU2MTI4MjI0MQ==&mid=2247487252&idx=1&sn=c54b06312dc4f450464b01b92734f7fb&chksm=fc7a62bacb0debac6dab940a5a8c46a85d111bdb79745398e094136079c99cd79dee59c0b883&mpshare=1&scene=1&srcid=1007i2NeSIuuOnBwiqhPqQfm&sharer_sharetime=1570497271031&sharer_shareid=b628fd8f6c15b9b5095c1e3c662fc26a&key=28a0f481c5d883ac3fe109b2f02f43b65163c5730df8a6e7101af690a3e423683aeed1114415c6086860ea9fdffede5b19f5422ec597711495e06ea7fbc399211b0f3357a644cb6d17695b7df3779f49&ascene=1&uin=NTcwMTgyNzQw&devicetype=Windows+10&version=62060833&lang=zh_CN&pass_ticket=xbz3%2BsSp4SBrm9W6XLQh74M3wUv8VWcjKqExvbxtK5O3gGM5z9R1gSYQimvbEYYx)');
INSERT INTO `blog_content` VALUES (45, '### æ¦‚è¿°\n\n\næ¶ˆæ¯é˜Ÿåˆ—ä½œä¸ºé«˜å¹¶å‘ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œèƒ½å¤Ÿå¸®åŠ©ä¸šåŠ¡ç³»ç»Ÿè§£æ„æå‡å¼€å‘æ•ˆç‡å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚ä¸»è¦å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š\n\n\n- å‰Šå³°å¡«è°·ï¼š ä¸»è¦è§£å†³ç¬æ—¶å†™å‹åŠ›å¤§äºåº”ç”¨æœåŠ¡èƒ½åŠ›å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€ç³»ç»Ÿå¥”æºƒç­‰é—®é¢˜\n- ç³»ç»Ÿè§£è€¦ï¼š è§£å†³ä¸åŒé‡è¦ç¨‹åº¦ã€ä¸åŒèƒ½åŠ›çº§åˆ«ç³»ç»Ÿä¹‹é—´ä¾èµ–å¯¼è‡´ä¸€æ­»å…¨æ­»\n- æå‡æ€§èƒ½ï¼š å½“å­˜åœ¨ä¸€å¯¹å¤šè°ƒç”¨æ—¶ï¼Œå¯ä»¥å‘ä¸€æ¡æ¶ˆæ¯ç»™æ¶ˆæ¯ç³»ç»Ÿï¼Œè®©æ¶ˆæ¯ç³»ç»Ÿé€šçŸ¥ç›¸å…³ç³»ç»Ÿ\n- è“„æµå‹æµ‹ï¼š çº¿ä¸Šæœ‰äº›é“¾è·¯ä¸å¥½å‹æµ‹ï¼Œå¯ä»¥é€šè¿‡å †ç§¯ä¸€å®šé‡æ¶ˆæ¯å†æ”¾å¼€æ¥å‹æµ‹\n\n### RocketMQ\nApache Alibaba RocketMQ æ˜¯ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶ã€‚æ¶ˆæ¯ä¸­é—´ä»¶ä¸­æœ‰ä¸¤ä¸ªè§’è‰²ï¼šæ¶ˆæ¯ç”Ÿäº§è€…å’Œæ¶ˆæ¯æ¶ˆè´¹è€…ã€‚RocketMQ é‡ŒåŒæ ·æœ‰è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæ¶ˆæ¯ç”Ÿäº§è€…è´Ÿè´£åˆ›å»ºæ¶ˆæ¯å¹¶å‘é€åˆ° RocketMQ æœåŠ¡å™¨ï¼ŒRocketMQ æœåŠ¡å™¨ä¼šå°†æ¶ˆæ¯æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ¶ˆæ¯æ¶ˆè´¹è€…ä» RocketMQ æœåŠ¡å™¨æ‹‰å–æ¶ˆæ¯å¹¶æäº¤ç»™åº”ç”¨æ¶ˆè´¹ã€‚\n\n### RocketMQ ç‰¹ç‚¹\nRocketMQ æ˜¯ä¸€æ¬¾åˆ†å¸ƒå¼ã€é˜Ÿåˆ—æ¨¡å‹çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\n- æ”¯æŒä¸¥æ ¼çš„æ¶ˆæ¯é¡ºåº\n- æ”¯æŒ Topic ä¸ Queue ä¸¤ç§æ¨¡å¼\n- äº¿çº§æ¶ˆæ¯å †ç§¯èƒ½åŠ›\n- æ¯”è¾ƒå‹å¥½çš„åˆ†å¸ƒå¼ç‰¹æ€§\n- åŒæ—¶æ”¯æŒ Push ä¸ Pull æ–¹å¼æ¶ˆè´¹æ¶ˆæ¯\n\n### RocketMQ ä¼˜åŠ¿\nç›®å‰ä¸»æµçš„ MQ ä¸»è¦æ˜¯ RocketMQã€kafkaã€RabbitMQï¼Œå…¶ä¸»è¦ä¼˜åŠ¿æœ‰ï¼š\n- æ”¯æŒäº‹åŠ¡å‹æ¶ˆæ¯ï¼ˆæ¶ˆæ¯å‘é€å’Œ DB æ“ä½œä¿æŒä¸¤æ–¹çš„æœ€ç»ˆä¸€è‡´æ€§ï¼ŒRabbitMQ å’Œ Kafka ä¸æ”¯æŒï¼‰\n- æ”¯æŒç»“åˆ RocketMQ çš„å¤šä¸ªç³»ç»Ÿä¹‹é—´æ•°æ®æœ€ç»ˆä¸€è‡´æ€§ï¼ˆå¤šæ–¹äº‹åŠ¡ï¼ŒäºŒæ–¹äº‹åŠ¡æ˜¯å‰æï¼‰\n- æ”¯æŒ 18 ä¸ªçº§åˆ«çš„å»¶è¿Ÿæ¶ˆæ¯ï¼ˆRabbitMQ å’Œ Kafka ä¸æ”¯æŒï¼‰\n- æ”¯æŒæŒ‡å®šæ¬¡æ•°å’Œæ—¶é—´é—´éš”çš„å¤±è´¥æ¶ˆæ¯é‡å‘ï¼ˆKafka ä¸æ”¯æŒï¼ŒRabbitMQ éœ€è¦æ‰‹åŠ¨ç¡®è®¤ï¼‰\n- æ”¯æŒ Consumer ç«¯ Tag è¿‡æ»¤ï¼Œå‡å°‘ä¸å¿…è¦çš„ç½‘ç»œä¼ è¾“ï¼ˆRabbitMQ å’Œ Kafka ä¸æ”¯æŒï¼‰\n- æ”¯æŒé‡å¤æ¶ˆè´¹ï¼ˆRabbitMQ ä¸æ”¯æŒï¼ŒKafka æ”¯æŒï¼‰\n\n### å®‰è£…\nç­‰å¾…æ›´æ–°\n\n### JAVAç”Ÿäº§è€…é…ç½®\nç­‰å¾…æ›´æ–°\n\n### JAVAæ¶ˆè´¹è€…é…ç½®\nç­‰å¾…æ›´æ–°\n\n### å®Œæˆå¯é äº‹åŠ¡demo\nç­‰å¾…æ›´æ–°');
INSERT INTO `blog_content` VALUES (46, 'ï¼ˆä¸ªäººæ€»ç»“ï¼Œä»…ä¾›å‚è€ƒï¼‰\n\n# JavaåŸºç¡€\n\n### æ¥å£ç±»å’ŒæŠ½è±¡ç±»çš„å·®åˆ«\n\n1. æ¥å£æ˜¯ç»å¯¹æŠ½è±¡çš„ï¼Œä¸å¯ä»¥è¢«å®ä¾‹åŒ–æˆå¯¹è±¡ã€‚æŠ½è±¡ç±»ä¹Ÿä¸å¯ä»¥è¢«å®ä½“åŒ–ï¼Œå¯æ˜¯å¦‚æœæŠ½è±¡ç±»ä¸­æœ‰mainæ–¹æ³•çš„è¯å¯ä»¥è¢«è°ƒç”¨ã€‚\n2. æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯éšè—æŠ½è±¡çš„ã€‚æŠ½è±¡ç±»ä¸­å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ä¹Ÿå¯ä»¥åŒ…å«éæŠ½è±¡æ–¹æ³•ã€‚\n3. ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œå¯æ˜¯åªå¯ä»¥ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ã€‚\n4. æ¥å£ä¸­å£°æ˜çš„å˜é‡éƒ½æ˜¯è¢«finalå…³é”®å­—ä¿®é¥°çš„ã€‚æŠ½è±¡ç±»ä¸­çš„å˜é‡å¯ä»¥æ˜¯éfinalçš„ã€‚\n5. æŠ½è±¡ç±»å¯ä»¥åœ¨ä¸æä¾›æ¥å£å®ç°ç±»çš„åŸºç¡€ä¸Šæä¾›æ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚\n6. æ¥å£ä¸­çš„æ–¹æ³•é»˜è®¤æ˜¯publicçš„ã€‚æŠ½è±¡ç±»çš„æ–¹æ³•å¯ä»¥æ˜¯privateï¼Œprotectedï¼Œpublicçš„ã€‚\n\n### Javaç±»åŠ è½½è¿‡ç¨‹\n[æ·±å…¥æµ…å‡ºJavaç±»åŠ è½½è¿‡ç¨‹](https://www.cnblogs.com/luohanguo/p/9469851.html)\n[JVMï¼ˆä¸‰ï¼‰ï¼šç±»åŠ è½½æœºåˆ¶ï¼ˆç±»åŠ è½½è¿‡ç¨‹å’Œç±»åŠ è½½å™¨ï¼‰](https://blog.csdn.net/boyupeng/article/details/47951037?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task)\n\n\n### Mapçš„åˆ†ç±»å’Œå¸¸è§æƒ…å†µ\n\n![7010483_1496974867310_D5D2D67073C3D04D7B608AD94C2886F0.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ZM3KBAQzylT4wezkEQ1sbti4)\n\n1. Mapçš„å››ä¸ªå®ç°ç±»ä¸º`HashMap`ï¼Œ`HashTable`ï¼Œ`LinkHashMap`å’Œ`TreeMap`ã€‚Mapæ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨çš„ï¼Œå› æ­¤ä¸å…è®¸é”®é‡å¤ï¼Œå¯æ˜¯å€¼å¯ä»¥é‡ï¼Œå¦‚æœé”®ç›¸åŒä¼šç›´æ¥è¦†ç›–ã€‚\n2. å¹³æ—¶æˆ‘ä»¬ç”¨çš„æœ€å¤šçš„Mapæ˜¯`HashMap`ï¼Œå®ƒæ ¹æ®é”®å€¼çš„`HashCode`æ¥å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥é€šè¿‡é”®ç›´æ¥è·å–åˆ°å¯¹åº”çš„å€¼ï¼Œæ‰€ä»¥è®¿é—®é€Ÿåº¦å¾ˆå¿«ã€‚éå†æ—¶å–å¾—æ•°æ®çš„é¡ºåºæ˜¯éšæœºçš„ã€‚\n3. `HashMap`æœ€å¤šåªå…è®¸ä¸€æ¡è®°å½•çš„é”®ä¸ºnullï¼Œå…è®¸å¤šæ¡è®°å½•çš„å€¼ä¸ºnullã€‚\n4. `HashMap`ä¸æ”¯æŒçº¿ç¨‹çš„åŒæ­¥ï¼Œå³ä»»ä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™`HashMap`ï¼Œè¿™ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚å¦‚æœéœ€è¦çº¿ç¨‹åŒæ­¥ï¼Œå¯ä»¥ä½¿ç”¨`Collections`çš„`synchronizedMap`æ–¹æ³•æ¥ä½¿`HashMap`å…·æœ‰åŒæ­¥èƒ½åŠ›ï¼Œæˆ–è€…ç”¨`ConcurrentHashMap`ã€‚\n5. `Hashtable`ä¸`HashMap`ç±»ä¼¼ã€‚ä¸åŒçš„æ˜¯å®ƒä¸å…è®¸é”®æˆ–è€…å€¼ä¸ºç©ºï¼Œæ”¯æŒçº¿ç¨‹åŒæ­¥ï¼Œå› æ­¤ä¹Ÿå¯¼è‡´äº†åœ¨å†™å…¥çš„æ—¶å€™æ¯”è¾ƒæ…¢ã€‚\n6. `LinkedHashMap`æ˜¯`HashMap`çš„å­ç±»ï¼Œä¿å­˜äº†è®°å½•çš„æ’å…¥é¡ºåºã€‚\n7. `TreeMap`å¯ä»¥æŒ‰ç…§é”®å€¼æ¥æ’åºï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ’åºçš„è§„åˆ™ã€‚\n\n### ==æ¯”è¾ƒçš„æ˜¯ä»€ä¹ˆ\n\n&emsp;&emsp;\"==\"å¯¹æ¯”ä¸¤ä¸ªå¯¹è±¡çš„æ—¶å€™æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å†…å­˜å¼•ç”¨æ˜¯å¦å®Œå…¨ç›¸åŒã€‚å¦‚æœä¸¤è¾¹æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ¯”è¾ƒçš„æ˜¯æ•°å€¼æ˜¯å¦ç›¸ç­‰ã€‚\n\n\n### equals()æ–¹æ³•é»˜è®¤æ˜¯æ¯”è¾ƒä»€ä¹ˆçš„ï¼Ÿ\n\n&emsp;&emsp;å¦‚æœä¸é‡å†™equals()æ–¹æ³•ï¼Œé»˜è®¤æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„åœ°å€ã€‚\n\n### Javaæ”¯æŒçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†è£…ç®±\n\n&emsp;&emsp;å…«ç§æ•°æ®ç±»å‹ï¼š`byte`ï¼Œ`short`ï¼Œ`int`ï¼Œ`long`ï¼Œ`float`ï¼Œ`double`ï¼Œ`char`ï¼Œ`boolean`ã€‚\n&emsp;&emsp;è‡ªåŠ¨è£…ç®±æ˜¯æŒ‡åœ¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹åº”çš„å¯¹è±¡åŒ…è£…ç±»å‹ä¹‹é—´åšçš„ä¸€ä¸ªè½¬åŒ–ï¼Œåä¹‹å°±æ˜¯è‡ªåŠ¨æ‹†ç®±ã€‚\n\n### Arrayå’ŒArrayListçš„åŒºåˆ«\n\n&emsp;&emsp;`Array`å¯ä»¥åŒ…å«åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹è±¡ï¼Œ`ArrayList`åªå¯ä»¥åŒ…å«å¯¹è±¡ã€‚\n&emsp;&emsp;`Array`å¤§å°æ˜¯å›ºå®šçš„ï¼Œ`ArrayList`çš„å¤§å°æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚\n\n### StringBufferå’ŒStringBuilderçš„åŒºåˆ«\n\n&emsp;&emsp;`StringBuffer`æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œ`StringBuilder`æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚`StringBuffer`å…¶å®å°±æ˜¯æ¯”`StringBuilder`å¤šäº†`Synchronized`ä¿®é¥°ç¬¦\n\n### Synchronizationå’ŒLock\n\n&emsp;&emsp;`Lock`æ¯”`Synchronization`çš„æ–¹æ³•å¤šï¼Œå¯ä»¥åœ¨å¤šç§åœºæ™¯ä¸­ä½¿ç”¨åˆ°Lockçš„ä¸åŒæ–¹æ³•; synchronizationå¯ä»¥åœ¨æ‰§è¡Œå®Œè‡ªåŠ¨é‡Šæ”¾é”ï¼Œè€ŒLockéœ€è¦`lock.unlock()`;æ¥é‡Šæ”¾é”ï¼Œä¸€èˆ¬å†™åœ¨`try{}catch{}finally{ lock.unlock();}`çš„finallyä¸­\n\n### è®¿é—®æƒé™\n\n![3807435_1531360217902_D706FD89218075198372990150A023A8.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/bMw9FC8B3eF2XAot3IWaqEyG)\n\n\n### é™æ€åŒæ­¥synchronizedæ–¹æ³•ä¸synchronizedï¼ˆclassï¼‰ä»£ç å—\n- å…³é”®å­—synchronizedè¿˜å¯ä»¥åº”ç”¨åœ¨staticé™æ€æ–¹æ³•ä¸Šï¼Œå¦‚æœè¿™æ ·å†™ï¼Œé‚£æ˜¯å¯¹å½“å‰çš„*.javaæ–‡ä»¶å¯¹åº”çš„Classç±»è¿›è¡ŒæŒé”ã€‚\n- synchronizedå…³é”®å­—åŠ åˆ°staticé™æ€æ–¹æ³•ä¸Šæ˜¯ç»™Classç±»ä¸Šé”ï¼Œè€Œsynchronizedå…³é”®å­—åŠ åˆ°éstaticé™æ€æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡ä¸Šé”ã€‚\n- å¼‚æ­¥çš„åŸå› æ˜¯æŒæœ‰ä¸åŒçš„é”ï¼Œä¸€ä¸ªæ˜¯å¯¹è±¡é”ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯Classé”ï¼Œè€ŒClassé”å¯ä»¥å¯¹ç±»çš„æ‰€æœ‰å¯¹è±¡å®ä¾‹èµ·ä½œç”¨ã€‚\n- åŒæ­¥synchronizedï¼ˆclassï¼‰ä»£ç å—çš„ä½œç”¨å…¶å®å’Œsynchronized staticæ–¹æ³•çš„ä½œç”¨ä¸€æ ·ã€‚\n\n### JVMåˆ†åŒºï¼ˆæ²¡æœ‰æ·±å…¥äº†è§£ï¼‰\n\n![281726404166686.jpg](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ZRfuu9vpMbpypowGaSYgku6H)\n\n### é‡è½½å’Œé‡å†™çš„åŒºåˆ«ï¼Œé‡è½½çš„è¦æ±‚æ˜¯ä»€ä¹ˆ\n\né‡è½½ï¼š\n\n1. æ–¹æ³•é‡è½½æ˜¯è®©ç±»ä»¥ç»Ÿä¸€çš„æ–¹å¼å¤„ç†ä¸åŒç±»å‹æ•°æ®çš„ä¸€ç§æ‰‹æ®µã€‚å¤šä¸ªåŒåå‡½æ•°åŒæ—¶å­˜åœ¨ï¼Œå…·æœ‰ä¸åŒçš„å‚æ•°ä¸ªæ•°/ç±»å‹ã€‚ï¼ˆé‡è½½æ˜¯ä¸€ä¸ªç±»ä¸­å¤šæ€æ€§çš„ä¸€ç§è¡¨ç°ï¼‰\n2. é‡è½½çš„æ—¶å€™è¦æ±‚æ–¹æ³•åä¸€æ ·ï¼Œä½†æ˜¯å‚æ•°çš„ç±»å‹å’Œä¸ªæ•°ä¸ä¸€æ ·ï¼Œè¿”å›ç±»å‹å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸åŒã€‚ä½†æ˜¯ä¸èƒ½ä»¥è¿”å›ç±»å‹ä½œä¸ºé‡è½½å‡½æ•°çš„åŒºåˆ†æ ‡å‡†ã€‚\n\né‡å†™ï¼š\n\n1. çˆ¶ç±»ä¸å­ç±»å¤šæ€æ€§çš„è¡¨ç°ï¼Œå¯¹çˆ¶ç±»çš„å‡½æ•°è¿›è¡Œé‡æ–°å®šä¹‰ã€‚å¦‚æœåœ¨å­ç±»ä¸­å®šä¹‰æŸæ–¹æ³•ä¸å…¶çˆ¶ç±»æœ‰ç›¸åŒçš„åç§°å’Œå‚æ•°ï¼Œè¿™ç§æ–¹æ³•å«é‡å†™ã€‚ç»§æ‰¿çˆ¶ç±»ä¸éœ€è¦é‡æ–°ç¼–å†™ç›¸åŒçš„æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥é‡å†™ã€‚ï¼ˆæ–¹æ³•é‡å†™åˆå«è¦†ç›–ï¼‰\n2. å­å‡½æ•°çš„è®¿é—®æƒé™ä¸èƒ½å°‘äºçˆ¶ç±»çš„ã€‚\n\n### \"static\"æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸJavaä¸­å¯ä»¥è¦†ç›–ä¸€ä¸ªprivateæˆ–è€…staticçš„æ–¹æ³•å—\n\n1. \"static\"å…³é”®å­—è¡¨æ˜ä¸€ä¸ªæˆå‘˜å˜é‡æˆ–è€…æˆå‘˜æ–¹æ³•å¯ä»¥åœ¨æ²¡æœ‰æ‰€å±ç±»çš„å®ä¾‹çš„æƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚\n2. \"static\"æ–¹æ³•æ˜¯ä¸å¯ä»¥è¢«è¦†ç›–çš„ï¼Œå› ä¸ºæ–¹æ³•è¦†ç›–æ˜¯åŸºäºè¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ï¼Œè€Œstaticæ–¹æ³•æ˜¯åœ¨ç¼–è¯‘æ—¶é™æ€ç»‘å®šçš„ã€‚staticæ–¹æ³•è·Ÿç±»çš„ä»»ä½•å®ä¾‹éƒ½ä¸æŒ‚é’©ï¼Œæ‰€ä»¥æ¦‚å¿µä¸Šä¸é€šç”¨ã€‚\n\n### StringBufferå’ŒStringBuilderæœ‰ä»€ä¹ˆåŒºåˆ«\n\n1. `StringBuffer`çº¿ç¨‹å®‰å…¨ï¼Œ`StringBuilder`çº¿ç¨‹ä¸å®‰å…¨ã€‚\n2. åº•å±‚å®ç°ä¸Š`StringBuffer`æ¯”`StringBuilder`å¤šäº†Synchronizedä¿®é¥°ç¬¦ã€‚\n\n### æ·±æ‹·è´ä¸æµ…æ‹·è´\næµ…æ‹·è´æŒ‡çš„æ˜¯ï¼šä¸€ä¸ªå¯¹è±¡å†…å¦‚æœå­˜åœ¨å¦ä¸€ä¸ªå¯¹è±¡` father.children`ï¼Œåœ¨æ‹·è´çš„å¯¹è±¡ä¸­ï¼Œè¿™ä¸ª`children`å¯¹è±¡å’ŒåŸå¯¹è±¡çš„`children`å¯¹è±¡ä¸æ˜¯åŒä¸€ä¸ªã€‚\næ·±æ‹·è´åˆ™ç›¸åã€‚\n\n\n### ä¸Šç•Œä¸ä¸‹ç•Œ\n\n> ä¸Šç•Œä¸å­˜ï¼Œä¸‹ç•Œä¸å–\n\n1. ä¸Šç•Œ<? extend Fruit>ï¼Œè¡¨ç¤ºæ‰€æœ‰ç»§æ‰¿Fruitçš„å­ç±»ï¼Œä½†æ˜¯å…·ä½“æ˜¯å“ªä¸ªå­ç±»ï¼Œæ— æ³•ç¡®å®šï¼Œæ‰€ä»¥è°ƒç”¨addçš„æ—¶å€™ï¼Œè¦addä»€ä¹ˆç±»å‹ï¼Œè°ä¹Ÿä¸çŸ¥é“ã€‚ä½†æ˜¯getçš„æ—¶å€™ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆå­ç±»ï¼Œè‚¯å®šæœ‰ä¸ªçˆ¶ç±»æ˜¯Fruitï¼Œæ‰€ä»¥ï¼Œæˆ‘éƒ½å¯ä»¥ç”¨æœ€å¤§çš„çˆ¶ç±»Fruitæ¥ç€ï¼Œä¹Ÿå°±æ˜¯æŠŠæ‰€æœ‰çš„å­ç±»å‘ä¸Šè½¬å‹ä¸ºFruitã€‚\n2. ä¸‹ç•Œ<? super Apple>ï¼Œè¡¨ç¤ºAppleçš„æ‰€æœ‰çˆ¶ç±»ï¼ŒåŒ…æ‹¬Fruitï¼Œä¸€ç›´å¯ä»¥è¿½æº¯åˆ°Objectã€‚é‚£ä¹ˆå½“addçš„æ—¶å€™ï¼Œæˆ‘ä¸èƒ½add Appleçš„çˆ¶ç±»ï¼Œå› ä¸ºä¸èƒ½ç¡®å®šListé‡Œé¢å­˜æ”¾çš„åˆ°åº•æ˜¯å“ªä¸ªçˆ¶ç±»ã€‚ä½†æ˜¯æˆ‘å¯ä»¥add AppleåŠå…¶å­ç±»ã€‚å› ä¸ºä¸ç®¡æˆ‘çš„å­ç±»æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå®ƒéƒ½å¯ä»¥å‘ä¸Šè½¬å‹ä¸ºAppleåŠå…¶æ‰€æœ‰çˆ¶ç±»ç”šè‡³è½¬å‹ä¸ºObjectã€‚ä½†æ˜¯å½“æˆ‘getçš„æ—¶å€™ï¼ŒAppleçš„çˆ¶ç±»è¿™ä¹ˆå¤šï¼Œæˆ‘ç”¨ä»€ä¹ˆæ¥ç€å‘¢ï¼Œé™¤äº†Objectï¼Œå…¶ä»–çš„éƒ½æ¥ä¸ä½ã€‚\n\n### é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢\n\n1. æŠ½è±¡\n   æŠ½è±¡å°±æ˜¯å¿½ç•¥ä¸€ä¸ªä¸»ä½“ä¸­ä¸å½“å‰ç›®æ ‡æ— å…³çš„é‚£äº›æ–¹é¢ï¼Œä»¥ä¾¿æ›´å……åˆ†çš„æ³¨æ„ä¸å½“å‰ç›®æ ‡æœ‰å…³çš„æ–¹é¢ã€‚æŠ½è±¡å¹¶ä¸æ‰“ç®—äº†è§£å…¨éƒ¨é—®é¢˜ï¼Œè€Œåªæ˜¯é€‰æ‹©å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæš‚æ—¶ä¸ç”¨éƒ¨åˆ†ç»†èŠ‚ã€‚æŠ½è±¡åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€æ˜¯è¿‡ç¨‹æŠ½è±¡ï¼ŒäºŒæ˜¯æ•°æ®æŠ½è±¡\n2. ç»§æ‰¿\n   ç»§æ‰¿æ˜¯ä¸€ç§è”ç»“ç±»çš„å±‚æ¬¡æ¨¡å‹ï¼Œå¹¶å…è®¸å’Œé¼“åŠ±ç±»çš„é‡ç”¨ï¼Œå®ƒæä¾›äº†ä¸€ç§æ˜ç¡®è¡¨è¿°å…±æ€§çš„æ–¹æ³•ï¼Œå¯¹è±¡çš„ä¸€ä¸ªæ–°ç±»å¯ä»¥ä»ç°æœ‰çš„ç±»ä¸­æ´¾ç”Ÿï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç»§æ‰¿ã€‚æ–°ç±»ç»§æ‰¿äº†åŸå§‹ç±»çš„ç‰¹æ€§ï¼Œæ–°ç±»ç§°ä¸ºåŸå§‹ç±»çš„æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰ï¼ŒäºŒåŸå§‹ç±»ç§°ä¸ºæ–°ç±»çš„åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰ã€‚æ´¾ç”Ÿç±»å¯ä»¥ä»å®ƒçš„åŸºç±»é‚£é‡Œç»§æ‰¿æ–¹æ³•å’Œå®ä¾‹å˜é‡ï¼Œå¹¶ä¸”ç±»å¯ä»¥ä¿®æ”¹æˆ–æ–°å¢æ–°çš„æ–¹æ³•ä½¿ä¹‹æ›´é€‚åˆç‰¹æ®Šçš„éœ€è¦ã€‚\n3. å°è£…\n   å°è£…æ˜¯æŠŠè¿‡ç¨‹å’Œæ•°æ®åŒ…å›´èµ·æ¥ï¼Œå¯¹æ•°æ®çš„è®¿é—®åªèƒ½é€šè¿‡å·²å®šä¹‰çš„ç•Œé¢ã€‚\n4. å¤šæ€æ€§\n   å¤šæ€æ€§æŒ‡çš„æ˜¯å…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯ä½œå‡ºå“åº”ã€‚å¤šæ€æ€§åŒ…æ‹¬å‚æ•°åŒ–å¤šæ€æ€§å’ŒåŒ…å«å¤šæ€æ€§ã€‚\n\n### final,finally,finalizeçš„åŒºåˆ«\n\n1. finalç”¨äºå£°æ˜å±æ€§ï¼Œæ–¹æ³•å’Œç±»ï¼Œåˆ†åˆ«è¡¨ç¤ºå±æ€§ä¸å¯å˜ï¼Œæ–¹æ³•ä¸å¯è¦†ç›–ï¼Œç±»ä¸å¯ç»§æ‰¿ã€‚\n2. finallyæ˜¯å¼‚å¸¸å¤„ç†è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼Œè¡¨ç¤ºæ€»æ˜¯æ‰§è¡Œã€‚\n3. finalizeæ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨åƒåœ¾æ”¶é›†å™¨æ‰§è¡Œçš„æ—¶å€™ä¼šè°ƒç”¨è¢«å›æ”¶å¯¹è±¡çš„æ­¤æ–¹æ³•ï¼Œå¯ä»¥è¦†ç›–æ­¤æ–¹æ³•æä¾›åƒåœ¾æ”¶é›†æ—¶çš„å…¶ä»–èµ„æºå›æ”¶ï¼Œä¾‹å¦‚å…³é—­æ–‡ä»¶ç­‰ã€‚\n\n### å…­åŸåˆ™ä¸€æ³•åˆ™\n\n1. å•ä¸€èŒè´£åŸåˆ™ï¼ˆé«˜å†…èšï¼Œä½è€¦åˆï¼‰\n   ä¸€ä¸ªç±»åªåšä»–è¯¥åšçš„äº‹æƒ…ï¼Œä¸æ¶‰åŠä¸å®ƒæ— å…³çš„é¢†åŸŸå°±æ˜¯å®è·µäº†é«˜å†…èšçš„åŸåˆ™ï¼Œè¿™ä¸ªç±»å°±åªæœ‰å•ä¸€èŒè´£ã€‚å¦ä¸€ä¸ªæ˜¯æ¨¡å—åŒ–ï¼Œä¸€ä¸ªå¥½çš„è½¯ä»¶ç³»ç»Ÿï¼Œä»–é‡Œé¢çš„æ¯ä¸ªåŠŸèƒ½æ¨¡å—ä¹Ÿåº”è¯¥æ˜¯å¯ä»¥è½»æ˜“çš„æ‹¿åˆ°å…¶ä»–ç³»ç»Ÿä¸­ä½¿ç”¨çš„ï¼Œè¿™æ ·æ‰èƒ½å®ç°è½¯ä»¶å¤ç”¨çš„ç›®æ ‡ã€‚\n2. å¼€é—­åŸåˆ™\n   è½¯ä»¶å®ä½“åº”å½“å¯¹å¤–æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼ˆåœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¸ºä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿå¢åŠ æ–°åŠŸèƒ½çš„æ—¶å€™ï¼Œåªéœ€è¦ä»åŸæ¥çš„ç³»ç»Ÿä¸­æ´¾ç”Ÿå‡ºä¸€äº›æ–°ç±»çš„å°±å¯ä»¥ï¼Œä¸éœ€è¦ä¿®æ”¹åŸæ¥çš„ä»»ä½•ä»£ç ï¼‰ã€‚è¦åšåˆ°å¼€é—­æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼š\n   1. æŠ½è±¡æ˜¯å…³é”®ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¦‚æœæ²¡æœ‰æŠ½è±¡ç±»æˆ–æ¥å£ç³»ç»Ÿå°±æ²¡æœ‰æ‰©å±•ç‚¹ã€‚\n   2. å°è£…å¯å˜æ€§ï¼Œå°†ç³»ç»Ÿä¸­å„ç§å¯å˜å› ç´ å°è£…åˆ°ä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ã€‚\n3. ä¾èµ–å€’ç½®åŸåˆ™\n   é¢å‘æ¥å£ç¼–ç¨‹ã€‚\n4. é‡Œæ°æ›¿æ¢åŸåˆ™\n   ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ç”¨å­ç±»æ›¿æ¢æ‰çˆ¶ç±»\n5. æ¥å£éš”ç¦»åŸåˆ™\n   æ¥å£ä¹Ÿåº”è¯¥æ˜¯é«˜å†…èšçš„\n6. åˆæˆèšåˆå¤ç”¨åŸåˆ™\n7. è¿ªç±³ç‰¹æ³•åˆ™\n   æœ€å°‘çŸ¥è¯†åŸåˆ™\n\n### ArrayListå’ŒLinkedListçš„åŒºåˆ«ï¼Œå¦‚æœä¸€ç›´åœ¨listçš„å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼Œç”¨å“ªä¸ªæ•ˆç‡é«˜\n\n1. `ArrayList`æ˜¯åŸºäºæ•°ç»„å®ç°çš„ï¼ŒæŸ¥æ‰¾æ•ˆç‡æ¯”`LinkedList`æ•ˆç‡é«˜ã€‚\n2. `LinkedList`é‡‡ç”¨åŒå‘é“¾è¡¨å®ç°çš„ï¼Œæ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡æ¯”`ArrayList`è¦é«˜ã€‚\n3. `LinkedList`æ¯”`ArrayList`å å†…å­˜ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæŒ‡å‘ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚\n\n### HashMapè§£æ\n[åŸºäºJDK8çš„HashMapæºç è§£æ](https://blog.csdn.net/zjxxyz123/article/details/81111627)\n\n### è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«\n1. è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼ˆèµ„æºè°ƒåº¦çš„æœ€å°å•ä½ï¼‰\n2. è¿›ç¨‹æœ‰è‡ªå·±çš„ç‹¬ç«‹åœ°å€ç©ºé—´ï¼Œæ¯å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œç³»ç»Ÿå°±ä¼šä¸ºå®ƒåˆ†é…åœ°å€ç©ºé—´ï¼Œå»ºç«‹æ•°æ®è¡¨æ¥ç»´æŠ¤ä»£ç æ®µã€å †æ ˆæ®µå’Œæ•°æ®æ®µï¼Œè¿™ç§æ“ä½œéå¸¸æ˜‚è´µã€‚è€Œçº¿ç¨‹æ˜¯å…±äº«è¿›ç¨‹ä¸­çš„æ•°æ®çš„ï¼Œä½¿ç”¨ç›¸åŒçš„åœ°å€ç©ºé—´ï¼Œå› æ­¤CPUåˆ‡æ¢ä¸€ä¸ªçº¿ç¨‹çš„èŠ±è´¹è¿œæ¯”è¿›ç¨‹è¦å°å¾ˆå¤šï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„å¼€é”€ä¹Ÿæ¯”è¿›ç¨‹è¦å°å¾ˆå¤šã€‚\n3. çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æ›´æ–¹ä¾¿ï¼ŒåŒä¸€è¿›ç¨‹ä¸‹çš„çº¿ç¨‹å…±äº«å…¨å±€å˜é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ï¼Œè€Œè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡éœ€è¦ä»¥é€šä¿¡çš„æ–¹å¼ï¼ˆIPC)è¿›è¡Œã€‚ä¸è¿‡å¦‚ä½•å¤„ç†å¥½åŒæ­¥ä¸äº’æ–¥æ˜¯ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºçš„éš¾ç‚¹ã€‚\n4. ä½†æ˜¯å¤šè¿›ç¨‹ç¨‹åºæ›´å¥å£®ï¼Œå¤šçº¿ç¨‹ç¨‹åºåªè¦æœ‰ä¸€ä¸ªçº¿ç¨‹æ­»æ‰ï¼Œæ•´ä¸ªè¿›ç¨‹ä¹Ÿæ­»æ‰äº†ï¼Œè€Œä¸€ä¸ªè¿›ç¨‹æ­»æ‰å¹¶ä¸ä¼šå¯¹å¦å¤–ä¸€ä¸ªè¿›ç¨‹é€ æˆå½±å“ï¼Œå› ä¸ºè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚\n\n### å¹¶å‘ä¸å¹¶è¡Œ\n1. å¹¶å‘ï¼šåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªå¤„äºæ‰§è¡ŒçŠ¶æ€ï¼Œä½†æ˜¯å®ƒä»¬äº¤æ¢ç€è¿›è¡Œï¼Œå› æ­¤åœ¨åŒä¸€æ®µæ—¶é—´å†…å¯çœ‹åšæ˜¯åŒæ—¶è¿›è¡Œçš„ã€‚(å…ˆåƒé¥­ï¼Œç”µè¯æ¥äº†æ¥ç”µè¯(ä¸ä¸€å®šåƒå®Œé¥­)ï¼Œç”µè¯ç»“æŸå†å»åƒé¥­ã€‚)\n2. å¹¶è¡Œï¼šåŒä¸€æ—¶åˆ»å¤šä¸ªåŒæ—¶è¿›è¡Œï¼Œå¤šè·¯çº¿è¿›è¡Œã€‚(ä¸€è¾¹åƒé¥­ï¼Œä¸€è¾¹æ‰“ç”µè¯ï¼›)\n\n### ç®—æ³•æ—¶é—´å¤æ‚åº¦\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/kvmetYXJzxo1Bu3IXJoYvnWq)\n\n### æ’å…¥æ’åºç¤ºä¾‹\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/zD5hi80SIR5pesrwtNfQIck4)\n\n### æ­»é”äº§ç”Ÿçš„åŸå› \n- ç³»ç»Ÿèµ„æºçš„ç«äº‰\n- è¿›ç¨‹è¿è¡Œæ¨è¿›é¡ºåºä¸åˆé€‚\n\n### æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶\n- äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹æ‰€ä½¿ç”¨ã€‚å³åœ¨ä¸€æ®µæ—¶é—´å†…æŸèµ„æºä»…ä¸ºä¸€ä¸ªè¿›ç¨‹æ‰€å ç”¨ã€‚æ­¤æ—¶è‹¥æœ‰å…¶ä»–è¿›ç¨‹è¯·æ±‚èµ„æºï¼Œåˆ™è¯·æ±‚è¿›ç¨‹åªèƒ½ç­‰å¾…ã€‚\n- è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šè¿›ç¨‹å·²ç»ä¿æŒäº†è‡³å°‘ä¸€ä¸ªèµ„æºï¼Œä½†åˆæå‡ºäº†æ–°çš„èµ„æºè¯·æ±‚ï¼Œè€Œè¯¥èµ„æºå·²è¢«å…¶ä»–è¿›ç¨‹æ‰€å ç”¨ï¼Œæ­¤æ—¶è¯·æ±‚è¿›ç¨‹è¢«é˜»å¡ï¼Œä½†å¯¹è‡ªå·±å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚\n- å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šè‹¥å¹²è¿›ç¨‹é—´å½¢æˆé¦–å°¾ç›¸æ¥å¾ªç¯ç­‰å¾…èµ„æºçš„å…³ç³»ã€‚\n- ä¸å¯å‰¥å¤ºæ¡ä»¶ï¼šè¿›ç¨‹æ‰€è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œæ¯•ä¹‹å‰ï¼Œä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹å¼ºè¡Œå¤ºèµ°ï¼Œå³åªèƒ½ç”±è·å¾—è¯¥èµ„æºçš„è¿›ç¨‹è‡ªå·±æ¥é‡Šæ”¾ã€‚\n\n### å¦‚ä½•åˆ¤æ–­çº¿ç¨‹å·²å®Œæˆå·¥ä½œ\n- ä½¿ç”¨çº¿ç¨‹æ± çš„åŸç”Ÿå‡½æ•°isTerminated()\n- ä½¿ç”¨CountDownLatch\n- ç»´æŒä¸€ä¸ªå…¬å…±è®¡æ•°ï¼ˆç±»ä¼¼CountDownLatchï¼‰\n- submitå‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼ŒFutureåˆ¤æ–­ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€\n\n### è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„åŒºåˆ«\n- Filteréœ€è¦åœ¨web.xmlä¸­é…ç½®ï¼Œä¾èµ–äºServletï¼›\n- Interceptoréœ€è¦åœ¨SpringMVCä¸­é…ç½®ï¼Œä¾èµ–äºæ¡†æ¶ï¼›\n- Filterçš„æ‰§è¡Œé¡ºåºåœ¨Interceptorä¹‹å‰ï¼Œå…·ä½“çš„æµç¨‹è§ä¸‹å›¾ï¼›\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/oR0b4abD0VA9q8FTyevwUjW1)\n\n[æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰å’Œè¿‡æ»¤å™¨ï¼ˆFilterï¼‰çš„æ‰§è¡Œé¡ºåºå’ŒåŒºåˆ«](https://blog.csdn.net/zxd1435513775/article/details/80556034)\n\n# Spring\n\n### ä»‹ç»ä¸€ä¸‹IOCï¼ŒAOP\nä¸€ã€\n1. ä¾èµ–æ³¨å…¥å­˜åœ¨ä¸‰ç§æ–¹å¼ï¼Œ\n	1. æ¥å£æ³¨å…¥ï¼šæ¥å£æ³¨å…¥æœ‰ç‚¹å¤æ‚ï¼Œè¢«æ³¨å…¥å¯¹è±¡å¦‚æœæƒ³è¦IOCå®¹å™¨ä¸ºå…¶æ³¨å…¥ä¾èµ–å¯¹è±¡ï¼Œå°±å¿…é¡»å®ç°æŸä¸ªæ¥å£ï¼Œè¿™ä¸ªæ¥å£æä¾›ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥ä¸ºè¢«æ³¨å…¥å¯¹è±¡æ³¨å…¥ä¾èµ–å¯¹è±¡ï¼ŒIOCå®¹å™¨é€šè¿‡æ¥å£æ–¹æ³•å°†ä¾èµ–å¯¹è±¡æ³¨å…¥åˆ°è¢«æ³¨å…¥å¯¹è±¡ä¸­å»ã€‚ç›¸å¯¹äºå‰ä¸¤ç§æ³¨å…¥æ–¹å¼ï¼Œæ¥å£æ³¨å…¥æ¯”ç¹çå’Œæ­»æ¿ï¼Œè¢«æ³¨å…¥å¯¹è±¡å°±å¿…é¡»ä¸“å£°æ˜å’Œå®ç°å¦å¤–çš„æ¥å£\n	```\n	@Autowired\n	private DependencyA dependencyA;\n	@Autowired\n	private DependencyB dependencyB;\n	@Autowired\n	private DependencyC dependencyC;\n	```\n\n	2. Constructæ³¨å…¥ï¼šå³è¢«æ³¨å…¥å¯¹è±¡å¯ä»¥é€šè¿‡åœ¨å…¶æ„é€ æ–¹æ³•ä¸­å£°æ˜ä¾èµ–å¯¹è±¡çš„å‚æ•°åˆ—è¡¨ï¼Œè®©å¤–éƒ¨(é€šå¸¸æ˜¯IOCå®¹å™¨)çŸ¥é“å®ƒéœ€è¦å“ªäº›ä¾èµ–å¯¹è±¡ï¼Œç„¶åIOCå®¹å™¨ä¼šæ£€æŸ¥è¢«æ³¨å…¥å¯¹è±¡çš„æ„é€ æ–¹æ³•\n	```\n	private DependencyA dependencyA;\n	private DependencyB dependencyB;\n	private DependencyC dependencyC;\n \n	@Autowired\n	public DI(DependencyA dependencyA, DependencyB dependencyB, DependencyC dependencyC) {\n    	this.dependencyA = dependencyA;\n    	this.dependencyB = dependencyB;\n    	this.dependencyC = dependencyC;\n	}\n	```\n	3. setteræ³¨å…¥ï¼šå³å½“å‰å¯¹è±¡åªéœ€è¦ä¸ºå…¶ä¾èµ–å¯¹è±¡æ‰€å¯¹åº”çš„å±æ€§æ·»åŠ setteræ–¹æ³•ï¼ŒIOCå®¹å™¨é€šè¿‡æ­¤setteræ–¹æ³•å°†ç›¸åº”çš„ä¾èµ–å¯¹è±¡è®¾ç½®åˆ°è¢«æ³¨å…¥å¯¹è±¡çš„æ–¹å¼å³setteræ–¹æ³•æ³¨å…¥\n	```\n	private DependencyA dependencyA;\n	private DependencyB dependencyB;\n	private DependencyC dependencyC;\n \n	@Autowired\n	public void setDependencyA(DependencyA dependencyA) {\n    	this.dependencyA = dependencyA;\n	}\n \n	@Autowired\n	public void setDependencyB(DependencyB dependencyB) {\n    	this.dependencyB = dependencyB;\n	}\n \n	@Autowired\n	public void setDependencyC(DependencyC dependencyC) {\n    	this.dependencyC = dependencyC;\n	}\n	```\n\n2. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨IOCï¼Ÿ\n	1. è„±å¼€ã€é™ä½ç±»ä¹‹é—´çš„è€¦åˆ\n	2. å€¡å¯¼é¢å‘æ¥å£ç¼–ç¨‹ã€å®æ–½ä¾èµ–å€’ç½®åŸåˆ™\n	3. æé«˜ç³»ç»Ÿå¯æ’å…¥ã€å¯æµ‹è¯•ã€å¯ä¿®æ”¹ç‰¹æ€§\n\n[ä»€ä¹ˆæ˜¯æ§åˆ¶åè½¬(IoC)ï¼Ÿä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼Ÿä»¥åŠå®ç°åŸç†](https://blog.csdn.net/weixin_40834464/article/details/82831157)\n\näºŒã€\n1. AOPæŒ‡é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥è¯´æ˜¯OOPï¼ˆObject Oriented Programmmingï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰çš„è¡¥å……å’Œå®Œå–„ã€‚\n\n\n### Spring beanç”Ÿå‘½å‘¨æœŸ\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/SRp1uJhNSno11FQYDcQpUFh5)\n1. å®ä¾‹åŒ–ä¸€ä¸ªBeanï¼ï¼ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„new\n2. æŒ‰ç…§Springä¸Šä¸‹æ–‡å¯¹å®ä¾‹åŒ–çš„Beanè¿›è¡Œé…ç½®ï¼ï¼ä¹Ÿå°±æ˜¯IOCæ³¨å…¥\n3. å¦‚æœè¿™ä¸ªBeanå·²ç»å®ç°äº†BeanNameAwareæ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„setBeanName(String)æ–¹æ³•ï¼Œæ­¤å¤„ä¼ é€’çš„å°±æ˜¯Springé…ç½®æ–‡ä»¶ä¸­Beançš„idå€¼\n4. å¦‚æœè¿™ä¸ªBeanå·²ç»å®ç°äº†BeanFactoryAwareæ¥å£ï¼Œä¼šè°ƒç”¨å®ƒå®ç°çš„setBeanFactory(setBeanFactory(BeanFactory)ä¼ é€’çš„æ˜¯Springå·¥å‚è‡ªèº«ï¼ˆå¯ä»¥ç”¨è¿™ä¸ªæ–¹å¼æ¥è·å–å…¶å®ƒBeanï¼Œåªéœ€åœ¨Springé…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸€ä¸ªæ™®é€šçš„Beanå°±å¯ä»¥ï¼‰\n5. å¦‚æœè¿™ä¸ªBeanå…³è”äº†BeanPostProcessoræ¥å£ï¼Œå°†ä¼šè°ƒç”¨postProcessBeforeInitialization(Object obj, String s)æ–¹æ³•ï¼ŒBeanPostProcessorç»å¸¸è¢«ç”¨ä½œæ˜¯Beanå†…å®¹çš„æ›´æ”¹ï¼Œå¹¶ä¸”ç”±äºè¿™ä¸ªæ˜¯åœ¨Beanåˆå§‹åŒ–ç»“æŸæ—¶è°ƒç”¨é‚£ä¸ªçš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è¢«åº”ç”¨äºå†…å­˜æˆ–ç¼“å­˜æŠ€æœ¯\n6. å¦‚æœBeanåœ¨Springé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†init-methodå±æ€§ä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„åˆå§‹åŒ–æ–¹æ³•\n7. å¦‚æœè¿™ä¸ªBeanå…³è”äº†BeanPostProcessoræ¥å£ï¼Œå°†ä¼šè°ƒç”¨postProcessAfterInitialization(Object obj, String s)æ–¹æ³•\n8. å½“Beanä¸å†éœ€è¦æ—¶ï¼Œä¼šç»è¿‡æ¸…ç†é˜¶æ®µï¼Œå¦‚æœBeanå®ç°äº†DisposableBeanè¿™ä¸ªæ¥å£ï¼Œä¼šè°ƒç”¨é‚£ä¸ªå…¶å®ç°çš„destroy()æ–¹æ³•\n9. æœ€åï¼Œå¦‚æœè¿™ä¸ªBeançš„Springé…ç½®ä¸­é…ç½®äº†destroy-methodå±æ€§ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å…¶é…ç½®çš„é”€æ¯æ–¹æ³•\n\n>æ‰§è¡Œé¡ºåºæµ‹è¯•ï¼ˆæ¥æºï¼š[Spring InitializingBean init-method @PostConstruct æ‰§è¡Œé¡ºåº](https://www.cnblogs.com/april-chen/p/8182631.html)ï¼‰\n```java\npackage com.example;\n/**\né€šè¿‡å®ç° InitializingBean/DisposableBean æ¥å£æ¥å®šåˆ¶åˆå§‹åŒ–ä¹‹å/é”€æ¯ä¹‹å‰çš„æ“ä½œæ–¹æ³•ï¼›\né€šè¿‡ å…ƒç´ çš„ init-method/destroy-methodå±æ€§æŒ‡å®šåˆå§‹åŒ–ä¹‹å /é”€æ¯ä¹‹å‰è°ƒç”¨çš„æ“ä½œæ–¹æ³•ï¼›\nåœ¨æŒ‡å®šæ–¹æ³•ä¸ŠåŠ ä¸Š@PostConstruct æˆ–@PreDestroyæ³¨è§£æ¥åˆ¶å®šè¯¥æ–¹æ³•æ˜¯åœ¨åˆå§‹åŒ–ä¹‹åè¿˜æ˜¯é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚ \n**/\npublic class InitSequenceBean implements InitializingBean {   \n    \n    public InitSequenceBean() {   \n       System.out.println(\"InitSequenceBean: constructor\");   \n    }   \n      \n    @PostConstruct  \n    public void postConstruct() {   \n       System.out.println(\"InitSequenceBean: postConstruct\");   \n    }   \n      \n    public void initMethod() {   \n       System.out.println(\"InitSequenceBean: init-method\");   \n    }   \n      \n    @Override  \n    public void afterPropertiesSet() throws Exception {   \n       System.out.println(\"InitSequenceBean: afterPropertiesSet\");   \n    }   \n}\n```\n\nxmlæ–‡ä»¶é…ç½®\n\n```java\n<bean id=\"initSequenceBean \" class=\"com.example.InitSequenceBean\" init-method=\"initMethod\"/>\n```\n\næ‰§è¡Œç»“æœ\n\n```java\nInitSequenceBean: constructor\n\nInitSequenceBean: postConstruct\n\nInitSequenceBean: afterPropertiesSet\n\nInitSequenceBean: init-method\n```\n\n### Autowiredå’ŒResourceçš„åŒºåˆ«\n1. å…±åŒç‚¹ï¼šä¸¤è€…éƒ½å¯ä»¥å†™åœ¨å­—æ®µå’Œsetteræ–¹æ³•ä¸Šã€‚ä¸¤è€…å¦‚æœéƒ½å†™åœ¨å­—æ®µä¸Šï¼Œé‚£ä¹ˆå°±ä¸ç”¨å†å†™setteræ–¹æ³•ã€‚\n2. ä¸åŒç‚¹ï¼š\n	1. @Autowiredä¸ºSpringæä¾›çš„æ³¨è§£ï¼ŒåªæŒ‰ç…§byTypeæ³¨å…¥ã€‚é»˜è®¤æƒ…å†µä¸‹å®ƒè¦æ±‚æ³¨å…¥çš„å¯¹è±¡ä¸€å®šè¦å­˜åœ¨ï¼Œå¦‚æœå…è®¸Nullï¼Œå¯ä»¥è®¾ç½®ä»–çš„requiredå±æ€§ä¸ºfalseã€‚å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨æŒ‰ç…§åç§°æ¥è£…é…ï¼Œå¯ä»¥ç»“åˆ@Qualifieræ³¨è§£ä¸€èµ·ä½¿ç”¨\n	2. @Resourceé»˜è®¤æŒ‰ç…§ByNameè‡ªåŠ¨æ³¨å…¥ï¼Œç”±J2EEæä¾›ï¼Œæœ‰ä¸¤ä¸ªé‡è¦å±æ€§ï¼Œnameå’Œtypeï¼Œè€ŒSpringå°†@Resourceæ³¨è§£çš„nameå±æ€§è§£æä¸ºbeançš„åç§°ï¼Œè€Œtypeå±æ€§åˆ™è§£æä¸ºbeançš„ç±»å‹ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½¿ç”¨nameå±æ€§ï¼Œåˆ™ä½¿ç”¨byNameçš„è‡ªåŠ¨æ³¨å…¥ç­–ç•¥ï¼Œè€Œä½¿ç”¨typeå±æ€§æ—¶åˆ™ä½¿ç”¨byTypeè‡ªåŠ¨æ³¨å…¥ç­–ç•¥ã€‚å¦‚æœæ—¢ä¸åˆ¶å®šnameä¹Ÿä¸åˆ¶å®štypeå±æ€§ï¼Œè¿™æ—¶å°†é€šè¿‡åå°„æœºåˆ¶ä½¿ç”¨byNameè‡ªåŠ¨æ³¨å…¥ç­–ç•¥ã€‚\n\n### Spring Bean ä½œç”¨åŸŸ\n- singleton\n- property\n- request\n- session\n- global-session\n\n\n# è®¡ç®—æœºç½‘ç»œ\n\n### è®¡ç®—æœºç½‘ç»œäº”å±‚åè®®ï¼ŒTCPåè®®åœ¨å“ªä¸€å±‚ï¼ŸIPåè®®åœ¨å“ªä¸€å±‚ï¼ŸHTTPåè®®åœ¨å“ªä¸€å±‚\n1. ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚\n	1. ç‰©ç†å±‚ï¼šä¸»è¦å®šä¹‰ç‰©ç†è®¾å¤‡æ ‡å‡†ï¼Œå¦‚ç½‘çº¿çš„æ¥å£ç±»å‹ã€å…‰çº¤çš„æ¥å£ç±»å‹ã€å„ç§ä¼ è¾“ä»‹è´¨çš„ä¼ è¾“é€Ÿç‡ç­‰ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¼ è¾“æ¯”ç‰¹æµï¼ˆå°±æ˜¯ç”±1ã€0è½¬åŒ–ä¸ºç”µæµå¼ºå¼±æ¥è¿›è¡Œä¼ è¾“,åˆ°è¾¾ç›®çš„åœ°ååœ¨è½¬åŒ–ä¸º1ã€0ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æ•°æ¨¡è½¬æ¢ä¸æ¨¡æ•°è½¬æ¢ï¼‰ã€‚è¿™ä¸€å±‚çš„æ•°æ®å«åšæ¯”ç‰¹ã€‚\n	2. æ•°æ®é“¾è·¯å±‚ï¼šå®šä¹‰äº†å¦‚ä½•è®©æ ¼å¼åŒ–æ•°æ®ä»¥è¿›è¡Œä¼ è¾“ï¼Œä»¥åŠå¦‚ä½•è®©æ§åˆ¶å¯¹ç‰©ç†ä»‹è´¨çš„è®¿é—®ã€‚è¿™ä¸€å±‚é€šå¸¸è¿˜æä¾›é”™è¯¯æ£€æµ‹å’Œçº æ­£ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å¯é ä¼ è¾“ã€‚ \n	3. ç½‘ç»œå±‚ï¼šåœ¨ä½äºä¸åŒåœ°ç†ä½ç½®çš„ç½‘ç»œä¸­çš„ä¸¤ä¸ªä¸»æœºç³»ç»Ÿä¹‹é—´æä¾›è¿æ¥å’Œè·¯å¾„é€‰æ‹©ã€‚Internetçš„å‘å±•ä½¿å¾—ä»ä¸–ç•Œå„ç«™ç‚¹è®¿é—®ä¿¡æ¯çš„ç”¨æˆ·æ•°å¤§å¤§å¢åŠ ï¼Œè€Œç½‘ç»œå±‚æ­£æ˜¯ç®¡ç†è¿™ç§è¿æ¥çš„å±‚ã€‚\n	4. ä¼ è¾“å±‚ï¼šå®šä¹‰äº†ä¸€äº›ä¼ è¾“æ•°æ®çš„åè®®å’Œç«¯å£å·ï¼ˆWWWç«¯å£80ç­‰ï¼‰ï¼Œå¦‚ï¼š\n		1. TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼Œä¼ è¾“æ•ˆç‡ä½ï¼Œå¯é æ€§å¼ºï¼Œç”¨äºä¼ è¾“å¯é æ€§è¦æ±‚é«˜ï¼Œæ•°æ®é‡å¤§çš„æ•°æ®ï¼‰ \n		2. UDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œä¸TCPç‰¹æ€§æ°æ°ç›¸åï¼Œç”¨äºä¼ è¾“å¯é æ€§è¦æ±‚ä¸é«˜ï¼Œæ•°æ®é‡å°çš„æ•°æ®ï¼Œå¦‚QQèŠå¤©æ•°æ®å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ä¼ è¾“çš„ï¼‰ã€‚ ä¸»è¦æ˜¯å°†ä»ä¸‹å±‚æ¥æ”¶çš„æ•°æ®è¿›è¡Œåˆ†æ®µå’Œä¼ è¾“ï¼Œåˆ°è¾¾ç›®çš„åœ°å€åå†è¿›è¡Œé‡ç»„ã€‚å¸¸å¸¸æŠŠè¿™ä¸€å±‚æ•°æ®å«åšæ®µã€‚\n	5. åº”ç”¨å±‚ï¼šæ˜¯ä½“ç³»ç»“æ„ä¸­çš„æœ€é«˜ã€‚ç›´æ¥ä¸ºç”¨æˆ·çš„åº”ç”¨è¿›ç¨‹ï¼ˆä¾‹å¦‚ç”µå­é‚®ä»¶ã€æ–‡ä»¶ä¼ è¾“å’Œç»ˆç«¯ä»¿çœŸï¼‰æä¾›æœåŠ¡ã€‚\n2. TCPåè®®å±äºè¿è¾“å±‚ï¼ŒIPåè®®å±äºç½‘ç»œå±‚ã€HTTPåè®®å±äºåº”ç”¨å±‚ï¼ˆå¼•å…¥ä¸€ä¸‹httpsï¼Œhttpså°±æ˜¯æ¯”httpå¤šäº†ä¸€å±‚TLS/SSLæ¥ä¿è¯æ•°æ®ä¼ è¾“å®‰å…¨ï¼ŒTLS/SSLä¹Ÿå±äºåè®®ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¿è¯æ•°æ®ä¼ è¾“å®‰å…¨ã€‚ï¼‰\n\n### TCPçš„è¿æ¥ä¸é‡Šæ”¾\n1. ä¸‰æ¬¡æ¡æ‰‹\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/s2BIi18pd1nUttDlRN1SgV4i)\n- ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šä¸»æœºAå‘é€ä½ç ä¸ºsynï¼1ï¼Œéšæœºäº§ç”Ÿseq number=xçš„æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯è¿›å…¥SYN_SENDçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ï¼›ä¸»æœºBç”±SYN=1çŸ¥é“Aè¦æ±‚å»ºç«‹è¿æ¥ã€‚\n\n- ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šä¸»æœºBæ”¶åˆ°è¯·æ±‚åè¦ç¡®è®¤è¿æ¥ä¿¡æ¯ï¼Œå‘Aå‘é€ack number(ä¸»æœºAçš„seq+1)ã€syn=1ã€ack=1ï¼Œéšæœºäº§ç”Ÿseq=yçš„åŒ…ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ã€‚\n\n- ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šä¸»æœºAæ”¶åˆ°åæ£€æŸ¥ack numberæ˜¯å¦æ­£ç¡®ï¼Œå³ç¬¬ä¸€æ¬¡å‘é€çš„seq number+1ï¼Œä»¥åŠä½ç ackæ˜¯å¦ä¸º1ï¼Œè‹¥æ­£ç¡®ï¼Œä¸»æœºAä¼šå†å‘é€ack number(ä¸»æœºBçš„seq+1)ã€ack=1ï¼Œä¸»æœºBæ”¶åˆ°åç¡®è®¤seqå€¼ä¸ack=1åˆ™è¿æ¥å»ºç«‹æˆåŠŸã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½è¿›å…¥ESTABLISHEDçŠ¶æ€ã€‚\n\n> ä¸‰æ¬¡æ¡æ‰‹çš„å¿…è¦æ€§\n- ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ç½‘ç»œåŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„å‘é€èƒ½åŠ›ã€æœåŠ¡ç«¯çš„æ¥æ”¶èƒ½åŠ›æ˜¯æ­£å¸¸çš„ã€‚\n- ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯å‘åŒ…ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·å®¢æˆ·ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šæœåŠ¡ç«¯çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›ï¼Œå®¢æˆ·ç«¯çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›æ˜¯æ­£å¸¸çš„ã€‚ä¸è¿‡æ­¤æ—¶æœåŠ¡å™¨å¹¶ä¸èƒ½ç¡®è®¤å®¢æˆ·ç«¯çš„æ¥æ”¶èƒ½åŠ›æ˜¯å¦æ­£å¸¸ã€‚\n- ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘åŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„æ¥æ”¶èƒ½åŠ›ï¼ŒæœåŠ¡å™¨è‡ªå·±çš„å‘é€èƒ½åŠ›ä¹Ÿæ­£å¸¸ã€‚\n\n\n2. å››æ¬¡æŒ¥æ‰‹\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/WSvm0itUhGUjZ7GtQY8EuMCE)\n\n# æ•°æ®åº“\n\n### ç´¢å¼•ç±»å‹\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/P7ITzfAryvUuSjghM4RtFxrS)\n\n### å”¯ä¸€ç´¢å¼•ä¸ä¸»é”®ç´¢å¼•çš„æ¯”è¾ƒ\n1. å”¯ä¸€ç´¢å¼•ä¸å…è®¸ä¸¤è¡Œå…·æœ‰ç›¸åŒçš„ç´¢å¼•å€¼ã€‚å¦‚æœç°æœ‰æ•°æ®ä¸­å­˜åœ¨é‡å¤çš„é”®å€¼ï¼Œåˆ™å¤§å¤šæ•°æ•°æ®åº“éƒ½ä¸å…è®¸å°†æ–°åˆ›å»ºçš„å”¯ä¸€ç´¢å¼•ä¸è¡¨ä¸€èµ·ä¿å­˜ã€‚å½“æ–°æ•°æ®å°†ä½¿è¡¨ä¸­çš„é”®å€¼é‡å¤æ—¶ï¼Œæ•°æ®åº“ä¹Ÿæ‹’ç»æ¥å—æ­¤æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ employee è¡¨ä¸­çš„èŒå‘˜å§“æ°(lname) åˆ—ä¸Šåˆ›å»ºäº†å”¯ä¸€ç´¢å¼•ï¼Œåˆ™æ‰€æœ‰èŒå‘˜ä¸èƒ½åŒå§“ã€‚\n2. ä¸»é”®ç´¢å¼•æ˜¯å”¯ä¸€ç´¢å¼•çš„ç‰¹æ®Šç±»å‹ã€‚æ•°æ®åº“è¡¨é€šå¸¸æœ‰ä¸€åˆ—æˆ–åˆ—ç»„åˆï¼Œå…¶å€¼ç”¨æ¥å”¯ä¸€æ ‡è¯†è¡¨ä¸­çš„æ¯ä¸€è¡Œã€‚è¯¥åˆ—ç§°ä¸ºè¡¨çš„ä¸»é”®ã€‚\n	1. å¯¹äºä¸»å¥/unique constraint ï¼Œ oracle/sql server/mysqlç­‰éƒ½ä¼šè‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼•ï¼›\n	2. ä¸»é”®ä¸ä¸€å®šåªåŒ…å«ä¸€ä¸ªå­—æ®µï¼Œæ‰€ä»¥å¦‚æœä½ åœ¨ä¸»é”®çš„å…¶ä¸­ä¸€ä¸ªå­—æ®µå»ºå”¯ä¸€ç´¢å¼•è¿˜æ˜¯å¿…è¦çš„ï¼›\n	3. ä¸»å¥å¯ä½œå¤–å¥ï¼Œå”¯ä¸€ç´¢å¼•ä¸å¯ï¼›\n	4. ä¸»å¥ä¸å¯ä¸ºç©ºï¼Œå”¯ä¸€ç´¢å¼•å¯ï¼›\n	5. ä¸»å¥ä¹Ÿå¯æ˜¯å¤šä¸ªå­—æ®µçš„ç»„åˆï¼›\n	6. ä¸»é”®ä¸å”¯ä¸€ç´¢å¼•ä¸åŒçš„æ˜¯ï¼š\n		1. æœ‰not nullå±æ€§ï¼›\n		2. æ¯ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªã€‚\n\n### ä»€ä¹ˆæ˜¯äº‹åŠ¡\näº‹åŠ¡æ˜¯é€»è¾‘ä¸Šçš„ä¸€ç»„æ“ä½œï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚\näº‹åŠ¡æœ€ç»å…¸ä¹Ÿç»å¸¸è¢«æ‹¿å‡ºæ¥è¯´ä¾‹å­å°±æ˜¯è½¬è´¦äº†ã€‚å‡å¦‚å°æ˜è¦ç»™å°çº¢è½¬è´¦1000å…ƒï¼Œè¿™ä¸ªè½¬è´¦ä¼šæ¶‰åŠåˆ°ä¸¤ä¸ªå…³é”®æ“ä½œå°±æ˜¯ï¼šå°†å°æ˜çš„ä½™é¢å‡å°‘1000å…ƒï¼Œå°†å°çº¢çš„ä½™é¢å¢åŠ 1000å…ƒã€‚ä¸‡ä¸€åœ¨è¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´çªç„¶å‡ºç°é”™è¯¯æ¯”å¦‚é“¶è¡Œç³»ç»Ÿå´©æºƒï¼Œå¯¼è‡´å°æ˜ä½™é¢å‡å°‘è€Œå°çº¢çš„ä½™é¢æ²¡æœ‰å¢åŠ ï¼Œè¿™æ ·å°±ä¸å¯¹äº†ã€‚äº‹åŠ¡å°±æ˜¯ä¿è¯è¿™ä¸¤ä¸ªå…³é”®æ“ä½œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½è¦å¤±è´¥ã€‚\n\n### äº‹åŠ¡çš„å››å¤§ç‰¹æ€§ï¼ˆACIDï¼‰\n1. åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼š äº‹åŠ¡æ˜¯æœ€å°çš„æ‰§è¡Œå•ä½ï¼Œä¸å…è®¸åˆ†å‰²ã€‚äº‹åŠ¡çš„åŸå­æ€§ç¡®ä¿åŠ¨ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå®Œå…¨ä¸èµ·ä½œç”¨ï¼›\n2. ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼š æ‰§è¡Œäº‹åŠ¡å‰åï¼Œæ•°æ®ä¿æŒä¸€è‡´ï¼Œå¤šä¸ªäº‹åŠ¡å¯¹åŒä¸€ä¸ªæ•°æ®è¯»å–çš„ç»“æœæ˜¯ç›¸åŒçš„ï¼›\n3. éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼š å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªç”¨æˆ·çš„äº‹åŠ¡ä¸è¢«å…¶ä»–äº‹åŠ¡æ‰€å¹²æ‰°ï¼Œå„å¹¶å‘äº‹åŠ¡ä¹‹é—´æ•°æ®åº“æ˜¯ç‹¬ç«‹çš„ï¼›\n4. æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼š ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ä¹‹åã€‚å®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜æ˜¯æŒä¹…çš„ï¼Œå³ä½¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚\n\n\n### è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/k5sZEWPTZhrGXT3OefvUrHLt)\n[å¿«é€Ÿç†è§£è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»](https://blog.csdn.net/Vincent2014Linux/article/details/89669762)\nè„è¯»ï¼ˆéš”ç¦»çº§åˆ«ä¸ºæœªæäº¤è¯»æ—¶ï¼‰ï¼šäº‹åŠ¡Aè¯»å–äº†äº‹åŠ¡Bä¸­å°šæœªæäº¤çš„æ•°æ®ã€‚å¦‚æœäº‹åŠ¡Bå›æ»šï¼Œåˆ™Aè¯»å–äº†é”™è¯¯çš„æ•°æ®ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/b3dDjTCOWfaItcabwV0P9zSp)\n\n> æ¯”å¦‚æˆ‘ç»™ä½ è½¬äº†100ä¸‡ï¼Œä½†æ˜¯æˆ‘è¿˜æ²¡æœ‰æäº¤ï¼Œæ­¤æ—¶ä½ æŸ¥è¯¢è‡ªå·±è´¦æˆ·ï¼Œå¤šäº†100ä¸‡ï¼Œå¾ˆå¼€å¿ƒã€‚ç„¶åæˆ‘å‘ç°è½¬é”™äººäº†ï¼Œå›æ»šäº†äº‹ç‰©ã€‚ç„¶åä½ 100ä¸‡å°±æ²¡äº†ã€‚  åœ¨è¿‡ç¨‹ä¸­ä½ æŸ¥åˆ°äº†æ²¡æœ‰æäº¤äº‹ç‰©çš„æ•°æ®ï¼ˆå¤šå‡ºçš„100ä¸‡ï¼‰ï¼Œè¿™å°±æ˜¯è„è¯»ã€‚\n\nä¸å¯é‡å¤åº¦ï¼ˆéš”ç¦»çº§åˆ«ä¸ºæäº¤è¯»ï¼‰ï¼šä¸å¯é‡å¤è¯»æ˜¯æŒ‡åœ¨äº‹åŠ¡1å†…ï¼Œè¯»å–äº†ä¸€ä¸ªæ•°æ®ï¼Œäº‹åŠ¡1è¿˜æ²¡æœ‰ç»“æŸæ—¶ï¼Œäº‹åŠ¡2ä¹Ÿè®¿é—®äº†è¿™ä¸ªæ•°æ®ï¼Œä¿®æ”¹äº†è¿™ä¸ªæ•°æ®ï¼Œå¹¶æäº¤ã€‚ç´§æ¥ç€ï¼Œäº‹åŠ¡1åˆè¯»è¿™ä¸ªæ•°æ®ã€‚ç”±äºäº‹åŠ¡2çš„ä¿®æ”¹ï¼Œé‚£ä¹ˆäº‹åŠ¡1ä¸¤æ¬¡è¯»åˆ°çš„çš„æ•°æ®å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤ç§°ä¸ºæ˜¯ä¸å¯é‡å¤è¯»ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/HUgNKAM5MQAxBwwYK3FdINds)\n\nå¹»è¯»ï¼ˆéš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤åº¦ï¼‰ï¼šæ‰€è°“å¹»è¯»ï¼ŒæŒ‡çš„æ˜¯å½“æŸä¸ªäº‹åŠ¡åœ¨è¯»å–æŸä¸ªèŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡å†æ¬¡è¯»å–è¯¥èŒƒå›´çš„è®°å½•æ—¶ï¼Œä¼šäº§ç”Ÿå¹»è¡Œã€‚InnoDBå­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰è§£å†³äº†å¹»è¯»çš„é—®é¢˜ã€‚\n\n> å½“éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºå¯ä¸²è¡ŒåŒ–ï¼Œå¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œé¿å…äº†å‰é¢è¯´çš„å¹»è¯»çš„é—®é¢˜ã€‚\n\næ³¨æ„ï¼šä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„åŒºåˆ«æ˜¯ï¼šå‰è€…æ˜¯æŒ‡è¯»åˆ°äº†å·²ç»æäº¤çš„äº‹åŠ¡çš„æ›´æ”¹æ•°æ®ï¼ˆä¿®æ”¹æˆ–åˆ é™¤ï¼‰ï¼Œåè€…æ˜¯æŒ‡è¯»åˆ°äº†å…¶ä»–å·²ç»æäº¤äº‹åŠ¡çš„æ–°å¢æ•°æ®ã€‚\nå¯¹äºè¿™ä¸¤ç§é—®é¢˜è§£å†³é‡‡ç”¨ä¸åŒçš„åŠæ³•ï¼Œé˜²æ­¢è¯»åˆ°æ›´æ”¹æ•°æ®ï¼Œåªéœ€å¯¹æ“ä½œçš„æ•°æ®æ·»åŠ è¡Œçº§é”ï¼Œé˜²æ­¢æ“ä½œä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼›è€Œé˜²æ­¢è¯»åˆ°æ–°å¢æ•°æ®ï¼Œå¾€å¾€éœ€è¦æ·»åŠ è¡¨çº§é”ï¼Œå°†æ•´å¼ è¡¨é”å®šï¼Œé˜²æ­¢æ–°å¢æ•°æ®ï¼ˆoracleé‡‡ç”¨å¤šç‰ˆæœ¬æ•°æ®çš„æ–¹å¼å®ç°ï¼‰ã€‚\n\n### MySQLç´¢å¼•å¼•æ“\n[MySQLå­˜å‚¨å¼•æ“ï¼ï¼MyISAMä¸InnoDBåŒºåˆ«](https://www.cnblogs.com/peijz/p/12355772.html)\n\n### ç´¢å¼•å»ºç«‹è¶Šå¤šè¶Šå¥½å—\n- æ•°æ®é‡å°çš„è¡¨ä¸éœ€è¦å»ºç«‹ç´¢å¼•ï¼Œå› ä¸ºå»ºç«‹ç´¢å¼•ä¼šå¢åŠ é¢å¤–çš„å¼€é”€ã€‚\n- æ•°æ®å˜æ›´éœ€è¦ç»´æŠ¤ç´¢å¼•ï¼Œå› æ­¤æ›´å¤šçš„ç´¢å¼•æ„å‘³ç€æ›´å¤šçš„ç»´æŠ¤æˆæœ¬ã€‚\n- æ›´å¤šçš„ç´¢å¼•æ„å‘³ç€æ›´å¤šçš„å­˜å‚¨ç©ºé—´ã€‚\n\n### è§†å›¾ä¸è¡¨çš„åŒºåˆ«\n- è§†å›¾æ˜¯ä¸€ä¸ªé€»è¾‘æ¦‚å¿µçš„å­˜åœ¨ï¼Œæ²¡æœ‰ç‰©ç†è®°å½•ï¼Œè¡¨æ˜¯å æœ‰ç‰©ç†ç©ºé—´çš„æ•°æ®\n- è§†å›¾æ˜¯ä¸€ä¸ªé¢„ç¼–è¯‘å¥½çš„sqlï¼Œè€Œè¡¨ä¸æ˜¯\n- è§†å›¾çš„å¢åŠ å’Œåˆ é™¤åªå½±å“è§†å›¾æœ¬èº«ï¼Œä¸å½±å“åŸºæœ¬è¡¨\n- è§†å›¾æ˜¯æŸ¥çœ‹æ•°æ®è¡¨çš„ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥æŸ¥è¯¢æ•°æ®è¡¨ä¸­æŸäº›å­—æ®µæ„æˆçš„æ•°æ®ï¼Œåªæ˜¯ä¸€äº›SQLè¯­å¥çš„é›†åˆã€‚ä»å®‰å…¨çš„è§’åº¦è¯´ï¼Œè§†å›¾å¯ä»¥ä¸ç»™ç”¨æˆ·æ¥è§¦æ•°æ®è¡¨ï¼Œä»è€Œä¸çŸ¥é“è¡¨ç»“æ„\n');
INSERT INTO `blog_content` VALUES (47, '## 2019/5/8\n#### ä¸‹åˆ—å…³äºSpringç‰¹æ€§ä¸­IOCæè¿°é”™è¯¯çš„æ˜¯ï¼š\n\n```\nA.IoCå°±æ˜¯æŒ‡ç¨‹åºä¹‹é—´çš„å…³ç³»ç”±ç¨‹åºä»£ç ç›´æ¥æ“æ§\nB.æ‰€è°“â€œæ§åˆ¶åè½¬â€æ˜¯æŒ‡æ§åˆ¶æƒç”±åº”ç”¨ä»£ç è½¬åˆ°å¤–éƒ¨å®¹å™¨ï¼Œå³æ§åˆ¶æƒçš„è½¬ç§»\nC.IoCå°†æ§åˆ¶åˆ›å»ºçš„èŒè´£æ¬è¿›äº†æ¡†æ¶ä¸­ï¼Œä»åº”ç”¨ä»£ç è„±ç¦»å¼€æ¥\nD.ä½¿ç”¨Springçš„IoCå®¹å™¨æ—¶åªéœ€æŒ‡å‡ºç»„ä»¶éœ€è¦çš„å¯¹è±¡ï¼Œåœ¨è¿è¡Œæ—¶Springçš„IoCå®¹å™¨ä¼šæ ¹æ®XMLé…ç½®æ•°æ®æä¾›ç»™å®ƒ\n```\n> è§£æ\n\n```\nA\næ§åˆ¶åè½¬å³IoC (Inversion of Control)ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ä¸€ç§è®¾è®¡åŸåˆ™ï¼Œå¯ä»¥ç”¨æ¥å‡ä½è®¡ç®—æœºä»£ç ä¹‹é—´çš„è€¦åˆåº¦ã€‚\nå®ƒæŠŠä¼ ç»Ÿä¸Šç”±ç¨‹åºä»£ç ç›´æ¥æ“æ§çš„å¯¹è±¡çš„è°ƒç”¨æƒäº¤ç»™å®¹å™¨ï¼Œé€šè¿‡å®¹å™¨æ¥å®ç°å¯¹è±¡ç»„ä»¶çš„è£…é…å’Œç®¡ç†ã€‚\næ‰€è°“çš„â€œæ§åˆ¶åè½¬â€æ¦‚å¿µå°±æ˜¯å¯¹ç»„ä»¶å¯¹è±¡æ§åˆ¶æƒçš„è½¬ç§»ï¼Œä»ç¨‹åºä»£ç æœ¬èº«è½¬ç§»åˆ°äº†å¤–éƒ¨å®¹å™¨ã€‚\n```\n\n---\n#### è½¬å‘å’Œé‡å®šå‘çš„åŒºåˆ«\n\n```\n String username=request.getParameter(\"username\");\n //è½¬å‘ä¸é‡å®šå‘\n if(username.equals(\"admin\")){\n  //æç¤ºç”¨æˆ·å·²å­˜åœ¨ï¼Œä¸èƒ½æ³¨å†Œ\n  request.setAttribute(\"message\",\"è¯¥ç”¨æˆ·å·²å­˜åœ¨ï¼Œä¸èƒ½æ³¨å†Œ\");//æ·»åŠ æç¤ºä¿¡æ¯ï¼Œéœ€è¦åœ¨userCreate.jspé¡µé¢ä¸­è¿›è¡Œæç¤ºä¿¡æ¯å±•ç¤º\n  request.getRequestDispatcher(\"userCreate.jsp\").forward(request, response);//è½¬å‘\n }else{\n  //æç¤ºæ³¨å†ŒæˆåŠŸ\n  request.setAttribute(\"message\",\"æ³¨å†ŒæˆåŠŸ\");\n  response.sendRedirect(\"indext.jsp\");//é‡å®šå‘\n }\n```\n> åŒºåˆ«\n\n\n1. é‡å®šå‘çš„æ‰§è¡Œè¿‡ç¨‹ï¼šWebæœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€ä¸€ä¸ªhttpå“åº”--ã€‹æµè§ˆå™¨æ¥å—æ­¤å“åº”åå†å‘é€ä¸€ä¸ªæ–°çš„httpè¯·æ±‚åˆ°æœåŠ¡å™¨--ã€‹æœåŠ¡å™¨æ ¹æ®æ­¤è¯·æ±‚å¯»æ‰¾èµ„æºå¹¶å‘é€ç»™æµè§ˆå™¨ã€‚å®ƒå¯ä»¥é‡å®šå‘åˆ°ä»»æ„URLï¼Œä¸èƒ½å…±äº«requestèŒƒå›´å†…çš„æ•°æ®ã€‚\n\n2. é‡å®šå‘æ˜¯åœ¨å®¢æˆ·ç«¯å‘æŒ¥ä½œç”¨ï¼Œé€šè¿‡æ–°çš„åœ°å€å®ç°é¡µé¢è½¬å‘ã€‚\n\n3. é‡å®šå‘æ˜¯é€šè¿‡æµè§ˆå™¨é‡æ–°è¯·æ±‚åœ°å€ï¼Œåœ¨åœ°å€æ ä¸­å¯ä»¥æ˜¾ç¤ºè½¬å‘åçš„åœ°å€ã€‚\n\n4. è½¬å‘è¿‡ç¨‹ï¼šWebæœåŠ¡å™¨è°ƒç”¨å†…éƒ¨æ–¹æ³•åœ¨å®¹å™¨å†…éƒ¨å®Œæˆè¯·æ±‚å’Œè½¬å‘åŠ¨ä½œ--ã€‹å°†ç›®æ ‡èµ„æºå‘é€ç»™æµè§ˆå™¨ï¼Œå®ƒåªèƒ½åœ¨åŒä¸€ä¸ªWebåº”ç”¨ä¸­ä½¿ç”¨ï¼Œå¯ä»¥å…±äº«requestèŒƒå›´å†…çš„æ•°æ®ã€‚\n\n5. è½¬å‘æ˜¯åœ¨æœåŠ¡å™¨ç«¯å‘æŒ¥ä½œç”¨ï¼Œé€šè¿‡forward()æ–¹æ³•å°†æäº¤ä¿¡æ¯åœ¨å¤šä¸ªé¡µé¢é—´è¿›è¡Œä¼ é€’ã€‚\n\n6. è½¬å‘æ˜¯åœ¨æœåŠ¡å™¨å†…éƒ¨æ§åˆ¶æƒçš„è½¬ç§»ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨çš„åœ°å€æ ä¸ä¼šæ˜¾ç¤ºå‡ºè½¬å‘åçš„åœ°å€ã€‚\n\n\n---\n#### ä¸‹é¢å“ªä¸€é¡¹å¯¹Servletæè¿°é”™è¯¯ï¼Ÿ\n\n```\nServletæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„Java ç±» ï¼Œå®ƒå¿…é¡»ç›´æ¥æˆ–é—´æ¥å®ç°Servletæ¥å£\nServletæ¥å£å®šä¹‰äº†Serveltçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•\nå½“å¤šä¸ªå®¢æˆ·è¯·æ±‚ä¸€ä¸ªServletæ—¶ï¼ŒæœåŠ¡å™¨ä¸ºæ¯ä¸€ä¸ªå®¢æˆ·å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹\nServletå®¢æˆ·çº¿ç¨‹è°ƒç”¨serviceæ–¹æ³•å“åº”å®¢æˆ·çš„è¯·æ±‚\n```\n> è§£æ\n\n```\n1.import javax.servlet.http.httpservletrequestï¼Œä½ çœ‹è¿™ä¸ªåŒ…è¯´æ˜servletæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„Javaç±»ï¼Œ javaå’Œjavaxéƒ½æ˜¯Javaçš„APIåŒ…ï¼Œjavaæ˜¯æ ¸å¿ƒåŒ…ï¼Œjavaxçš„xæ˜¯extensionçš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯æ‰©å±•åŒ…ã€‚\n2.servletæ¥å£å®šä¹‰äº†servletçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šinitï¼ˆï¼‰ã€serviceï¼ˆï¼‰ã€destoryï¼ˆï¼‰ä¸‰ä¸ªæ–¹æ³•\n3.å½“å¤šä¸ªæµè§ˆå™¨ç»ˆç«¯è¯·æ±‚webæœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¸ºæ¯ä¸ªå®¢æˆ·å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸æ˜¯è¿›ç¨‹ã€‚(é€‰æ‹©ä¸­å–œæ¬¢å·æ¢æ¦‚å¿µï¼Œåœ¨è¿™ä¸ªä¸Šé¢åšæ–‡ç« ã€‚)\n4.serviceï¼ˆï¼‰ä¸­çš„æ–¹æ³•å°±æ˜¯ç”¨æ¥å†™ç›¸åº”å®¢æˆ·è¯·æ±‚çš„æ–¹æ³•çš„ã€‚å‰åä¸¤ä¸ªæ˜¯ç”³è¯·èµ„æºåˆå§‹åŒ–ï¼Œå’Œé‡Šæ”¾èµ„æºå…³é—­ã€‚\n```\n#### ä¸‹é¢æœ‰å…³SPRINGçš„äº‹åŠ¡ä¼ æ’­ç‰¹æ€§ï¼Œè¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ\n\n```\nPROPAGATION_SUPPORTSï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œ\nPROPAGATION_REQUIREDï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸\nPROPAGATION_REQUIRES_NEWï¼šæ–°å»ºäº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼ŒæŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·\nPROPAGATION_NESTEDï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œæ–°å¢Savepointç‚¹ï¼Œä¸å½“å‰äº‹åŠ¡åŒæ­¥æäº¤æˆ–å›æ»š\n```\n> è§£æ\n\nSpring æ”¯æŒ 7 ç§äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼š\n1. PROPAGATION_REQUIRED å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœå·²ç»å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼ŒåŠ å…¥åˆ°è¿™ä¸ªäº‹åŠ¡ä¸­ã€‚è¿™æ˜¯æœ€å¸¸è§çš„é€‰æ‹©ã€‚\n2. PROPAGATION_SUPPORTS æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚\n3. PROPAGATION_MANDATORY ä½¿ç”¨å½“å‰çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚\n4. PROPAGATION_REQUIRES_NEW æ–°å»ºäº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼ŒæŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚\n5. PROPAGATION_NOT_SUPPORTED ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚\n6. PROPAGATION_NEVER ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚\n7. PROPAGATION_NESTED å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æ‰§è¡Œä¸PROPAGATION_REQUIRED ç±»ä¼¼çš„æ“ä½œã€‚\n\n---\n#### SpringMVCçš„åŸç†\n![image](https://uploadfiles.nowcoder.com/images/20171010/163192_1507646670364_7216367DD4FDC0CC274F999B0D00CFE5)\n\n## 2019/5/16\n#### HashMapå’ŒHashSetçš„åŒºåˆ«\nHashMapæ˜¯å®ç°Map<K,V>æ¥å£çš„ä¸€ä¸ªå®ä½“ç±»ï¼Œå®ƒå¯¹é”®å€¼åšäº†ä¸€å¯¹ä¸€çš„æ˜ å°„å…³ç³»ï¼Œå½“ç„¶é‡Œé¢é”®å€¼ä¸èƒ½é‡å¤ã€‚Map æ¥å£æä¾›ä¸‰ç§collection è§†å›¾ï¼Œå…è®¸ä»¥é”®é›†ã€å€¼é›†æˆ–é”®-å€¼æ˜ å°„å…³ç³»é›†çš„å½¢å¼æŸ¥çœ‹æŸä¸ªæ˜ å°„çš„å†…å®¹ã€‚æ˜ å°„é¡ºåº å®šä¹‰ä¸ºè¿­ä»£å™¨åœ¨æ˜ å°„çš„ collection è§†å›¾ä¸Šè¿”å›å…¶å…ƒç´ çš„é¡ºåºã€‚æŸäº›æ˜ å°„å®ç°å¯æ˜ç¡®ä¿è¯å…¶é¡ºåºï¼Œå¦‚ TreeMap ç±»ï¼›å¦ä¸€äº›æ˜ å°„å®ç°åˆ™ä¸ä¿è¯é¡ºåºï¼Œå¦‚ HashMap ç±»ã€‚\n![image](https://s2.ax1x.com/2019/05/18/EOFLb8.md.png)\n\nHashSetæ˜¯å®ç°Set<E>æ¥å£çš„ä¸€ä¸ªå®ä½“ç±»ï¼Œæ•°æ®æ˜¯ä»¥å“ˆå¸Œè¡¨çš„å½¢å¼å­˜æ”¾çš„ï¼Œé‡Œé¢çš„ä¸èƒ½åŒ…å«é‡å¤æ•°æ®ã€‚Setæ¥å£æ˜¯ä¸€ç§ä¸€ä¸ªä¸åŒ…å«é‡å¤å…ƒç´ çš„ collectionã€‚\n\n![image](https://s2.ax1x.com/2019/05/18/EOFXVS.md.png)\n\n#### æ±‡æ€»ï¼š\n\n![image](https://s2.ax1x.com/2019/05/18/EOFjUg.png)\n\n## 2019/5/18\n#### æœ‰ä»¥ä¸‹ä»£ç :\n\n```\nclass A{\n    public A(String str){\n         \n    }\n}\npublic class Test{\n    public static void main(String[] args) {\n        A classa=new A(\"he\");\n        A classb=new A(\"he\");\n        System.out.println(classa==classb);\n    }\n}\n```\n\n#### è¯·é—®è¾“å‡ºçš„ç»“æœæ˜¯: false\n\nå› ä¸º== è¡¨ç¤ºçš„æ˜¯å¦æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå†…å­˜ã€‚\nSystem.out.println(classa.equals(classb));   å¦‚æœè¿™è¿™æ ·è¾“å‡ºç­”æ¡ˆä¹Ÿæ˜¯é”™è¯¯çš„,å› ä¸ºå­ç±»æ²¡æœ‰è¦†ç›–Object\nçš„equals()æ–¹æ³•,è€Œé»˜è®¤è°ƒç”¨==çš„è¿™ä¸ªæ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰éœ€è¦è¦†ç›–equals()æ–¹æ³•å’Œhashcaode()æ–¹æ³•\n\n---\n\n## 2019/5/20\n#### åŸºæœ¬æ•°æ®ç±»å‹å‡å¯ä»»æ„äº’ç›¸è½¬æ¢ã€‚\n#### é”™\nåŸç”Ÿç±»æ˜¯æŒ‡Javaä¸­ï¼Œæ•°æ®ç±»å‹åˆ†ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆæˆ–å«åšåŸç”Ÿç±»ã€å†…ç½®ç±»å‹ï¼‰å’Œå¼•ç”¨æ•°æ®ç±»å‹ã€‚\né‚£ä¹ˆåŸç”Ÿç±»ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œæœ‰å…«ç§ï¼Œè¿™æ ·è½¬æ¢çš„æ—¶å€™å°±æœ‰è¡¨è¾¾èŒƒå›´é—®é¢˜ã€‚\n1ã€æ‰€å ä½æ•°å°‘çš„å¯ä»¥è½¬æ¢ä¸ºæ‰€å ä½æ•°å¤šçš„ç±»å‹ï¼Œæ¯”å¦‚byteè½¬char,charè½¬intç­‰ï¼›\n2ã€è€Œæ‰€å ä½æ•°å¤šçš„è½¬ä¸ºæ‰€å ä½æ•°å°‘çš„é»˜è®¤æƒ…å†µä¸‹ä¸èƒ½å®ç°è½¬æ¢ï¼Œéœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿™æ ·å¯èƒ½ä¼šä¸¢å¤±ä¸€éƒ¨åˆ†åŸå§‹æ•°æ®ï¼›\n3ã€æ­¤å¤–ï¼Œbooleanç±»å‹æ•°æ®å’Œå…¶ä»–ä¸ƒç§ä¸èƒ½äº’ç›¸è½¬æ¢ã€‚\n\n#### å…«ç§æ•°æ®ç±»å‹\n\n![image](https://s2.ax1x.com/2019/05/20/EvGAqf.md.png)\n\n#### å…³äºjavaçº¿ç¨‹\nåˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•æœ‰ä¸‰ç§ï¼š\nï¼ˆ1ï¼‰ç»§æ‰¿Threadç±»,é‡å†™runæ–¹æ³•ï¼›\nï¼ˆ2ï¼‰å®ç°Runnableæ¥å£ï¼Œå¹¶å°†å¯¹è±¡å®ä¾‹ä½œä¸ºå‚æ•°ä¼ é€’ç»™Threadç±»çš„æ„é€ æ–¹æ³•ï¼›\nï¼ˆ3ï¼‰å®ç°callableæ¥å£ï¼Œå¹¶å®ç°callæ–¹æ³•ï¼Œå¹¶ä¸”çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åä¼šæœ‰è¿”å›å€¼ã€‚ \n> æ³¨æ„ï¼šï¼ˆ1ï¼‰å’Œï¼ˆ2ï¼‰éƒ½æ˜¯è°ƒç”¨start()æ–¹æ³•å¯åŠ¨çº¿ç¨‹çš„ï¼Œç„¶åJVMè™šæ‹Ÿæœºå°†æ­¤çº¿ç¨‹æ”¾åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œæœ‰å¤„ç†æœºå¯ç”¨æ—¶ï¼Œåˆ™æ‰§è¡Œrunæ–¹æ³•ã€‚è¿™ä¸¤ç§æ–¹æ³•éƒ½é‡å†™äº†runæ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›å€¼ã€‚\n\n![EvGuGj.jpg](https://s2.ax1x.com/2019/05/20/EvGuGj.jpg)\n\n\n---\n\n#### å‡è®¾æœ‰ä»¥ä¸‹ä»£ç \n\n```\nString s=â€helloâ€;\nString t=â€helloâ€;\nchar c[] ={â€˜hâ€™,â€™eâ€™,â€™lâ€™,â€™lâ€™,â€™oâ€™};\n```\nä¸‹åˆ—é€‰é¡¹ä¸­è¿”å›falseçš„è¯­å¥æ˜¯ï¼št.equals(c);\n\n```\ns.equals(t);\nt.equals(c);\ns==t;\nt.equals(new String(â€œhelloâ€));\n```\n\n```\nString s=â€helloâ€;//é¦–å…ˆä¼šåœ¨å­—ç¬¦ä¸²ç¼“å†²åŒºæ‰¾æ‰¾æœ‰æ²¡æœ‰helloï¼Œç»“æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±åˆ›å»ºäº†ä¸€ä¸ªhelloï¼Œç„¶åå¼•ç”¨æ˜¯s\nString t=â€helloâ€;//ä¼šåœ¨å­—ç¬¦ä¸²ç¼“å†²åŒºæ‰¾helloï¼Œç»“æœæ‰¾åˆ°äº†ï¼Œå°±è¿”å›äº†å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯sï¼›æ‰€ä»¥è¿™å¥è¯ç­‰åŒäºt=sï¼›æ‰€ä»¥ä¸¤ä¸ªå¼•ç”¨ä¸€æ ·ï¼›æ‰€ä»¥t==sæ˜¯true\nChar c[] ={â€˜hâ€™,â€™eâ€™,â€™lâ€™,â€™lâ€™,oâ€™â€™};//è¿™å°±æ˜¯ä¸€ä¸ªæ•°ç»„,è€Œä¸”æ•°ç»„åœ¨å †ä¸Š\nequlseå‡½æ•°å¯ä»¥çœ‹æºç ï¼æ¯”è¾ƒå€¼ç›¸ç­‰ä¹‹å‰ä¼šå…ˆæ¯”è¾ƒç±»å‹æ˜¯ä¸æ˜¯ä¸€æ ·ï¼›å¦‚æœç±»å‹ä¸€æ ·æ‰ä¼šæ¯”è¾ƒå€¼ï¼›å¦‚æœç±»å‹ä¸ä¸€è‡´å°±ç›´æ¥return falseï¼›\næ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ï¼šACDè¿”å›true Bfalse\n```\n\n---\n\n#### transientå˜é‡å’Œä¸‹é¢å“ªä¸€é¡¹æœ‰å…³ï¼ˆAï¼‰ï¼Ÿ\n```\nSerializable\nCloneable\nRunnable\nThrowable\nComparable\n```\n> æˆ‘ä»¬éƒ½çŸ¥é“ä¸€ä¸ªå¯¹è±¡åªè¦å®ç°äº†Serilizableæ¥å£ï¼Œè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¢«åºåˆ—åŒ–ï¼Œjavaçš„è¿™ç§åºåˆ—åŒ–æ¨¡å¼ä¸ºå¼€å‘è€…æä¾›äº†å¾ˆå¤šä¾¿åˆ©ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å¿…å…³ç³»å…·ä½“åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œåªè¦è¿™ä¸ªç±»å®ç°äº†Serilizableæ¥å£ï¼Œè¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•éƒ½ä¼šè‡ªåŠ¨åºåˆ—åŒ–ã€‚\nè¿™ä¸ªç±»çš„æœ‰äº›å±æ€§éœ€è¦åºåˆ—åŒ–ï¼Œè€Œå…¶ä»–å±æ€§ä¸éœ€è¦è¢«åºåˆ—åŒ–ï¼›\njava çš„transientå…³é”®å­—ä¸ºæˆ‘ä»¬æä¾›äº†ä¾¿åˆ©ï¼Œä½ åªéœ€è¦å®ç°Serilizableæ¥å£ï¼Œå°†ä¸éœ€è¦åºåˆ—åŒ–çš„å±æ€§å‰æ·»åŠ å…³é”®å­—transientï¼Œåºåˆ—åŒ–å¯¹è±¡çš„æ—¶å€™ï¼Œè¿™ä¸ªå±æ€§å°±ä¸ä¼šåºåˆ—åŒ–åˆ°æŒ‡å®šçš„ç›®çš„åœ°ä¸­ã€‚\n\n---\n\n\n<html>\n<a href=\"https://imgchr.com/i/EvGqYQ\"><img src=\"https://s2.ax1x.com/2019/05/20/EvGqYQ.png\" alt=\"EvGqYQ.png\" border=\"0\" /></a>\n</html>\n\n\n---\n<html>\n<a href=\"https://s2.ax1x.com/2019/05/20/EvJG6I.png\"><img src=\"https://s2.ax1x.com/2019/05/20/EvJG6I.png\" alt=\"EvGqYQ.png\" border=\"0\" /></a>\n</html>\n\n![EvJwtg.png](https://s2.ax1x.com/2019/05/20/EvJwtg.png)\n\n\n---\n![EvJfNF.png](https://s2.ax1x.com/2019/05/20/EvJfNF.png)\n\n\n---\n## 2019/5/20\n\n![VpBEnO.png](https://s2.ax1x.com/2019/05/22/VpBEnO.png)\n\n\nArrayListå’ŒLinkedListåœ¨æ€§èƒ½ä¸Šå„æœ‰ä¼˜ç¼ºç‚¹ï¼Œéƒ½æœ‰å„è‡ªæ‰€é€‚ç”¨çš„åœ°æ–¹ï¼Œæ€»çš„è¯´æ¥å¯ä»¥æè¿°å¦‚ä¸‹ï¼š\n\n1ï¼å¯¹ArrayListå’ŒLinkedListè€Œè¨€ï¼Œåœ¨åˆ—è¡¨æœ«å°¾å¢åŠ ä¸€ä¸ªå…ƒç´ æ‰€èŠ±çš„å¼€é”€éƒ½æ˜¯å›ºå®šçš„ã€‚å¯¹ArrayListè€Œè¨€ï¼Œä¸»è¦æ˜¯åœ¨å†…éƒ¨æ•°ç»„ä¸­å¢åŠ ä¸€é¡¹ï¼ŒæŒ‡å‘æ‰€æ·»åŠ çš„å…ƒç´ ï¼Œå¶å°”å¯èƒ½ä¼šå¯¼è‡´å¯¹æ•°ç»„é‡æ–°è¿›è¡Œåˆ†é…ï¼›è€Œå¯¹LinkedListè€Œè¨€ï¼Œè¿™ä¸ªå¼€é”€æ˜¯ç»Ÿä¸€çš„ï¼Œåˆ†é…ä¸€ä¸ªå†…éƒ¨Entryå¯¹è±¡ã€‚\n\n2ï¼åœ¨ArrayListçš„ä¸­é—´æ’å…¥æˆ–åˆ é™¤ä¸€ä¸ªå…ƒç´ æ„å‘³ç€è¿™ä¸ªåˆ—è¡¨ä¸­å‰©ä½™çš„å…ƒç´ éƒ½ä¼šè¢«ç§»åŠ¨ï¼›è€Œåœ¨LinkedListçš„ä¸­é—´æ’å…¥æˆ–åˆ é™¤ä¸€ä¸ªå…ƒç´ çš„å¼€é”€æ˜¯å›ºå®šçš„ã€‚\n\n3ï¼LinkedListä¸æ”¯æŒé«˜æ•ˆçš„éšæœºå…ƒç´ è®¿é—®ã€‚\n\n4ï¼ArrayListçš„ç©ºé—´æµªè´¹ä¸»è¦ä½“ç°åœ¨åœ¨liståˆ—è¡¨çš„ç»“å°¾é¢„ç•™ä¸€å®šçš„å®¹é‡ç©ºé—´ï¼Œè€ŒLinkedListçš„ç©ºé—´èŠ±è´¹åˆ™ä½“ç°åœ¨å®ƒçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½éœ€è¦æ¶ˆè€—ç›¸å½“çš„ç©ºé—´\n\nå¯ä»¥è¿™æ ·è¯´ï¼šå½“æ“ä½œæ˜¯åœ¨ä¸€åˆ—æ•°æ®çš„åé¢æ·»åŠ æ•°æ®è€Œä¸æ˜¯åœ¨å‰é¢æˆ–ä¸­é—´,å¹¶ä¸”éœ€è¦éšæœºåœ°è®¿é—®å…¶ä¸­çš„å…ƒç´ æ—¶,ä½¿ç”¨ArrayListä¼šæä¾›æ¯”è¾ƒå¥½çš„æ€§èƒ½ï¼›å½“ä½ çš„æ“ä½œæ˜¯åœ¨ä¸€åˆ—æ•°æ®çš„å‰é¢æˆ–ä¸­é—´æ·»åŠ æˆ–åˆ é™¤æ•°æ®,å¹¶ä¸”æŒ‰ç…§é¡ºåºè®¿é—®å…¶ä¸­çš„å…ƒç´ æ—¶,å°±åº”è¯¥ä½¿ç”¨LinkedListäº†ã€‚\n\n---\n![image](https://s2.ax1x.com/2019/05/22/Vprjnf.png)\n\n\n---\n\n![VpsFcq.png](https://s2.ax1x.com/2019/05/22/VpsFcq.png)\n\n![VpsZHU.png](https://s2.ax1x.com/2019/05/22/VpsZHU.png)\n\n---\n\n![VAemMd.png](https://s2.ax1x.com/2019/05/25/VAemMd.png)\n\n![VAeZxH.png](https://s2.ax1x.com/2019/05/25/VAeZxH.png)\n\n---\n![VVsUne.png](https://s2.ax1x.com/2019/05/27/VVsUne.png)\n\n![image](https://s2.ax1x.com/2019/05/27/VVsd7d.png)\n\n---\n\n![image](https://s2.ax1x.com/2019/05/31/VQ6PeI.jpg)\n\n![image](https://s2.ax1x.com/2019/05/31/VQ6EY8.jpg)\n\n\n---\n\nprivateæ–¹æ³•åªå¯ä»¥åœ¨ç±»çš„å†…éƒ¨ä½¿ç”¨ï¼Œåœ¨ç±»å¤–æ ¹æœ¬è®¿é—®ä¸åˆ°ï¼Œ è€Œfinalæ–¹æ³•å¯ä»¥åœ¨ç±»å¤–è®¿é—®ï¼Œä½†æ˜¯ä¸å¯ä»¥é‡å†™è¯¥æ–¹æ³•ï¼Œå°±æ˜¯è¯´å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•çš„åŠŸèƒ½ä½†æ˜¯ä¸å¯ä»¥æ”¹å˜å…¶åŠŸèƒ½ï¼Œè¿™å°±æ˜¯privateæ–¹æ³•å’Œfinalæ–¹æ³•çš„æœ€å¤§åŒºåˆ«\n\n---\n![image](https://s2.ax1x.com/2019/06/03/VJk9js.png)\n![VJk7PU.png](https://s2.ax1x.com/2019/06/03/VJk7PU.png)\n\n---\n![VJkPun.png](https://s2.ax1x.com/2019/06/03/VJkPun.png)\n\n![VJkiBq.png](https://s2.ax1x.com/2019/06/03/VJkiBq.png)\n\n---\n![VJkAEV.png](https://s2.ax1x.com/2019/06/03/VJkAEV.png)\n![VJkENT.png](https://s2.ax1x.com/2019/06/03/VJkENT.png)\n==systemæ˜¯å±äºjava.lang.sysytem==\n\n---\n![VJkV4U.png](https://s2.ax1x.com/2019/06/03/VJkV4U.png)\n==runå’ŒstartåŒºåˆ†==\n\n![VJk5V0.png](https://s2.ax1x.com/2019/06/03/VJk5V0.png)\n![VJkIaV.png](https://s2.ax1x.com/2019/06/03/VJkIaV.png)\n\n---\n\n![image](https://s2.ax1x.com/2019/06/20/VvCXxf.png)](https://imgchr.com/i/VvCXxf)\n> DriverManager.getConnectionæ–¹æ³•è¿”å›ä¸€ä¸ªConnectionå¯¹è±¡ï¼Œè¿™æ˜¯åŠ è½½é©±åŠ¨ä¹‹åæ‰èƒ½è¿›è¡Œçš„\n\n---\n![image](https://s2.ax1x.com/2019/06/20/VvPiin.png)\n![VvP7OU.png](https://s2.ax1x.com/2019/06/20/VvP7OU.png)\n\n---\n![VvZ5E8.png](https://s2.ax1x.com/2019/06/20/VvZ5E8.png)\n![VvZH3j.png](https://s2.ax1x.com/2019/06/20/VvZH3j.png)\n\n---\n![VveTZ6.png](https://s2.ax1x.com/2019/06/20/VveTZ6.png)\n![VveLJe.png](https://s2.ax1x.com/2019/06/20/VveLJe.png)\n![VveXzd.png](https://s2.ax1x.com/2019/06/20/VveXzd.png)\n\n---\n![VzWf5d.png](https://s2.ax1x.com/2019/06/21/VzWf5d.png)\n![image](https://s2.ax1x.com/2019/06/21/VzWcDO.png)\n\n\n---\n![image](https://s2.ax1x.com/2019/06/30/ZlTCAs.png)\n![ZlTPNn.png](https://s2.ax1x.com/2019/06/30/ZlTPNn.png)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/0HW8VlMLXKFwytO9wXmUAK6m)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/rdVWz3gh0ZjiQyHtYwUqlq16)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/COJD9sL3krd3vJp3Ja8fTKrn)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ZhMfEjtPC3s2VJzL41BiRvAD)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/w4vKZ0BoZWc3YxOutmvpcyDM)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/F1woihIvqIPaeZyXUpgn0ntO)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/wxY5IjQ7D0DgNAvicRW5e9Ef)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/PvNpSO2v7zy9k7UJjOHPr0wj)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/O3seoqiOeiU3Nzya3GKvserz)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/5pYhsqV7rWDDX9yGQy3sScqE)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/Aq2iliB81V88glNAVgPxGqmy)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/iXB0NrLNUG8M8XxvXvCW2Mis)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/sKkuzNLL3hsdSjBxb8c1CFMr)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/tymrewqqJnQwg6i1uZxl2f5c)\n\n---\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/cK4JahKZ1U9nKvYzpPDnZeGA)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/VRxDTMI4TFZ8x4P5gokeZ5Qd)\n>æ³¨æ„äºŒåˆ†æ³•åŒºåŸŸçš„é€‰æ‹©\n\n---\n');
INSERT INTO `blog_content` VALUES (48, '## Dockerfile\n### ä¸€ã€ç®€ä»‹\n#### 1.1 dockerfileä¸­å¸¸ç”¨çš„å‘½ä»¤åˆé›†\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/8rx9JEBshSGuBu6terzm0OKI)\n#### 1.2 docker build åŸºäºdockerfileåˆ¶ä½œé•œåƒçš„å‘½ä»¤\n`docker build [OPTIONS] PATH | URL | -å‚æ•°`\n#### 1.3 å‚æ•°é€‰é¡¹\n- --build-arg=[] :è®¾ç½®é•œåƒåˆ›å»ºæ—¶çš„å˜é‡ï¼›\n\n- --cpu-shares :è®¾ç½® cpu ä½¿ç”¨æƒé‡ï¼›\n\n- --cpu-period :é™åˆ¶ CPU CFSå‘¨æœŸï¼›\n\n- --cpu-quota :é™åˆ¶ CPU CFSé…é¢ï¼›\n\n- --cpuset-cpus :æŒ‡å®šä½¿ç”¨çš„CPU idï¼›\n\n- --cpuset-mems :æŒ‡å®šä½¿ç”¨çš„å†…å­˜ idï¼›\n\n- --disable-content-trust :å¿½ç•¥æ ¡éªŒï¼Œé»˜è®¤å¼€å¯ï¼›\n\n- -f :æŒ‡å®šè¦ä½¿ç”¨çš„Dockerfileè·¯å¾„ï¼›\n\n- --force-rm :è®¾ç½®é•œåƒè¿‡ç¨‹ä¸­åˆ é™¤ä¸­é—´å®¹å™¨ï¼›\n\n- --isolation :ä½¿ç”¨å®¹å™¨éš”ç¦»æŠ€æœ¯ï¼›\n\n- --label=[] :è®¾ç½®é•œåƒä½¿ç”¨çš„å…ƒæ•°æ®ï¼›\n\n- -m :è®¾ç½®å†…å­˜æœ€å¤§å€¼ï¼›\n\n- --memory-swap :è®¾ç½®Swapçš„æœ€å¤§å€¼ä¸ºå†…å­˜+swapï¼Œ\"-1\"è¡¨ç¤ºä¸é™swapï¼›\n\n- --no-cache :åˆ›å»ºé•œåƒçš„è¿‡ç¨‹ä¸ä½¿ç”¨ç¼“å­˜ï¼›\n\n- --pull :å°è¯•å»æ›´æ–°é•œåƒçš„æ–°ç‰ˆæœ¬ï¼›\n\n- --quiet, -q :å®‰é™æ¨¡å¼ï¼ŒæˆåŠŸååªè¾“å‡ºé•œåƒ IDï¼›\n\n- --rm :è®¾ç½®é•œåƒæˆåŠŸååˆ é™¤ä¸­é—´å®¹å™¨ï¼›\n\n- --shm-size :è®¾ç½®/dev/shmçš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯64Mï¼›\n\n- --ulimit :Ulimité…ç½®ã€‚\n\n- --tag, -t: é•œåƒçš„åå­—åŠæ ‡ç­¾ï¼Œé€šå¸¸ name:tag æˆ–è€… name æ ¼å¼ï¼›å¯ä»¥åœ¨ä¸€æ¬¡æ„å»ºä¸­ä¸ºä¸€ä¸ªé•œåƒè®¾ç½®å¤šä¸ªæ ‡ç­¾ã€‚\n\n- --network: é»˜è®¤ defaultã€‚åœ¨æ„å»ºæœŸé—´è®¾ç½®RUNæŒ‡ä»¤çš„ç½‘ç»œæ¨¡å¼\n```yml\n#ä¾‹å¦‚\nFROM centos:7\nARG user # ARG user=root\nUSER $user\n```\n\n```shell\ndocker build --build-arg user=yhhu .\n```\n\n1.4 è¿™é‡Œè®²ä¸€ä¸‹`CMD`ã€`ENTRYPOINT`å’Œ`RUN`çš„åŒºåˆ«ï¼Œå…¶ä»–ç›¸å…³å†…å®¹å¯ä»¥æŸ¥çœ‹ä¸‹æ–¹å‚è€ƒé“¾æ¥\n- ä¸€ä¸ªDockerfileä¸­åªèƒ½æœ‰ä¸€ä¸ªCMDå‘½ä»¤ã€‚( docker runæ—¶è¿è¡Œï¼Œdockerfile ä¸­å¦‚æœå­˜åœ¨å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä»…æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚CMD æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºå¯è¢« docker run å‘½ä»¤è¡Œå‚æ•°ä¸­æŒ‡å®šè¦è¿è¡Œçš„ç¨‹åºæ‰€è¦†ç›–ã€‚)\n- ä¸€ä¸ªDockerfileä¸­å¯ä»¥æœ‰è®¸å¤šä¸ªRUNå‘½ä»¤ã€‚(docker buldæ—¶è¿è¡Œ)\n- ENTRYPOINT æŒ‡ä»¤ï¼šç±»ä¼¼äº CMD æŒ‡ä»¤ï¼Œä½†å…¶ä¸ä¼šè¢« docker run çš„å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šçš„æŒ‡ä»¤æ‰€è¦†ç›–ï¼Œè€Œä¸”è¿™äº›å‘½ä»¤è¡Œå‚æ•°ä¼šè¢«å½“ä½œå‚æ•°é€ç»™ ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºï¼›ä½†æ˜¯, å¦‚æœè¿è¡Œ docker run æ—¶ä½¿ç”¨äº† --entrypoint é€‰é¡¹ï¼Œæ­¤é€‰é¡¹çš„å‚æ•°å¯å½“ä½œè¦è¿è¡Œçš„ç¨‹åºè¦†ç›– ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºï¼›\n\n### å‚è€ƒ\n[Dockerç³»åˆ—07â€”Dockerfile è¯¦è§£](https://www.cnblogs.com/along21/p/10243761.html)\n\n## Docker-compose\n### å®‰è£…æ–¹æ³•\n#### [å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/compose/install/)\n\n## ç®€å•ä»‹ç»docker-composeæ–‡ä»¶çš„ç¼–å†™æ–¹æ³•\n> è¿™é‡Œä»¥ä¸€ä¸ªmysql+redisçš„é…ç½®æ–¹æ³•ä¸¾ä¾‹\n\n### ä¸€. å…ˆåˆ¤æ–­docker-composeæ˜¯å¦å®‰è£…å®Œæˆ\n```shell\n$ docker-compose --version\n```\n### äºŒ. docker-composeå¸¸è§å‚æ•°\n```yml\n#ç‰ˆæœ¬å·\nversion: \"3.1\"\n#æœåŠ¡åˆ—è¡¨\nservices:\n  #æœåŠ¡å\n  mysql:\n    #å®¹å™¨åç§°\n    container_name: mysql-docker\n    #ä½¿ç”¨çš„é•œåƒ\n    image: mysql\n    #æ²¡å¯åŠ¨æ—¶æ˜¯å¦è‡ªåŠ¨é‡å¯\n    restart: always\n    #æ˜ å°„ç«¯å£    :å‰çš„ä¸ºæœ¬åœ°ç«¯å£ï¼Œ:åçš„ä¸ºå®¹å™¨çš„ç«¯å£\n    ports:\n      - \"3306:3306\"\n    #æ·»åŠ ç¯å¢ƒå˜é‡\n    environment:\n      MYSQL_ROOT_PASSWORD: 123456\n      TZ: \"Asia/Shanghai\"\n    #æŒ‚è½½æ–‡ä»¶ç›®å½•\n    volumes:\n      - \"./storages/data/mysql:/var/lib/mysql\"\n      - \"./storages/config/my.cnf:/etc/my.cnf\"\n  redis:\n    image: redis\n    restart: always\n    command: --appendonly yes\n    ports:\n      - 6379:6379\n    volumes:\n      - \"./storages/data/redis:/data\"\n```\n');
INSERT INTO `blog_content` VALUES (49, '## å‰è¨€\næœ¬æ–‡ç« å†…å®¹å‚è€ƒè‡ª[RocketMQç³»ç»Ÿç²¾è®²ï¼Œç»å—å†å¹´åŒåä¸€ç‹‚æ¬¢èŠ‚è€ƒéªŒçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶](https://www.bilibili.com/video/av66702383/?p=97)ï¼Œå¯¹å·²æœ‰å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œç²¾ç®€éƒ¨åˆ†å†…å®¹ï¼Œå¹¶ä¸”ä½¿ç”¨`spring-cloud-starter-stream-rocketmq`æ¥ä»£æ›¿Bç«™è§†é¢‘ä¸­çš„spring-booté›†æˆåŒ…ã€‚ä¿®æ”¹åçš„ä¸ªäººå®Œæ•´demoåœ°å€ï¼š[github](https://github.com/yhuihu/Java-Study/tree/master/RocketMQ)\n\n# 1. MQä»‹ç»\n\n## 1.1 ä¸ºä»€ä¹ˆè¦ç”¨MQ\n\næ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§â€œå…ˆè¿›å…ˆå‡ºâ€çš„æ•°æ®ç»“æ„\n\n![queue1.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/e5xlNj3f9VTPgxDLVmfGzko3)\n\nå…¶åº”ç”¨åœºæ™¯ä¸»è¦åŒ…å«ä»¥ä¸‹3ä¸ªæ–¹é¢\n\n* åº”ç”¨è§£è€¦\n\nç³»ç»Ÿçš„è€¦åˆæ€§è¶Šé«˜ï¼Œå®¹é”™æ€§å°±è¶Šä½ã€‚ä»¥ç”µå•†åº”ç”¨ä¸ºä¾‹ï¼Œç”¨æˆ·åˆ›å»ºè®¢å•åï¼Œå¦‚æœè€¦åˆè°ƒç”¨åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªå­ç³»ç»Ÿå‡ºäº†æ•…éšœæˆ–è€…å› ä¸ºå‡çº§ç­‰åŸå› æš‚æ—¶ä¸å¯ç”¨ï¼Œéƒ½ä¼šé€ æˆä¸‹å•æ“ä½œå¼‚å¸¸ï¼Œå½±å“ç”¨æˆ·ä½¿ç”¨ä½“éªŒã€‚\n\n::: hljs-center\n![è§£è€¦1.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/3fPewYEq749gjfSvEc5mGw5I)\n:::\n\nä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è§£è€¦åˆï¼Œç³»ç»Ÿçš„è€¦åˆæ€§å°±ä¼šæé«˜äº†ã€‚æ¯”å¦‚ç‰©æµç³»ç»Ÿå‘ç”Ÿæ•…éšœï¼Œéœ€è¦å‡ åˆ†é’Ÿæ‰èƒ½æ¥ä¿®å¤ï¼Œåœ¨è¿™æ®µæ—¶é—´å†…ï¼Œç‰©æµç³»ç»Ÿè¦å¤„ç†çš„æ•°æ®è¢«ç¼“å­˜åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç”¨æˆ·çš„ä¸‹å•æ“ä½œæ­£å¸¸å®Œæˆã€‚å½“ç‰©æµç³»ç»Ÿå›å¤åï¼Œè¡¥å……å¤„ç†å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„è®¢å•æ¶ˆæ¯å³å¯ï¼Œç»ˆç«¯ç³»ç»Ÿæ„ŸçŸ¥ä¸åˆ°ç‰©æµç³»ç»Ÿå‘ç”Ÿè¿‡å‡ åˆ†é’Ÿæ•…éšœã€‚\n\n::: hljs-center\n![è§£è€¦2.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/pY3unaQT4DrvJjEznAmyun7q)\n:::\n\n* æµé‡å‰Šå³°\n::: hljs-center\n![mq5.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/NgpxkBRSMR9vtxcEi1ZRV6sz)\n:::\n\nåº”ç”¨ç³»ç»Ÿå¦‚æœé‡åˆ°ç³»ç»Ÿè¯·æ±‚æµé‡çš„ç¬é—´çŒ›å¢ï¼Œæœ‰å¯èƒ½ä¼šå°†ç³»ç»Ÿå‹å®ã€‚æœ‰äº†æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å°†å¤§é‡è¯·æ±‚ç¼“å­˜èµ·æ¥ï¼Œåˆ†æ•£åˆ°å¾ˆé•¿ä¸€æ®µæ—¶é—´å¤„ç†ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æåˆ°ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚\n::: hljs-center\n![mq6.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/KLiEDUJJpmIeT54o8gvsghPk)\n:::\n![](img/mq-6.png)\n\nä¸€èˆ¬æƒ…å†µï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œå¦‚æœç³»ç»Ÿè´Ÿè½½è¶…è¿‡é˜ˆå€¼ï¼Œå°±ä¼šé˜»æ­¢ç”¨æˆ·è¯·æ±‚ï¼Œè¿™ä¼šå½±å“ç”¨æˆ·ä½“éªŒï¼Œè€Œå¦‚æœä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å°†è¯·æ±‚ç¼“å­˜èµ·æ¥ï¼Œç­‰å¾…ç³»ç»Ÿå¤„ç†å®Œæ¯•åé€šçŸ¥ç”¨æˆ·ä¸‹å•å®Œæ¯•ï¼Œè¿™æ ·æ€»ä¸èƒ½ä¸‹å•ä½“éªŒè¦å¥½ã€‚\n\n<u>å¤„äºç»æµè€ƒé‡ç›®çš„ï¼š</u>\n\nä¸šåŠ¡ç³»ç»Ÿæ­£å¸¸æ—¶æ®µçš„QPSå¦‚æœæ˜¯1000ï¼Œæµé‡æœ€é«˜å³°æ˜¯10000ï¼Œä¸ºäº†åº”å¯¹æµé‡é«˜å³°é…ç½®é«˜æ€§èƒ½çš„æœåŠ¡å™¨æ˜¾ç„¶ä¸åˆ’ç®—ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¯¹å³°å€¼æµé‡å‰Šå³°\n\n* æ•°æ®åˆ†å‘\n::: hljs-center\n![mq1.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/I9zCrARSQNIdUsiA6v5XCitl)\n:::\n\né€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥è®©æ•°æ®åœ¨å¤šä¸ªç³»ç»Ÿæ›´åŠ ä¹‹é—´è¿›è¡Œæµé€šã€‚æ•°æ®çš„äº§ç”Ÿæ–¹ä¸éœ€è¦å…³å¿ƒè°æ¥ä½¿ç”¨æ•°æ®ï¼Œåªéœ€è¦å°†æ•°æ®å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ•°æ®ä½¿ç”¨æ–¹ç›´æ¥åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ç›´æ¥è·å–æ•°æ®å³å¯\n![mq2.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/MRoO3xrjW7F97Au7hQr8OASQ)\n\n## 1.2 MQçš„ä¼˜ç‚¹å’Œç¼ºç‚¹\n\nä¼˜ç‚¹ï¼šè§£è€¦ã€å‰Šå³°ã€æ•°æ®åˆ†å‘\n\nç¼ºç‚¹åŒ…å«ä»¥ä¸‹å‡ ç‚¹ï¼š\n\n* ç³»ç»Ÿå¯ç”¨æ€§é™ä½\n\n  ç³»ç»Ÿå¼•å…¥çš„å¤–éƒ¨ä¾èµ–è¶Šå¤šï¼Œç³»ç»Ÿç¨³å®šæ€§è¶Šå·®ã€‚ä¸€æ—¦MQå®•æœºï¼Œå°±ä¼šå¯¹ä¸šåŠ¡é€ æˆå½±å“ã€‚\n\n  å¦‚ä½•ä¿è¯MQçš„é«˜å¯ç”¨ï¼Ÿ\n\n* ç³»ç»Ÿå¤æ‚åº¦æé«˜\n\n  MQçš„åŠ å…¥å¤§å¤§å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œä»¥å‰ç³»ç»Ÿé—´æ˜¯åŒæ­¥çš„è¿œç¨‹è°ƒç”¨ï¼Œç°åœ¨æ˜¯é€šè¿‡MQè¿›è¡Œå¼‚æ­¥è°ƒç”¨ã€‚\n\n  å¦‚ä½•ä¿è¯æ¶ˆæ¯æ²¡æœ‰è¢«é‡å¤æ¶ˆè´¹ï¼Ÿæ€ä¹ˆå¤„ç†æ¶ˆæ¯ä¸¢å¤±æƒ…å†µï¼Ÿé‚£ä¹ˆä¿è¯æ¶ˆæ¯ä¼ é€’çš„é¡ºåºæ€§ï¼Ÿ\n\n* ä¸€è‡´æ€§é—®é¢˜\n\n  Aç³»ç»Ÿå¤„ç†å®Œä¸šåŠ¡ï¼Œé€šè¿‡MQç»™Bã€Cã€Dä¸‰ä¸ªç³»ç»Ÿå‘æ¶ˆæ¯æ•°æ®ï¼Œå¦‚æœBç³»ç»Ÿã€Cç³»ç»Ÿå¤„ç†æˆåŠŸï¼ŒDç³»ç»Ÿå¤„ç†å¤±è´¥ã€‚\n\n  å¦‚ä½•ä¿è¯æ¶ˆæ¯æ•°æ®å¤„ç†çš„ä¸€è‡´æ€§ï¼Ÿ\n\n# 2. RocketMQå¿«é€Ÿå…¥é—¨\n\nRocketMQæ˜¯é˜¿é‡Œå·´å·´2016å¹´MQä¸­é—´ä»¶ï¼Œä½¿ç”¨Javaè¯­è¨€å¼€å‘ï¼Œåœ¨é˜¿é‡Œå†…éƒ¨ï¼ŒRocketMQæ‰¿æ¥äº†ä¾‹å¦‚â€œåŒ11â€ç­‰é«˜å¹¶å‘åœºæ™¯çš„æ¶ˆæ¯æµè½¬ï¼Œèƒ½å¤Ÿå¤„ç†ä¸‡äº¿çº§åˆ«çš„æ¶ˆæ¯ã€‚\n\n## 2.1 å®‰è£…RocketMQ\n\n### 2.1.1 åœ¨è™šæ‹Ÿæœºä¸Šå®‰è£…docker\n\nå‚è€ƒæˆ‘çš„åšå®¢ä¸­dockerå®‰è£…çš„æ–‡ç« [CentOSä¸‹dockerå®‰è£…](http://blog.yhhu.xyz/#/blog/33)\n\n### 2.1.2 åˆ›å»ºç›®å½•ç»“æ„ä»¥åŠç¼–å†™docker-composeæ–‡ä»¶\n\nå®Œæ•´æ–‡ä»¶ç›®å½•ç»“æ„å¦‚ä¸‹(è‡ªè¡Œå¿½ç•¥æ— ç”¨éƒ¨åˆ†ã€‚ã€‚ã€‚)ï¼š\n::: hljs-center\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/iOtUG41sYLHMlOMcFjkg9zlj)\n:::\n\n\n```yml\nversion: \"3.5\"\nservices:  \n  #RocketMQ\n  rmqnamesrv:\n    image: foxiswho/rocketmq:server-4.5.2\n    container_name: rmqnamesrv\n    ports:\n      - 9876:9876\n    volumes:\n      - ./data/rocketmq/namesrv/logs:/opt/logs\n      - ./data/rocketmq/namesrv/store:/opt/store\n    environment:\n      JAVA_OPT_EXT: \"-Duser.home=/opt -Xms128m -Xmx128m -Xmn128m\"\n    restart: always\n    networks:\n        rmq:\n          aliases:\n            - rmqnamesrv\n  rmqbroker:\n    image: foxiswho/rocketmq:broker-4.5.2\n    container_name: rmqbroker\n    ports:\n      - 10909:10909\n      - 10911:10911\n    volumes:\n      - ./data/rocketmq/broker/logs:/opt/logs\n      - ./data/rocketmq/broker/store:/opt/store\n      - ./rocketmq/broker.conf:/etc/rocketmq/broker.conf\n    environment:\n      JAVA_OPT_EXT: \"-Duser.home=/opt -server -Xms128m -Xmx128m -Xmn128m\"\n    command: [\"/bin/bash\",\"mqbroker\",\"-c\",\"/etc/rocketmq/broker.conf\",\"-n\",\"rmqnamesrv:9876\",\"autoCreateTopicEnable=true\"]\n    restart: always\n    depends_on:\n      - rmqnamesrv\n    networks:\n      rmq:\n        aliases:\n          - rmqbroker\n\n  rmqconsole:\n    image: styletang/rocketmq-console-ng\n    container_name: rmqconsole\n    ports:\n      - 8180:8080\n    environment:\n        JAVA_OPTS: \"-Drocketmq.namesrv.addr=rmqnamesrv:9876 -Dcom.rocketmq.sendMessageWithVIPChannel=false\"\n    depends_on:\n      - rmqnamesrv\n    networks:\n      rmq:\n        aliases:\n          - rmqconsole\n\nnetworks:\n  rmq:\n    name: rmq\n    driver: bridge\n```\n\nbroker.confé…ç½®æ–‡ä»¶å†…å®¹\n```yml\n# æ‰€å±é›†ç¾¤åå­—\nbrokerClusterName=DefaultCluster\n\n# broker åå­—ï¼Œæ³¨æ„æ­¤å¤„ä¸åŒçš„é…ç½®æ–‡ä»¶å¡«å†™çš„ä¸ä¸€æ ·ï¼Œå¦‚æœåœ¨ broker-a.properties ä½¿ç”¨: broker-a,\n# åœ¨ broker-b.properties ä½¿ç”¨: broker-b\nbrokerName=broker-a\n\n# 0 è¡¨ç¤º Masterï¼Œ> 0 è¡¨ç¤º Slave\nbrokerId=0\n\n# nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²\n# namesrvAddr=rocketmq-nameserver1:9876;rocketmq-nameserver2:9876\n\n# å¯åŠ¨IP,å¦‚æœ docker æŠ¥ com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to <192.168.0.120:10909> failed\n# è§£å†³æ–¹å¼1 åŠ ä¸Šä¸€å¥ producer.setVipChannelEnabled(false);ï¼Œè§£å†³æ–¹å¼2 brokerIP1 è®¾ç½®å®¿ä¸»æœºIPï¼Œä¸è¦ä½¿ç”¨docker å†…éƒ¨IP\nbrokerIP1=my.service.com\n\n# åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºæœåŠ¡å™¨ä¸å­˜åœ¨çš„topicï¼Œé»˜è®¤åˆ›å»ºçš„é˜Ÿåˆ—æ•°\ndefaultTopicQueueNums=4\n\n# æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»º Topicï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­ ï¼ï¼ï¼è¿™é‡Œä»”ç»†çœ‹æ˜¯ falseï¼Œfalseï¼Œfalse\nautoCreateTopicEnable=true\n\n# æ˜¯å¦å…è®¸ Broker è‡ªåŠ¨åˆ›å»ºè®¢é˜…ç»„ï¼Œå»ºè®®çº¿ä¸‹å¼€å¯ï¼Œçº¿ä¸Šå…³é—­\nautoCreateSubscriptionGroup=true\n\n# sqlè¿‡æ»¤æ”¯æŒ\nenablePropertyFilter = true\n\n# Broker å¯¹å¤–æœåŠ¡çš„ç›‘å¬ç«¯å£\nlistenPort=10911\n\n# åˆ é™¤æ–‡ä»¶æ—¶é—´ç‚¹ï¼Œé»˜è®¤å‡Œæ™¨4ç‚¹\ndeleteWhen=04\n\n# æ–‡ä»¶ä¿ç•™æ—¶é—´ï¼Œé»˜è®¤48å°æ—¶\nfileReservedTime=120\n\n# commitLog æ¯ä¸ªæ–‡ä»¶çš„å¤§å°é»˜è®¤1G\nmapedFileSizeCommitLog=1073741824\n\n# ConsumeQueue æ¯ä¸ªæ–‡ä»¶é»˜è®¤å­˜ 30W æ¡ï¼Œæ ¹æ®ä¸šåŠ¡æƒ…å†µè°ƒæ•´\nmapedFileSizeConsumeQueue=300000\n\n# destroyMapedFileIntervalForcibly=120000\n# redeleteHangedFileInterval=120000\n# æ£€æµ‹ç‰©ç†æ–‡ä»¶ç£ç›˜ç©ºé—´\ndiskMaxUsedSpaceRatio=88\n# å­˜å‚¨è·¯å¾„\n# storePathRootDir=/home/ztztdata/rocketmq-all-4.1.0-incubating/store\n# commitLog å­˜å‚¨è·¯å¾„\n# storePathCommitLog=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/commitlog\n# æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨\n# storePathConsumeQueue=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/consumequeue\n# æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„\n# storePathIndex=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/index\n# checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„\n# storeCheckpoint=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/checkpoint\n# abort æ–‡ä»¶å­˜å‚¨è·¯å¾„\n# abortFile=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/abort\n# é™åˆ¶çš„æ¶ˆæ¯å¤§å°\nmaxMessageSize=65536\n\n# flushCommitLogLeastPages=4\n# flushConsumeQueueLeastPages=2\n# flushCommitLogThoroughInterval=10000\n# flushConsumeQueueThoroughInterval=60000\n\n# Broker çš„è§’è‰²\n# - ASYNC_MASTER å¼‚æ­¥å¤åˆ¶Master\n# - SYNC_MASTER åŒæ­¥åŒå†™Master\n# - SLAVE\nbrokerRole=ASYNC_MASTER\n\n# åˆ·ç›˜æ–¹å¼\n# - ASYNC_FLUSH å¼‚æ­¥åˆ·ç›˜\n# - SYNC_FLUSH åŒæ­¥åˆ·ç›˜\nflushDiskType=ASYNC_FLUSH\n\n# å‘æ¶ˆæ¯çº¿ç¨‹æ± æ•°é‡\n# sendMessageThreadPoolNums=128\n# æ‹‰æ¶ˆæ¯çº¿ç¨‹æ± æ•°é‡\n# pullMessageThreadPoolNums=128\n```\n\n### 2.1.3 æ‰§è¡Œ`docker-compose up -d`ç­‰å¾…æ‰§è¡Œå®Œæˆ\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/B1UmUR3ZQbG4pUCye2PP04mW)\n\n# 3. RocketMQé›†ç¾¤æ­å»º\n\n## 3.1 å„è§’è‰²ä»‹ç»\n\n* Producerï¼šæ¶ˆæ¯çš„å‘é€è€…ï¼›ä¸¾ä¾‹ï¼šå‘ä¿¡è€…\n* Consumerï¼šæ¶ˆæ¯æ¥æ”¶è€…ï¼›ä¸¾ä¾‹ï¼šæ”¶ä¿¡è€…\n* Brokerï¼šæš‚å­˜å’Œä¼ è¾“æ¶ˆæ¯ï¼›ä¸¾ä¾‹ï¼šé‚®å±€\n* NameServerï¼šç®¡ç†Brokerï¼›ä¸¾ä¾‹ï¼šå„ä¸ªé‚®å±€çš„ç®¡ç†æœºæ„\n* Topicï¼šåŒºåˆ†æ¶ˆæ¯çš„ç§ç±»ï¼›ä¸€ä¸ªå‘é€è€…å¯ä»¥å‘é€æ¶ˆæ¯ç»™ä¸€ä¸ªæˆ–è€…å¤šä¸ªTopicï¼›ä¸€ä¸ªæ¶ˆæ¯çš„æ¥æ”¶è€…å¯ä»¥è®¢é˜…ä¸€ä¸ªæˆ–è€…å¤šä¸ªTopicæ¶ˆæ¯\n* Message Queueï¼šç›¸å½“äºæ˜¯Topicçš„åˆ†åŒºï¼›ç”¨äºå¹¶è¡Œå‘é€å’Œæ¥æ”¶æ¶ˆæ¯\n\n![RocketMQè§’è‰².jpg](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/L76dH74XmT8CBSH15i2ppebf)\n\n## 3.2 é›†ç¾¤æ­å»ºæ–¹å¼\n\n### 3.2.1 é›†ç¾¤ç‰¹ç‚¹\n\n- NameServeræ˜¯ä¸€ä¸ªå‡ ä¹æ— çŠ¶æ€èŠ‚ç‚¹ï¼Œå¯é›†ç¾¤éƒ¨ç½²ï¼ŒèŠ‚ç‚¹ä¹‹é—´æ— ä»»ä½•ä¿¡æ¯åŒæ­¥ã€‚\n\n- Brokeréƒ¨ç½²ç›¸å¯¹å¤æ‚ï¼ŒBrokeråˆ†ä¸ºMasterä¸Slaveï¼Œä¸€ä¸ªMasterå¯ä»¥å¯¹åº”å¤šä¸ªSlaveï¼Œä½†æ˜¯ä¸€ä¸ªSlaveåªèƒ½å¯¹åº”ä¸€ä¸ªMasterï¼ŒMasterä¸Slaveçš„å¯¹åº”å…³ç³»é€šè¿‡æŒ‡å®šç›¸åŒçš„BrokerNameï¼Œä¸åŒçš„BrokerIdæ¥å®šä¹‰ï¼ŒBrokerIdä¸º0è¡¨ç¤ºMasterï¼Œé0è¡¨ç¤ºSlaveã€‚Masterä¹Ÿå¯ä»¥éƒ¨ç½²å¤šä¸ªã€‚æ¯ä¸ªBrokerä¸NameServeré›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å»ºç«‹é•¿è¿æ¥ï¼Œå®šæ—¶æ³¨å†ŒTopicä¿¡æ¯åˆ°æ‰€æœ‰NameServerã€‚\n- Producerä¸NameServeré›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆéšæœºé€‰æ‹©ï¼‰å»ºç«‹é•¿è¿æ¥ï¼Œå®šæœŸä»NameServerå–Topicè·¯ç”±ä¿¡æ¯ï¼Œå¹¶å‘æä¾›TopicæœåŠ¡çš„Masterå»ºç«‹é•¿è¿æ¥ï¼Œä¸”å®šæ—¶å‘Masterå‘é€å¿ƒè·³ã€‚Producerå®Œå…¨æ— çŠ¶æ€ï¼Œå¯é›†ç¾¤éƒ¨ç½²ã€‚\n- Consumerä¸NameServeré›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆéšæœºé€‰æ‹©ï¼‰å»ºç«‹é•¿è¿æ¥ï¼Œå®šæœŸä»NameServerå–Topicè·¯ç”±ä¿¡æ¯ï¼Œå¹¶å‘æä¾›TopicæœåŠ¡çš„Masterã€Slaveå»ºç«‹é•¿è¿æ¥ï¼Œä¸”å®šæ—¶å‘Masterã€Slaveå‘é€å¿ƒè·³ã€‚Consumeræ—¢å¯ä»¥ä»Masterè®¢é˜…æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥ä»Slaveè®¢é˜…æ¶ˆæ¯ï¼Œè®¢é˜…è§„åˆ™ç”±Brokeré…ç½®å†³å®šã€‚\n\n### 3.2.3 é›†ç¾¤æ¨¡å¼\n\n#### 1ï¼‰å•Masteræ¨¡å¼\n\nè¿™ç§æ–¹å¼é£é™©è¾ƒå¤§ï¼Œä¸€æ—¦Brokeré‡å¯æˆ–è€…å®•æœºæ—¶ï¼Œä¼šå¯¼è‡´æ•´ä¸ªæœåŠ¡ä¸å¯ç”¨ã€‚ä¸å»ºè®®çº¿ä¸Šç¯å¢ƒä½¿ç”¨,å¯ä»¥ç”¨äºæœ¬åœ°æµ‹è¯•ã€‚\n\n#### 2ï¼‰å¤šMasteræ¨¡å¼\n\nä¸€ä¸ªé›†ç¾¤æ— Slaveï¼Œå…¨æ˜¯Masterï¼Œä¾‹å¦‚2ä¸ªMasteræˆ–è€…3ä¸ªMasterï¼Œè¿™ç§æ¨¡å¼çš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š\n\n- ä¼˜ç‚¹ï¼šé…ç½®ç®€å•ï¼Œå•ä¸ªMasterå®•æœºæˆ–é‡å¯ç»´æŠ¤å¯¹åº”ç”¨æ— å½±å“ï¼Œåœ¨ç£ç›˜é…ç½®ä¸ºRAID10æ—¶ï¼Œå³ä½¿æœºå™¨å®•æœºä¸å¯æ¢å¤æƒ…å†µä¸‹ï¼Œç”±äºRAID10ç£ç›˜éå¸¸å¯é ï¼Œæ¶ˆæ¯ä¹Ÿä¸ä¼šä¸¢ï¼ˆå¼‚æ­¥åˆ·ç›˜ä¸¢å¤±å°‘é‡æ¶ˆæ¯ï¼ŒåŒæ­¥åˆ·ç›˜ä¸€æ¡ä¸ä¸¢ï¼‰ï¼Œæ€§èƒ½æœ€é«˜ï¼›\n- ç¼ºç‚¹ï¼šå•å°æœºå™¨å®•æœºæœŸé—´ï¼Œè¿™å°æœºå™¨ä¸Šæœªè¢«æ¶ˆè´¹çš„æ¶ˆæ¯åœ¨æœºå™¨æ¢å¤ä¹‹å‰ä¸å¯è®¢é˜…ï¼Œæ¶ˆæ¯å®æ—¶æ€§ä¼šå—åˆ°å½±å“ã€‚\n\n#### 3ï¼‰å¤šMasterå¤šSlaveæ¨¡å¼ï¼ˆå¼‚æ­¥ï¼‰\n\næ¯ä¸ªMasteré…ç½®ä¸€ä¸ªSlaveï¼Œæœ‰å¤šå¯¹Master-Slaveï¼ŒHAé‡‡ç”¨å¼‚æ­¥å¤åˆ¶æ–¹å¼ï¼Œä¸»å¤‡æœ‰çŸ­æš‚æ¶ˆæ¯å»¶è¿Ÿï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œè¿™ç§æ¨¡å¼çš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š\n\n- ä¼˜ç‚¹ï¼šå³ä½¿ç£ç›˜æŸåï¼Œæ¶ˆæ¯ä¸¢å¤±çš„éå¸¸å°‘ï¼Œä¸”æ¶ˆæ¯å®æ—¶æ€§ä¸ä¼šå—å½±å“ï¼ŒåŒæ—¶Masterå®•æœºåï¼Œæ¶ˆè´¹è€…ä»ç„¶å¯ä»¥ä»Slaveæ¶ˆè´¹ï¼Œè€Œä¸”æ­¤è¿‡ç¨‹å¯¹åº”ç”¨é€æ˜ï¼Œä¸éœ€è¦äººå·¥å¹²é¢„ï¼Œæ€§èƒ½åŒå¤šMasteræ¨¡å¼å‡ ä¹ä¸€æ ·ï¼›\n- ç¼ºç‚¹ï¼šMasterå®•æœºï¼Œç£ç›˜æŸåæƒ…å†µä¸‹ä¼šä¸¢å¤±å°‘é‡æ¶ˆæ¯ã€‚\n\n#### 4ï¼‰å¤šMasterå¤šSlaveæ¨¡å¼ï¼ˆåŒæ­¥ï¼‰\n\næ¯ä¸ªMasteré…ç½®ä¸€ä¸ªSlaveï¼Œæœ‰å¤šå¯¹Master-Slaveï¼ŒHAé‡‡ç”¨åŒæ­¥åŒå†™æ–¹å¼ï¼Œå³åªæœ‰ä¸»å¤‡éƒ½å†™æˆåŠŸï¼Œæ‰å‘åº”ç”¨è¿”å›æˆåŠŸï¼Œè¿™ç§æ¨¡å¼çš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š\n\n- ä¼˜ç‚¹ï¼šæ•°æ®ä¸æœåŠ¡éƒ½æ— å•ç‚¹æ•…éšœï¼ŒMasterå®•æœºæƒ…å†µä¸‹ï¼Œæ¶ˆæ¯æ— å»¶è¿Ÿï¼ŒæœåŠ¡å¯ç”¨æ€§ä¸æ•°æ®å¯ç”¨æ€§éƒ½éå¸¸é«˜ï¼›\n- ç¼ºç‚¹ï¼šæ€§èƒ½æ¯”å¼‚æ­¥å¤åˆ¶æ¨¡å¼ç•¥ä½ï¼ˆå¤§çº¦ä½10%å·¦å³ï¼‰ï¼Œå‘é€å•ä¸ªæ¶ˆæ¯çš„RTä¼šç•¥é«˜ï¼Œä¸”ç›®å‰ç‰ˆæœ¬åœ¨ä¸»èŠ‚ç‚¹å®•æœºåï¼Œå¤‡æœºä¸èƒ½è‡ªåŠ¨åˆ‡æ¢ä¸ºä¸»æœºã€‚\n\n## 3.3 åŒä¸»åŒä»é›†ç¾¤æ­å»º\n\n### 3.3.1 æ€»ä½“æ¶æ„\n\næ¶ˆæ¯é«˜å¯ç”¨é‡‡ç”¨2m-2sï¼ˆåŒæ­¥åŒå†™ï¼‰æ–¹å¼\n\n![RocketMQé›†ç¾¤.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/YZ7lNk0quyaBeAQHZ2yzkzvz)\n\n### 3.3.2 é›†ç¾¤å·¥ä½œæµç¨‹\n\n1. å¯åŠ¨NameServerï¼ŒNameServerèµ·æ¥åç›‘å¬ç«¯å£ï¼Œç­‰å¾…Brokerã€Producerã€Consumerè¿ä¸Šæ¥ï¼Œç›¸å½“äºä¸€ä¸ªè·¯ç”±æ§åˆ¶ä¸­å¿ƒã€‚\n2. Brokerå¯åŠ¨ï¼Œè·Ÿæ‰€æœ‰çš„NameServerä¿æŒé•¿è¿æ¥ï¼Œå®šæ—¶å‘é€å¿ƒè·³åŒ…ã€‚å¿ƒè·³åŒ…ä¸­åŒ…å«å½“å‰Brokerä¿¡æ¯(IP+ç«¯å£ç­‰)ä»¥åŠå­˜å‚¨æ‰€æœ‰Topicä¿¡æ¯ã€‚æ³¨å†ŒæˆåŠŸåï¼ŒNameServeré›†ç¾¤ä¸­å°±æœ‰Topicè·ŸBrokerçš„æ˜ å°„å…³ç³»ã€‚\n3. æ”¶å‘æ¶ˆæ¯å‰ï¼Œå…ˆåˆ›å»ºTopicï¼Œåˆ›å»ºTopicæ—¶éœ€è¦æŒ‡å®šè¯¥Topicè¦å­˜å‚¨åœ¨å“ªäº›Brokerä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨å‘é€æ¶ˆæ¯æ—¶è‡ªåŠ¨åˆ›å»ºTopicã€‚\n4. Producerå‘é€æ¶ˆæ¯ï¼Œå¯åŠ¨æ—¶å…ˆè·ŸNameServeré›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€å°å»ºç«‹é•¿è¿æ¥ï¼Œå¹¶ä»NameServerä¸­è·å–å½“å‰å‘é€çš„Topicå­˜åœ¨å“ªäº›Brokerä¸Šï¼Œè½®è¯¢ä»é˜Ÿåˆ—åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªé˜Ÿåˆ—ï¼Œç„¶åä¸é˜Ÿåˆ—æ‰€åœ¨çš„Brokerå»ºç«‹é•¿è¿æ¥ä»è€Œå‘Brokerå‘æ¶ˆæ¯ã€‚\n5. Consumerè·ŸProducerç±»ä¼¼ï¼Œè·Ÿå…¶ä¸­ä¸€å°NameServerå»ºç«‹é•¿è¿æ¥ï¼Œè·å–å½“å‰è®¢é˜…Topicå­˜åœ¨å“ªäº›Brokerä¸Šï¼Œç„¶åç›´æ¥è·ŸBrokerå»ºç«‹è¿æ¥é€šé“ï¼Œå¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚\n\n### 3.3.3 æ­å»ºè¿‡ç¨‹\nè¿™é‡Œç®€å•æè¿°ä¸€ä¸‹ï¼ŒRocketMQçš„é›†ç¾¤æ­å»ºå…¶å®å¾ˆç®€å•ï¼Œå› ä¸ºæœ¬äººç”µè„‘é…ç½®åŸå› ï¼Œä¼ªé›†ç¾¤æ„ä¹‰ä¹Ÿä¸å¤§ï¼Œæ‰€ä»¥ä¸è¿›è¡Œè¿‡å¤šçš„ä»‹ç»ã€‚\n\n1. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯\n\nä¸»ï¼š\n```yml\n#æ‰€å±é›†ç¾¤åå­—\nbrokerClusterName=rocketmq-cluster\n#brokeråå­—ï¼Œæ³¨æ„æ­¤å¤„ä¸åŒçš„é…ç½®æ–‡ä»¶å¡«å†™çš„ä¸ä¸€æ ·\nbrokerName=broker-a\n#0 è¡¨ç¤º Masterï¼Œ>0 è¡¨ç¤º Slave\nbrokerId=0\n#nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²\n#éœ€è¦æŒ‡å®šå¤šä¸ªname-serverï¼Œç›¸å½“äºæ³¨å†Œåˆ°å¤šä¸ªæ³¨å†Œä¸­å¿ƒä¸Šå»\nnamesrvAddr=rocketmq-nameserver1:9876;rocketmq-nameserver2:9876\n```\n\nä»ï¼š\n```yml\n#æ‰€å±é›†ç¾¤åå­—\nbrokerClusterName=rocketmq-cluster\n#brokeråå­—ï¼Œæ³¨æ„æ­¤å¤„ä¸åŒçš„é…ç½®æ–‡ä»¶å¡«å†™çš„ä¸ä¸€æ ·\nbrokerName=broker-b\n#0 è¡¨ç¤º Masterï¼Œ>0 è¡¨ç¤º Slave\nbrokerId=1\n#nameServeråœ°å€ï¼Œåˆ†å·åˆ†å‰²\nnamesrvAddr=rocketmq-nameserver1:9876;rocketmq-nameserver2:9876\n```\nå…¶ä»–é…ç½®æ–‡ä»¶ä¹Ÿç±»ä¼¼å¤„ç†\n\n2. åœ¨å¯åŠ¨çš„æ—¶å€™ä¿®æ”¹docker-composeæ–‡ä»¶ï¼Œæ³¨æ„ä¿®æ”¹é…ç½®æ–‡ä»¶æ‰€å¤„çš„è·¯å¾„ï¼\n\n# 4. æ¶ˆæ¯å‘é€æ ·ä¾‹\n* åˆ›å»ºçˆ¶çº§ä¾èµ–ç®¡ç†\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.8.RELEASE</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>study</groupId>\n    <version>1.0.0-SNAPSHOT</version>\n    <name>dependencies</name>\n    <packaging>pom</packaging>\n    <modules>\n        <module>simple</module>\n    </modules>\n    <artifactId>RocketMQ</artifactId>\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>Greenwich.SR1</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n            <dependency>\n                <groupId>com.alibaba.cloud</groupId>\n                <artifactId>spring-cloud-alibaba-dependencies</artifactId>\n                <version>2.1.0.RELEASE</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n    <dependencies>\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.alibaba.cloud</groupId>\n            <artifactId>spring-cloud-starter-stream-rocketmq</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n    </dependencies>\n</project>\n\n```\n\n* åˆ›å»ºsimpleåŒ…å¼€å§‹æµ‹è¯•\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <parent>\n        <groupId>study</groupId>\n        <artifactId>RocketMQ</artifactId>\n        <version>1.0.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>simple</artifactId>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n            <scope>provided</scope>\n        </dependency>\n        <dependency>\n            <groupId>com.alibaba.cloud</groupId>\n            <artifactId>spring-cloud-starter-stream-rocketmq</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n            <scope>provided</scope>\n        </dependency>\n    </dependencies>\n</project>\n\n```\n\n* æ¶ˆæ¯å‘é€è€…æ­¥éª¤åˆ†ær\n\n```tex\n1.åˆ›å»ºæ¶ˆæ¯ç”Ÿäº§è€…producerï¼Œå¹¶åˆ¶å®šç”Ÿäº§è€…ç»„å\n2.æŒ‡å®šNameserveråœ°å€\n3.å¯åŠ¨producer\n4.åˆ›å»ºæ¶ˆæ¯å¯¹è±¡ï¼ŒæŒ‡å®šä¸»é¢˜Topicã€Tagå’Œæ¶ˆæ¯ä½“\n5.å‘é€æ¶ˆæ¯\n6.å…³é—­ç”Ÿäº§è€…producer\n```\n\n* æ¶ˆæ¯æ¶ˆè´¹è€…æ­¥éª¤åˆ†æ\n\n```tex\n1.åˆ›å»ºæ¶ˆè´¹è€…Consumerï¼Œåˆ¶å®šæ¶ˆè´¹è€…ç»„å\n2.æŒ‡å®šNameserveråœ°å€\n3.è®¢é˜…ä¸»é¢˜Topicå’ŒTag\n4.è®¾ç½®å›è°ƒå‡½æ•°ï¼Œå¤„ç†æ¶ˆæ¯\n5.å¯åŠ¨æ¶ˆè´¹è€…consumer\n```\n\n## 4.1 åŸºæœ¬æ ·ä¾‹\n\n### 4.1.1 æ¶ˆæ¯å‘é€\n\n#### 1ï¼‰å‘é€åŒæ­¥æ¶ˆæ¯\n\nè¿™ç§å¯é æ€§åŒæ­¥åœ°å‘é€æ–¹å¼ä½¿ç”¨çš„æ¯”è¾ƒå¹¿æ³›ï¼Œæ¯”å¦‚ï¼šé‡è¦çš„æ¶ˆæ¯é€šçŸ¥ï¼ŒçŸ­ä¿¡é€šçŸ¥ã€‚\n\n```java\n/**\n * @author Tiger\n * @date 2019-12-23\n * @see com.study.demo.sendMessage\n **/\npublic class SyncProducer {\n    /**\n     * å‘é€åŒæ­¥æ¶ˆæ¯ï¼šè¿™ç§æ–¹å¼åœ¨å‘é€æ¶ˆæ¯ä¹‹åéœ€è¦ç­‰å¾…brokerè¿”å›å‘é€çš„ç»“æœï¼Œå› æ­¤ä¼šæ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯å¯ä»¥ä¿è¯å¯é æ€§\n     * @param args args\n     * @throws Exception e\n     */\n    public static void main(String[] args) throws Exception {\n        // å®ä¾‹åŒ–æ¶ˆæ¯ç”Ÿäº§è€…Producer\n        DefaultMQProducer producer = new DefaultMQProducer(\"syncProducer\");\n        // è®¾ç½®NameServerçš„åœ°å€\n        producer.setNamesrvAddr(\"my.service.com:9876\");\n        // å¯åŠ¨Producerå®ä¾‹\n        producer.start();\n        for (int i = 0; i < 100; i++) {\n            // åˆ›å»ºæ¶ˆæ¯ï¼Œå¹¶æŒ‡å®šTopicï¼ŒTagå’Œæ¶ˆæ¯ä½“\n            Message msg = new Message(\"SyncProducer\" ,\"TagA\" ,(\"Hello RocketMQ \" + i).getBytes(RemotingHelper.DEFAULT_CHARSET));\n            // å‘é€æ¶ˆæ¯åˆ°ä¸€ä¸ªBroker\n            SendResult sendResult = producer.send(msg);\n            // é€šè¿‡sendResultè¿”å›æ¶ˆæ¯æ˜¯å¦æˆåŠŸé€è¾¾\n            System.out.printf(\"%s%n\", sendResult);\n        }\n        // å¦‚æœä¸å†å‘é€æ¶ˆæ¯ï¼Œå…³é—­Producerå®ä¾‹ã€‚\n        producer.shutdown();\n    }\n}\n```\n\n#### 2ï¼‰å‘é€å¼‚æ­¥æ¶ˆæ¯\n\nå¼‚æ­¥æ¶ˆæ¯é€šå¸¸ç”¨åœ¨å¯¹å“åº”æ—¶é—´æ•æ„Ÿçš„ä¸šåŠ¡åœºæ™¯ï¼Œå³å‘é€ç«¯ä¸èƒ½å®¹å¿é•¿æ—¶é—´åœ°ç­‰å¾…Brokerçš„å“åº”ã€‚\n\n```java\n/**\n * @author Tiger\n * @date 2019-12-23\n * @see com.study.demo.sendMessage\n **/\npublic class AsyncProducer {\n    public static void main(String[] args) throws Exception {\n        // å®ä¾‹åŒ–æ¶ˆæ¯ç”Ÿäº§è€…Producer\n        DefaultMQProducer producer = new DefaultMQProducer(\"syncProducer\");\n        // è®¾ç½®NameServerçš„åœ°å€\n        producer.setNamesrvAddr(\"my.service.com:9876\");\n        // å¯åŠ¨Producerå®ä¾‹\n        producer.start();\n//        producer.setRetryTimesWhenSendAsyncFailed(0);\n        for (int i = 0; i < 10; i++) {\n            final int index = i;\n            // åˆ›å»ºæ¶ˆæ¯ï¼Œå¹¶æŒ‡å®šTopicï¼ŒTagå’Œæ¶ˆæ¯ä½“\n            Message msg = new Message(\"AsyncProducer\", \"TagA\", \"OrderID188\", \"Hello world\".getBytes(RemotingHelper.DEFAULT_CHARSET));\n            // SendCallbackæ¥æ”¶å¼‚æ­¥è¿”å›ç»“æœçš„å›è°ƒ\n            producer.send(msg, new SendCallback() {\n                @Override\n                public void onSuccess(SendResult sendResult) {\n                    System.out.printf(\"%-10d OK %s %n\", index,\n                            sendResult.getMsgId());\n                }\n                @Override\n                public void onException(Throwable e) {\n                    System.out.printf(\"%-10d Exception %s %n\", index, e);\n                    e.printStackTrace();\n                }\n            });\n        }\n        // è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œç”±äºä½¿ç”¨äº†å¼‚æ­¥ï¼Œè¿™ä¹ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´è¿æ¥å·²ç»shutdownäº†æ‰è¿”å›å¼‚æ­¥ç»“æœï¼Œè¿™æ ·ä¼šæŠ¥é”™ï¼Œå› æ­¤åªèƒ½æ‰‹åŠ¨å…³é—­\n//        producer.shutdown();\n    }\n}\n```\n\n#### 3ï¼‰å•å‘å‘é€æ¶ˆæ¯\n\nè¿™ç§æ–¹å¼ä¸»è¦ç”¨åœ¨ä¸ç‰¹åˆ«å…³å¿ƒå‘é€ç»“æœçš„åœºæ™¯ï¼Œä¾‹å¦‚æ—¥å¿—å‘é€ã€‚\n\n```java\n/**\n * @author Tiger\n * @date 2019-12-23\n * @see com.study.demo.sendMessage\n **/\npublic class OnewayProducer {\n    public static void main(String[] args) throws Exception {\n        // å®ä¾‹åŒ–æ¶ˆæ¯ç”Ÿäº§è€…Producer\n        DefaultMQProducer producer = new DefaultMQProducer(\"onewayProducer\");\n        // è®¾ç½®NameServerçš„åœ°å€\n        producer.setNamesrvAddr(\"my.service.com:9876\");\n        // å¯åŠ¨Producerå®ä¾‹\n        producer.start();\n        for (int i = 0; i < 100; i++) {\n            // åˆ›å»ºæ¶ˆæ¯ï¼Œå¹¶æŒ‡å®šTopicï¼ŒTagå’Œæ¶ˆæ¯ä½“\n            Message msg = new Message(\"OnewayProducer\",\n                    \"TagA\",\n                    (\"Hello RocketMQ \" + i).getBytes(RemotingHelper.DEFAULT_CHARSET)\n            );\n            // å‘é€å•å‘æ¶ˆæ¯ï¼Œæ²¡æœ‰ä»»ä½•è¿”å›ç»“æœ\n            producer.sendOneway(msg);\n\n        }\n        // å¦‚æœä¸å†å‘é€æ¶ˆæ¯ï¼Œå…³é—­Producerå®ä¾‹ã€‚\n        producer.shutdown();\n    }\n}\n```\n\n### 4.1.2 æ¶ˆè´¹æ¶ˆæ¯\n#### 1ï¼‰è´Ÿè½½å‡è¡¡æ¨¡å¼\n\næ¶ˆè´¹è€…é‡‡ç”¨è´Ÿè½½å‡è¡¡æ–¹å¼æ¶ˆè´¹æ¶ˆæ¯ï¼Œå¤šä¸ªæ¶ˆè´¹è€…å…±åŒæ¶ˆè´¹é˜Ÿåˆ—æ¶ˆæ¯ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…å¤„ç†çš„æ¶ˆæ¯ä¸åŒ\n\n```java\n/**\n * @author Tiger\n * @date 2019-12-23\n * @see com.study.demo.getMessage\n **/\npublic class Balance {\n    public static void main(String[] args) throws Exception {\n        // å®ä¾‹åŒ–æ¶ˆæ¯ç”Ÿäº§è€…,æŒ‡å®šç»„å\n        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(\"syncProducer\");\n        // æŒ‡å®šNamesrvåœ°å€ä¿¡æ¯.\n        consumer.setNamesrvAddr(\"my.service.com:9876\");\n        // è®¢é˜…Topic\n        consumer.subscribe(\"AsyncProducer\", \"*\");\n        //è´Ÿè½½å‡è¡¡æ¨¡å¼æ¶ˆè´¹\n        consumer.setMessageModel(MessageModel.CLUSTERING);\n        // æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå¤„ç†æ¶ˆæ¯\n        consumer.registerMessageListener(new MessageListenerConcurrently() {\n            @Override\n            public ConsumeConcurrentlyStatus consumeMessage(List<MessageExt> msgs,\n                                                            ConsumeConcurrentlyContext context) {\n                System.out.printf(\"%s Receive New Messages: %s %n\",\n                        Thread.currentThread().getName(), msgs);\n                return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n            }\n        });\n        //å¯åŠ¨æ¶ˆæ¯è€…\n        consumer.start();\n        System.out.printf(\"Consumer Started.%n\");\n    }\n}\n```\n\n#### 2ï¼‰å¹¿æ’­æ¨¡å¼\n\næ¶ˆè´¹è€…é‡‡ç”¨å¹¿æ’­çš„æ–¹å¼æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ¶ˆæ¯éƒ½æ˜¯ç›¸åŒçš„\n\n```java\n/**\n * @author Tiger\n * @date 2019-12-23\n * @see com.study.demo.getMessage\n **/\npublic class Broadcasting {\n    public static void main(String[] args) throws Exception {\n        // å®ä¾‹åŒ–æ¶ˆæ¯ç”Ÿäº§è€…,æŒ‡å®šç»„å\n        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(\"syncProducer\");\n        // æŒ‡å®šNamesrvåœ°å€ä¿¡æ¯.\n        consumer.setNamesrvAddr(\"my.service.com:9876\");\n        // è®¢é˜…Topic\n        consumer.subscribe(\"AsyncProducer\", \"*\");\n        //å¹¿æ’­æ¨¡å¼æ¶ˆè´¹\n        consumer.setMessageModel(MessageModel.BROADCASTING);\n        // æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå¤„ç†æ¶ˆæ¯\n        consumer.registerMessageListener(new MessageListenerConcurrently() {\n            @Override\n            public ConsumeConcurrentlyStatus consumeMessage(List<MessageExt> msgs,\n                                                            ConsumeConcurrentlyContext context) {\n                System.out.printf(\"%s Receive New Messages: %s %n\",\n                        Thread.currentThread().getName(), msgs);\n                return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n            }\n        });\n        //å¯åŠ¨æ¶ˆæ¯è€…\n        consumer.start();\n        System.out.printf(\"Consumer Started.%n\");\n    }\n}\n```\n\n## 4.2 é¡ºåºæ¶ˆæ¯\n\næ¶ˆæ¯æœ‰åºæŒ‡çš„æ˜¯å¯ä»¥æŒ‰ç…§æ¶ˆæ¯çš„å‘é€é¡ºåºæ¥æ¶ˆè´¹(FIFO)ã€‚RocketMQå¯ä»¥ä¸¥æ ¼çš„ä¿è¯æ¶ˆæ¯æœ‰åºï¼Œå¯ä»¥åˆ†ä¸ºåˆ†åŒºæœ‰åºæˆ–è€…å…¨å±€æœ‰åºã€‚\n\né¡ºåºæ¶ˆè´¹çš„åŸç†è§£æï¼Œåœ¨é»˜è®¤çš„æƒ…å†µä¸‹æ¶ˆæ¯å‘é€ä¼šé‡‡å–Round Robinè½®è¯¢æ–¹å¼æŠŠæ¶ˆæ¯å‘é€åˆ°ä¸åŒçš„queue(åˆ†åŒºé˜Ÿåˆ—)ï¼›è€Œæ¶ˆè´¹æ¶ˆæ¯çš„æ—¶å€™ä»å¤šä¸ªqueueä¸Šæ‹‰å–æ¶ˆæ¯ï¼Œè¿™ç§æƒ…å†µå‘é€å’Œæ¶ˆè´¹æ˜¯ä¸èƒ½ä¿è¯é¡ºåºã€‚ä½†æ˜¯å¦‚æœæ§åˆ¶å‘é€çš„é¡ºåºæ¶ˆæ¯åªä¾æ¬¡å‘é€åˆ°åŒä¸€ä¸ªqueueä¸­ï¼Œæ¶ˆè´¹çš„æ—¶å€™åªä»è¿™ä¸ªqueueä¸Šä¾æ¬¡æ‹‰å–ï¼Œåˆ™å°±ä¿è¯äº†é¡ºåºã€‚å½“å‘é€å’Œæ¶ˆè´¹å‚ä¸çš„queueåªæœ‰ä¸€ä¸ªï¼Œåˆ™æ˜¯å…¨å±€æœ‰åºï¼›å¦‚æœå¤šä¸ªqueueå‚ä¸ï¼Œåˆ™ä¸ºåˆ†åŒºæœ‰åºï¼Œå³ç›¸å¯¹æ¯ä¸ªqueueï¼Œæ¶ˆæ¯éƒ½æ˜¯æœ‰åºçš„ã€‚\n\nä¸‹é¢ç”¨è®¢å•è¿›è¡Œåˆ†åŒºæœ‰åºçš„ç¤ºä¾‹ã€‚ä¸€ä¸ªè®¢å•çš„é¡ºåºæµç¨‹æ˜¯ï¼šåˆ›å»ºã€ä»˜æ¬¾ã€æ¨é€ã€å®Œæˆã€‚è®¢å•å·ç›¸åŒçš„æ¶ˆæ¯ä¼šè¢«å…ˆåå‘é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œæ¶ˆè´¹æ—¶ï¼ŒåŒä¸€ä¸ªOrderIdè·å–åˆ°çš„è‚¯å®šæ˜¯åŒä¸€ä¸ªé˜Ÿåˆ—ã€‚\n\n### 4.2.1 é¡ºåºæ¶ˆæ¯ç”Ÿäº§\n\n```java\n/**\n* Producerï¼Œå‘é€é¡ºåºæ¶ˆæ¯\n*/\npublic class OrderProducer {\n\n    public static void main(String[] args) throws Exception {\n        DefaultMQProducer producer = new DefaultMQProducer(\"orderProducer\");\n\n        producer.setNamesrvAddr(\"my.service.com:9876\");\n\n        producer.start();\n\n        String[] tags = new String[]{\"TagA\", \"TagC\", \"TagD\"};\n\n        // è®¢å•åˆ—è¡¨\n        List<OrderStep> orderList = new OrderProducer().buildOrders();\n\n        Date date = new Date();\n        SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n        String dateStr = sdf.format(date);\n        for (int i = 0; i < 10; i++) {\n            // åŠ ä¸ªæ—¶é—´å‰ç¼€\n            String body = dateStr + \" Hello RocketMQ \" + orderList.get(i);\n            Message msg = new Message(\"TopicTest\", tags[i % tags.length], \"KEY\" + i, body.getBytes());\n\n            SendResult sendResult = producer.send(msg, (mqs, msg1, arg) -> {\n                Long id = (Long) arg;  //æ ¹æ®è®¢å•idé€‰æ‹©å‘é€queue\n                long index = id % mqs.size();\n                return mqs.get((int) index);\n            }, orderList.get(i).getOrderId());//è®¢å•id\n\n//            SendResult sendResult = producer.send(msg, new MessageQueueSelector() {\n//                @Override\n//                public MessageQueue select(List<MessageQueue> mqs, Message msg, Object arg) {\n//                    Long id = (Long) arg;  //æ ¹æ®è®¢å•idé€‰æ‹©å‘é€queue\n//                    long index = id % mqs.size();\n//                    return mqs.get((int) index);\n//                }\n//            }, orderList.get(i).getOrderId());//è®¢å•id\n\n            System.out.println(String.format(\"SendResult status:%s, queueId:%d, body:%s\",\n                    sendResult.getSendStatus(),\n                    sendResult.getMessageQueue().getQueueId(),\n                    body));\n        }\n\n        producer.shutdown();\n    }\n\n    /**\n     * ç”Ÿæˆæ¨¡æ‹Ÿè®¢å•æ•°æ®\n     */\n    private List<OrderStep> buildOrders() {\n        List<OrderStep> orderList = new ArrayList<OrderStep>();\n\n        OrderStep orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc(\"åˆ›å»º\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111065L);\n        orderDemo.setDesc(\"åˆ›å»º\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc(\"ä»˜æ¬¾\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103117235L);\n        orderDemo.setDesc(\"åˆ›å»º\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111065L);\n        orderDemo.setDesc(\"ä»˜æ¬¾\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103117235L);\n        orderDemo.setDesc(\"ä»˜æ¬¾\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111065L);\n        orderDemo.setDesc(\"å®Œæˆ\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc(\"æ¨é€\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103117235L);\n        orderDemo.setDesc(\"å®Œæˆ\");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc(\"å®Œæˆ\");\n        orderList.add(orderDemo);\n\n        return orderList;\n    }\n\n}\n\n@Data\npublic class OrderStep {\n    private long orderId;\n    private String desc;\n\n    @Override\n    public String toString() {\n        return \"OrderStep{\" +\n                \"orderId=\" + orderId +\n                \", desc=\'\" + desc + \'\\\'\' +\n                \'}\';\n    }\n}\n```\n\n### 4.2.2 é¡ºåºæ¶ˆè´¹æ¶ˆæ¯\n\n```java\n/**\n* é¡ºåºæ¶ˆæ¯æ¶ˆè´¹ï¼Œå¸¦äº‹åŠ¡æ–¹å¼ï¼ˆåº”ç”¨å¯æ§åˆ¶Offsetä»€ä¹ˆæ—¶å€™æäº¤ï¼‰\n*/\npublic class ConsumerInOrder {\n\n   public static void main(String[] args) throws Exception {\n       DefaultMQPushConsumer consumer = new \n           DefaultMQPushConsumer(\"please_rename_unique_group_name_3\");\n       consumer.setNamesrvAddr(\"127.0.0.1:9876\");\n       /**\n        * è®¾ç½®Consumerç¬¬ä¸€æ¬¡å¯åŠ¨æ˜¯ä»é˜Ÿåˆ—å¤´éƒ¨å¼€å§‹æ¶ˆè´¹è¿˜æ˜¯é˜Ÿåˆ—å°¾éƒ¨å¼€å§‹æ¶ˆè´¹<br>\n        * å¦‚æœéç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œé‚£ä¹ˆæŒ‰ç…§ä¸Šæ¬¡æ¶ˆè´¹çš„ä½ç½®ç»§ç»­æ¶ˆè´¹\n        */\n       consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);\n\n       consumer.subscribe(\"TopicTest\", \"TagA || TagC || TagD\");\n\n       consumer.registerMessageListener(new MessageListenerOrderly() {\n\n           Random random = new Random();\n\n           @Override\n           public ConsumeOrderlyStatus consumeMessage(List<MessageExt> msgs, ConsumeOrderlyContext context) {\n               context.setAutoCommit(true);\n               for (MessageExt msg : msgs) {\n                   // å¯ä»¥çœ‹åˆ°æ¯ä¸ªqueueæœ‰å”¯ä¸€çš„consumeçº¿ç¨‹æ¥æ¶ˆè´¹, è®¢å•å¯¹æ¯ä¸ªqueue(åˆ†åŒº)æœ‰åº\n                   System.out.println(\"consumeThread=\" + Thread.currentThread().getName() + \"queueId=\" + msg.getQueueId() + \", content:\" + new String(msg.getBody()));\n               }\n\n               try {\n                   //æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘å¤„ç†ä¸­...\n                   TimeUnit.SECONDS.sleep(random.nextInt(10));\n               } catch (Exception e) {\n                   e.printStackTrace();\n               }\n               return ConsumeOrderlyStatus.SUCCESS;\n           }\n       });\n\n       consumer.start();\n\n       System.out.println(\"Consumer Started.\");\n   }\n}\n```\n\n## 4.3 å»¶æ—¶æ¶ˆæ¯\n\næ¯”å¦‚ç”µå•†é‡Œï¼Œæäº¤äº†ä¸€ä¸ªè®¢å•å°±å¯ä»¥å‘é€ä¸€ä¸ªå»¶æ—¶æ¶ˆæ¯ï¼Œ1håå»æ£€æŸ¥è¿™ä¸ªè®¢å•çš„çŠ¶æ€ï¼Œå¦‚æœè¿˜æ˜¯æœªä»˜æ¬¾å°±å–æ¶ˆè®¢å•é‡Šæ”¾åº“å­˜ã€‚\n\n### 4.3.1 å¯åŠ¨æ¶ˆæ¯æ¶ˆè´¹è€…\n\n```java\npublic class ScheduledMessageConsumer {\n   public static void main(String[] args) throws Exception {\n      // å®ä¾‹åŒ–æ¶ˆè´¹è€…\n      DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(\"ExampleConsumer\");\n      // è®¢é˜…Topics\n      consumer.subscribe(\"TestTopic\", \"*\");\n      // æ³¨å†Œæ¶ˆæ¯ç›‘å¬è€…\n      consumer.registerMessageListener(new MessageListenerConcurrently() {\n          @Override\n          public ConsumeConcurrentlyStatus consumeMessage(List<MessageExt> messages, ConsumeConcurrentlyContext context) {\n              for (MessageExt message : messages) {\n                  // Print approximate delay time period\n                  System.out.println(\"Receive message[msgId=\" + message.getMsgId() + \"] \" + (System.currentTimeMillis() - message.getStoreTimestamp()) + \"ms later\");\n              }\n              return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n          }\n      });\n      // å¯åŠ¨æ¶ˆè´¹è€…\n      consumer.start();\n  }\n}\n```\n\n### 4.3.2 å‘é€å»¶æ—¶æ¶ˆæ¯\n\n```java\n/**\n * @author Tiger\n * @date 2019-12-24\n * @see com.study.demo.sendMessage\n **/\npublic class ScheduledMessageProducer {\n    /**\n     * å‘é€å»¶æ—¶æ¶ˆæ¯\n     * @param args a\n     * @throws Exception e\n     */\n    public static void main(String[] args) throws Exception {\n        // å®ä¾‹åŒ–ä¸€ä¸ªç”Ÿäº§è€…æ¥äº§ç”Ÿå»¶æ—¶æ¶ˆæ¯\n        DefaultMQProducer producer = new DefaultMQProducer(\"ExampleProducerGroup\");\n        producer.setNamesrvAddr(\"my.service.com:9876\");\n        // å¯åŠ¨ç”Ÿäº§è€…\n        producer.start();\n        int totalMessagesToSend = 100;\n        for (int i = 0; i < totalMessagesToSend; i++) {\n            Message message = new Message(\"TestTopic\", (\"Hello scheduled message \" + i).getBytes());\n            // è®¾ç½®å»¶æ—¶ç­‰çº§2,è¿™ä¸ªæ¶ˆæ¯å°†åœ¨5sä¹‹åå‘é€(ç°åœ¨åªæ”¯æŒå›ºå®šçš„å‡ ä¸ªæ—¶é—´,è¯¦çœ‹delayTimeLevel)\n            message.setDelayTimeLevel(2);\n            // å‘é€æ¶ˆæ¯\n            producer.send(message);\n        }\n        // å…³é—­ç”Ÿäº§è€…\n        producer.shutdown();\n    }\n}\n```\n\n### 4.3.3 éªŒè¯\n\næ‚¨å°†ä¼šçœ‹åˆ°æ¶ˆæ¯çš„æ¶ˆè´¹æ¯”å­˜å‚¨æ—¶é—´æ™š10ç§’\n\n### 4.3.4 ä½¿ç”¨é™åˆ¶\n\n```java\n// org/apache/rocketmq/store/config/MessageStoreConfig.java\nprivate String messageDelayLevel = \"1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2h\";\n```\n\nç°åœ¨RocketMqå¹¶ä¸æ”¯æŒä»»æ„æ—¶é—´çš„å»¶æ—¶ï¼Œéœ€è¦è®¾ç½®å‡ ä¸ªå›ºå®šçš„å»¶æ—¶ç­‰çº§ï¼Œä»1såˆ°2håˆ†åˆ«å¯¹åº”ç€ç­‰çº§1åˆ°18\n\n## 4.4 æ‰¹é‡æ¶ˆæ¯\n\næ‰¹é‡å‘é€æ¶ˆæ¯èƒ½æ˜¾è‘—æé«˜ä¼ é€’å°æ¶ˆæ¯çš„æ€§èƒ½ã€‚é™åˆ¶æ˜¯è¿™äº›æ‰¹é‡æ¶ˆæ¯åº”è¯¥æœ‰ç›¸åŒçš„topicï¼Œç›¸åŒçš„waitStoreMsgOKï¼Œè€Œä¸”ä¸èƒ½æ˜¯å»¶æ—¶æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œè¿™ä¸€æ‰¹æ¶ˆæ¯çš„æ€»å¤§å°ä¸åº”è¶…è¿‡4MBã€‚\n\n### 4.4.1 å‘é€æ‰¹é‡æ¶ˆæ¯\n\nå¦‚æœæ‚¨æ¯æ¬¡åªå‘é€ä¸è¶…è¿‡4MBçš„æ¶ˆæ¯ï¼Œåˆ™å¾ˆå®¹æ˜“ä½¿ç”¨æ‰¹å¤„ç†ï¼Œæ ·ä¾‹å¦‚ä¸‹ï¼š\n\n```java\nString topic = \"BatchTest\";\nList<Message> messages = new ArrayList<>();\nmessages.add(new Message(topic, \"TagA\", \"OrderID001\", \"Hello world 0\".getBytes()));\nmessages.add(new Message(topic, \"TagA\", \"OrderID002\", \"Hello world 1\".getBytes()));\nmessages.add(new Message(topic, \"TagA\", \"OrderID003\", \"Hello world 2\".getBytes()));\ntry {\n   producer.send(messages);\n} catch (Exception e) {\n   e.printStackTrace();\n   //å¤„ç†error\n}\n```\n\nå¦‚æœæ¶ˆæ¯çš„æ€»é•¿åº¦å¯èƒ½å¤§äº4MBæ—¶ï¼Œè¿™æ—¶å€™æœ€å¥½æŠŠæ¶ˆæ¯è¿›è¡Œåˆ†å‰²\n\n```java\npublic class ListSplitter implements Iterator<List<Message>> {\n   private final int SIZE_LIMIT = 1024 * 1024 * 4;\n   private final List<Message> messages;\n   private int currIndex;\n   public ListSplitter(List<Message> messages) {\n           this.messages = messages;\n   }\n    @Override \n    public boolean hasNext() {\n       return currIndex < messages.size();\n   }\n   	@Override \n    public List<Message> next() {\n       int nextIndex = currIndex;\n       int totalSize = 0;\n       for (; nextIndex < messages.size(); nextIndex++) {\n           Message message = messages.get(nextIndex);\n           int tmpSize = message.getTopic().length() + message.getBody().length;\n           Map<String, String> properties = message.getProperties();\n           for (Map.Entry<String, String> entry : properties.entrySet()) {\n               tmpSize += entry.getKey().length() + entry.getValue().length();\n           }\n           tmpSize = tmpSize + 20; // å¢åŠ æ—¥å¿—çš„å¼€é”€20å­—èŠ‚\n           if (tmpSize > SIZE_LIMIT) {\n               //å•ä¸ªæ¶ˆæ¯è¶…è¿‡äº†æœ€å¤§çš„é™åˆ¶\n               //å¿½ç•¥,å¦åˆ™ä¼šé˜»å¡åˆ†è£‚çš„è¿›ç¨‹\n               if (nextIndex - currIndex == 0) {\n                  //å‡å¦‚ä¸‹ä¸€ä¸ªå­åˆ—è¡¨æ²¡æœ‰å…ƒç´ ,åˆ™æ·»åŠ è¿™ä¸ªå­åˆ—è¡¨ç„¶åé€€å‡ºå¾ªç¯,å¦åˆ™åªæ˜¯é€€å‡ºå¾ªç¯\n                  nextIndex++;\n               }\n               break;\n           }\n           if (tmpSize + totalSize > SIZE_LIMIT) {\n               break;\n           } else {\n               totalSize += tmpSize;\n           }\n\n       }\n       List<Message> subList = messages.subList(currIndex, nextIndex);\n       currIndex = nextIndex;\n       return subList;\n   }\n}\n//æŠŠå¤§çš„æ¶ˆæ¯åˆ†è£‚æˆè‹¥å¹²ä¸ªå°çš„æ¶ˆæ¯\nListSplitter splitter = new ListSplitter(messages);\nwhile (splitter.hasNext()) {\n  try {\n      List<Message>  listItem = splitter.next();\n      producer.send(listItem);\n  } catch (Exception e) {\n      e.printStackTrace();\n      //å¤„ç†error\n  }\n}\n```\n\n## 4.5 è¿‡æ»¤æ¶ˆæ¯\n\nåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒTAGæ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰ç”¨çš„è®¾è®¡ï¼Œå…¶å¯ä»¥æ¥é€‰æ‹©æ‚¨æƒ³è¦çš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼š\n\n```java\nDefaultMQPushConsumer consumer = new DefaultMQPushConsumer(\"CID_EXAMPLE\");\nconsumer.subscribe(\"TOPIC\", \"TAGA || TAGB || TAGC\");\n```\n\næ¶ˆè´¹è€…å°†æ¥æ”¶åŒ…å«TAGAæˆ–TAGBæˆ–TAGCçš„æ¶ˆæ¯ã€‚ä½†æ˜¯é™åˆ¶æ˜¯ä¸€ä¸ªæ¶ˆæ¯åªèƒ½æœ‰ä¸€ä¸ªæ ‡ç­¾ï¼Œè¿™å¯¹äºå¤æ‚çš„åœºæ™¯å¯èƒ½ä¸èµ·ä½œç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨SQLè¡¨è¾¾å¼ç­›é€‰æ¶ˆæ¯ã€‚SQLç‰¹æ€§å¯ä»¥é€šè¿‡å‘é€æ¶ˆæ¯æ—¶çš„å±æ€§æ¥è¿›è¡Œè®¡ç®—ã€‚åœ¨RocketMQå®šä¹‰çš„è¯­æ³•ä¸‹ï¼Œå¯ä»¥å®ç°ä¸€äº›ç®€å•çš„é€»è¾‘ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š\n\n```te\n------------\n| message  |\n|----------|  a > 5 AND b = \'abc\'\n| a = 10   |  --------------------> Gotten\n| b = \'abc\'|\n| c = true |\n------------\n------------\n| message  |\n|----------|   a > 5 AND b = \'abc\'\n| a = 1    |  --------------------> Missed\n| b = \'abc\'|\n| c = true |\n------------\n```\n\n### 4.5.1 SQLåŸºæœ¬è¯­æ³•\n\nRocketMQåªå®šä¹‰äº†ä¸€äº›åŸºæœ¬è¯­æ³•æ¥æ”¯æŒè¿™ä¸ªç‰¹æ€§ã€‚ä½ ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰©å±•å®ƒã€‚\n\n* æ•°å€¼æ¯”è¾ƒï¼Œæ¯”å¦‚ï¼š**>ï¼Œ>=ï¼Œ<ï¼Œ<=ï¼ŒBETWEENï¼Œ=ï¼›**\n* å­—ç¬¦æ¯”è¾ƒï¼Œæ¯”å¦‚ï¼š**=ï¼Œ<>ï¼ŒINï¼›**\n* **IS NULL** æˆ–è€… **IS NOT NULLï¼›**\n* é€»è¾‘ç¬¦å· **ANDï¼ŒORï¼ŒNOTï¼›**\n\nå¸¸é‡æ”¯æŒç±»å‹ä¸ºï¼š\n\n* æ•°å€¼ï¼Œæ¯”å¦‚ï¼š**123ï¼Œ3.1415ï¼›**\n* å­—ç¬¦ï¼Œæ¯”å¦‚ï¼š**\'abc\'ï¼Œå¿…é¡»ç”¨å•å¼•å·åŒ…è£¹èµ·æ¥ï¼›**\n* **NULL**ï¼Œç‰¹æ®Šçš„å¸¸é‡\n* å¸ƒå°”å€¼ï¼Œ**TRUE** æˆ– **FALSE**\n\nåªæœ‰ä½¿ç”¨pushæ¨¡å¼çš„æ¶ˆè´¹è€…æ‰èƒ½ç”¨ä½¿ç”¨SQL92æ ‡å‡†çš„sqlè¯­å¥ï¼Œæ¥å£å¦‚ä¸‹ï¼š\n\n```java\npublic void subscribe(finalString topic, final MessageSelector messageSelector)\n```\n\n### 4.5.2 æ¶ˆæ¯ç”Ÿäº§è€…\n\nå‘é€æ¶ˆæ¯æ—¶ï¼Œä½ èƒ½é€šè¿‡`putUserProperty`æ¥è®¾ç½®æ¶ˆæ¯çš„å±æ€§\n\n```java\nDefaultMQProducer producer = new DefaultMQProducer(\"please_rename_unique_group_name\");\nproducer.start();\nMessage msg = new Message(\"TopicTest\",\n   tag,\n   (\"Hello RocketMQ \" + i).getBytes(RemotingHelper.DEFAULT_CHARSET)\n);\n// è®¾ç½®ä¸€äº›å±æ€§\nmsg.putUserProperty(\"a\", String.valueOf(i));\nSendResult sendResult = producer.send(msg);\n\nproducer.shutdown();\n```\n\n### 4.5.3 æ¶ˆæ¯æ¶ˆè´¹è€…\n\nç”¨MessageSelector.bySqlæ¥ä½¿ç”¨sqlç­›é€‰æ¶ˆæ¯\n\n```java\nDefaultMQPushConsumer consumer = new DefaultMQPushConsumer(\"please_rename_unique_group_name_4\");\n// åªæœ‰è®¢é˜…çš„æ¶ˆæ¯æœ‰è¿™ä¸ªå±æ€§a, a >=0 and a <= 3\nconsumer.subscribe(\"TopicTest\", MessageSelector.bySql(\"a between 0 and 3\");\nconsumer.registerMessageListener(new MessageListenerConcurrently() {\n   @Override\n   public ConsumeConcurrentlyStatus consumeMessage(List<MessageExt> msgs, ConsumeConcurrentlyContext context) {\n       return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n   }\n});\nconsumer.start();\n```\n\n# 5. `spring-cloud-starter-stream-rocketmq`çš„ä½¿ç”¨\n## 5.1 åŸºæœ¬æ ·ä¾‹\n* åˆ›å»ºSpringCloudç»Ÿä¸€ä¾èµ–ç®¡ç†\n\n```xml\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>Greenwich.SR1</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n            <dependency>\n                <groupId>com.alibaba.cloud</groupId>\n                <artifactId>spring-cloud-alibaba-dependencies</artifactId>\n                <version>2.1.0.RELEASE</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n```\n\n* å­æ¨¡å—ä¸­åŠ å…¥rocketmqä¾èµ–\n\n```xml\n        <dependency>\n            <groupId>com.alibaba.cloud</groupId>\n            <artifactId>spring-cloud-starter-stream-rocketmq</artifactId>\n        </dependency>\n```\n\n* org.springframework.cloud.stream.config.BindingPropertiesæŸ¥çœ‹å¯é…ç½®çš„å±æ€§\n```java\n@JsonInclude(Include.NON_DEFAULT)\n@Validated\npublic class BindingProperties {\n    public static final MimeType DEFAULT_CONTENT_TYPE;\n    private static final String COMMA = \",\";\n    private String destination;\n    private String group;\n    private String contentType;\n    private String binder;\n    private ConsumerProperties consumer;\n    private ProducerProperties producer;\n    ...\n}\n```\n\n## 5.2 é…ç½®ç”Ÿäº§è€…\n* ç¼–å†™ç”Ÿäº§è€…é…ç½®æ–‡ä»¶\n```yml\nserver:\n  port: 9094\nspring:\n  application:\n    name: rocketmq-provider\n  cloud:\n    stream:\n      bindings:\n        output1:\n          content-type: text/plain\n          destination: TransactionTopic\n      rocketmq:\n        binder:\n          name-server: my.service.com:9876\n	#è‡ªå®šä¹‰çš„åç§° å¯¹åº”spring.cloud.stream.bindings.output1\n        bindings:\n          output1:\n            producer:\n              group: demo-group\n              transactional: true\n  datasource:\n    password: 123456\n    url: jdbc:mysql://my.service.com:3306/test?useUnicode=true&characterEncoding=UTF-8&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=GMT%2B8\n    username: root\n```\n\n* æŒ‡å®šå½“å‰MQä½¿ç”¨çš„é…ç½®\n```java\npublic interface MySource {\n    @Output(\"output1\")\n    MessageChannel output1();\n}\n``` \n\n* åœ¨`Application`ä¸­è¿›è¡Œç»‘å®š\n```\n@SpringBootApplication\n@EnableBinding(MySource.class)\npublic class ServerApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(ServerApplication.class, args);\n    }\n}\n```\n\n* è¿›å…¥ä½¿ç”¨\n```java\n    @Resource\n    MySource source;\n    public void send(String message) {\n        //tagsè¿‡æ»¤æ–¹æ³•\n	source.output1().send(MessageBuilder.withPayload(message).setHeader(RocketMQHeaders.TAGS,\"test\").build());\n        Random r = new Random();\n        //sqlè¿‡æ»¤æ–¹æ³•\n	source.output1().send(MessageBuilder.withPayload(message).setHeader(\"index\",r.nextInt(1000)+500).build());\n	//é»˜è®¤æ–¹æ³•\n	source.output1().send(MessageBuilder.withPayload(message).build());\n    }\n```\n\n* å¦‚ä½•ä½¿ç”¨äº‹åŠ¡æ–¹æ³•\nä¸Šé¢å†…å®¹ä¸éœ€è¦è¿›è¡Œå˜æ›´ï¼Œåªéœ€è¦åŠ å…¥ä»¥ä¸‹ç›‘å¬ç±»\n```java\n@RocketMQTransactionListener(txProducerGroup = \"demo-group\")\npublic class ProducerListener implements RocketMQLocalTransactionListener {\n\n    @Autowired\n    JdbcTemplate jdbcTemplate;\n\n    @Override\n    @Transactional\n    public RocketMQLocalTransactionState executeLocalTransaction(Message message, Object arg) {\n        //æ¶ˆæ¯å‘é€æˆåŠŸå›è°ƒæ­¤æ–¹æ³•ï¼Œæ­¤æ–¹æ³•æ‰§è¡Œæœ¬åœ°äº‹åŠ¡\n        try {\n            //è§£ææ¶ˆæ¯å†…å®¹\n            String jsonString = new String((byte[]) message.getPayload());\n            JSONObject jsonObject = JSONObject.parseObject(jsonString);\n            ...\n            return RocketMQLocalTransactionState.COMMIT;\n        } catch (Exception e) {\n            e.printStackTrace();\n            return RocketMQLocalTransactionState.ROLLBACK;\n        }\n    }\n\n    //æ­¤æ–¹æ³•æ£€æŸ¥äº‹åŠ¡æ‰§è¡ŒçŠ¶æ€\n    @Override\n    public RocketMQLocalTransactionState checkLocalTransaction(Message message) {\n        RocketMQLocalTransactionState state;\n        final JSONObject jsonObject = JSON.parseObject(new String((byte[]) message.getPayload()));\n        ...\n        System.out.println(\"check\");\n        System.out.println(jsonObject);\n	//è‡ªè¡Œå®šä¹‰è§„åˆ™ï¼Œå¦‚è¦éœ€è¦å®Œæ•´demoå¯ä»¥å‚è€ƒæˆ‘githubä»£ç \n        if (...) {\n	    //æäº¤äº‹åŠ¡\n            state = RocketMQLocalTransactionState.COMMIT;\n        } else {\n	    //ç¨åé‡è¯•\n            state = RocketMQLocalTransactionState.UNKNOWN;\n        }\n        return state;\n    }\n}\n```\n\n## 5.3 é…ç½®æ¶ˆè´¹è€…\n* ç¼–å†™æ¶ˆè´¹è€…é…ç½®æ–‡ä»¶\n```yml\nserver:\n  port: 9093\nspring:\n  application:\n    name: rocketmq-consumer\n  cloud:\n    stream:\n      bindings:\n        input:\n          consumer:\n#            æ¶ˆè´¹è€…çº¿ç¨‹æ•°è®¾ç½®\n            concurrency: 20\n          content-type: application/json\n          destination: TransactionTopic\n          group: demo-group\n      rocketmq:\n        binder:\n          name-server: my.service.com:9876\n        bindings:\n          input:\n            consumer:\n              broadcasting: false\n              sql: \'index >= 600\'\n              tags: tag0||tag1\n  datasource:\n    password: 123456\n    url: jdbc:mysql://my.service.com:3306/test?useUnicode=true&characterEncoding=UTF-8&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=GMT%2B8\n    username: root\n```\n\n* è¿™é‡Œæ²¡æœ‰ä½¿ç”¨è‡ªå®šä¹‰åç§°ï¼Œåªéœ€è¦åœ¨`Application`ä¸­ç»‘å®šé»˜è®¤è§„åˆ™å³å¯\n```java\n@SpringBootApplication\n@EnableBinding({Sink.class})\npublic class ConsumerApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(ConsumerApplication.class, args);\n    }\n}\n```\n\n* æ³¨å†Œæ¶ˆæ¯æ¶ˆè´¹è€…ç›‘å¬å™¨`@StreamListener(Sink.INPUT)`\n```\n    @StreamListener(Sink.INPUT)\n    //é»˜è®¤æœ‰ackæœºåˆ¶ï¼Œä¸æŠ›å‡ºå¼‚å¸¸å°±æ˜¯ç¡®è®¤æ¶ˆè´¹æˆåŠŸ\n    public void receive(String receiveMsg) {\n        try {\n            JSONObject jsonObject = JSONObject.parseObject(receiveMsg);\n            ...\n        } catch (Exception e) {\n            throw new RuntimeException();\n        }\n    }\n```');
INSERT INTO `blog_content` VALUES (50, '## é…ç½®æ–‡ä»¶å†…å®¹\n### 1ï¼‰å…¨å±€å—\n### 2ï¼‰eventså—\n### 3ï¼‰httpå—\n\n## åå‘ä»£ç†é…ç½®ä¾‹å­\n### 1ï¼‰å®Œæ•´æ¡ˆä¾‹\n```conf\n\n#è¿è¡Œç”¨æˆ·\n#user somebody;\n \n#å¯åŠ¨è¿›ç¨‹,é€šå¸¸è®¾ç½®æˆå’Œcpuçš„æ•°é‡ç›¸ç­‰\nworker_processes  1;\n \n#å…¨å±€é”™è¯¯æ—¥å¿—\nerror_log  D:/Tools/nginx-1.10.1/logs/error.log;\nerror_log  D:/Tools/nginx-1.10.1/logs/notice.log  notice;\nerror_log  D:/Tools/nginx-1.10.1/logs/info.log  info;\n \n#PIDæ–‡ä»¶ï¼Œè®°å½•å½“å‰å¯åŠ¨çš„nginxçš„è¿›ç¨‹ID\npid        D:/Tools/nginx-1.10.1/logs/nginx.pid;\n \n#å·¥ä½œæ¨¡å¼åŠè¿æ¥æ•°ä¸Šé™\nevents {\n    worker_connections 1024;    #å•ä¸ªåå°worker processè¿›ç¨‹çš„æœ€å¤§å¹¶å‘é“¾æ¥æ•°\n}\n \n#è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨å®ƒçš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ\nhttp {\n    #è®¾å®šmimeç±»å‹(é‚®ä»¶æ”¯æŒç±»å‹),ç±»å‹ç”±mime.typesæ–‡ä»¶å®šä¹‰\n    include       D:/Tools/nginx-1.10.1/conf/mime.types;\n    default_type  application/octet-stream;\n    \n    #è®¾å®šæ—¥å¿—\n    log_format  main  \'[$remote_addr] - [$remote_user] [$time_local] \"$request\" \'\n                      \'$status $body_bytes_sent \"$http_referer\" \'\n                      \'\"$http_user_agent\" \"$http_x_forwarded_for\"\';\n                      \n    access_log    D:/Tools/nginx-1.10.1/logs/access.log main;\n    rewrite_log     on;\n    \n    #sendfile æŒ‡ä»¤æŒ‡å®š nginx æ˜¯å¦è°ƒç”¨ sendfile å‡½æ•°ï¼ˆzero copy æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨ï¼Œ\n    #å¿…é¡»è®¾ä¸º on,å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸º offï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„uptime.\n    sendfile        on;\n    #tcp_nopush     on;\n \n    #è¿æ¥è¶…æ—¶æ—¶é—´\n    keepalive_timeout  120;\n    tcp_nodelay        on;\n    \n    #gzipå‹ç¼©å¼€å…³\n    #gzip  on;\n \n    #è®¾å®šå®é™…çš„æœåŠ¡å™¨åˆ—è¡¨ \n    upstream zp_server1{\n        server 127.0.0.1:8089;\n    }\n \n    #HTTPæœåŠ¡å™¨\n    server {\n        #ç›‘å¬80ç«¯å£ï¼Œ80ç«¯å£æ˜¯çŸ¥åç«¯å£å·ï¼Œç”¨äºHTTPåè®®\n        listen       80;\n        \n        #å®šä¹‰ä½¿ç”¨www.xx.comè®¿é—®\n        server_name  www.helloworld.com;\n        \n        #é¦–é¡µ\n        index index.html\n        \n        #æŒ‡å‘webappçš„ç›®å½•\n        root D:\\01_Workspace\\Project\\github\\zp\\SpringNotes\\spring-security\\spring-shiro\\src\\main\\webapp;\n        \n        #ç¼–ç æ ¼å¼\n        charset utf-8;\n        \n        #ä»£ç†é…ç½®å‚æ•°\n        proxy_connect_timeout 180;\n        proxy_send_timeout 180;\n        proxy_read_timeout 180;\n        proxy_set_header Host $host;\n        proxy_set_header X-Forwarder-For $remote_addr;\n \n        #åå‘ä»£ç†çš„è·¯å¾„ï¼ˆå’Œupstreamç»‘å®šï¼‰ï¼Œlocation åé¢è®¾ç½®æ˜ å°„çš„è·¯å¾„\n        location / {\n            proxy_pass http://zp_server1;\n        } \n \n        #é™æ€æ–‡ä»¶ï¼Œnginxè‡ªå·±å¤„ç†\n        location ~ ^/(images|javascript|js|css|flash|media|static)/ {\n            root D:\\01_Workspace\\Project\\github\\zp\\SpringNotes\\spring-security\\spring-shiro\\src\\main\\webapp\\views;\n            #è¿‡æœŸ30å¤©ï¼Œé™æ€æ–‡ä»¶ä¸æ€ä¹ˆæ›´æ–°ï¼Œè¿‡æœŸå¯ä»¥è®¾å¤§ä¸€ç‚¹ï¼Œå¦‚æœé¢‘ç¹æ›´æ–°ï¼Œåˆ™å¯ä»¥è®¾ç½®å¾—å°ä¸€ç‚¹ã€‚\n            expires 30d;\n        }\n    \n        #è®¾å®šæŸ¥çœ‹NginxçŠ¶æ€çš„åœ°å€\n        location /NginxStatus {\n            stub_status           on;\n            access_log            on;\n            auth_basic            \"NginxStatus\";\n            auth_basic_user_file  conf/htpasswd;\n        }\n    \n        #ç¦æ­¢è®¿é—® .htxxx æ–‡ä»¶\n        location ~ /\\.ht {\n            deny all;\n        }\n        \n        #é”™è¯¯å¤„ç†é¡µé¢ï¼ˆå¯é€‰æ‹©æ€§é…ç½®ï¼‰\n        #error_page   404              /404.html;\n        #error_page   500 502 503 504  /50x.html;\n        #location = /50x.html {\n        #    root   html;\n        #}\n    }\n}\n```\n\n[nginx ä¸­locationå’Œrootï¼Œä½ ç¡®å®šçœŸçš„æ˜ç™½ä»–ä»¬å…³ç³»ï¼Ÿ](https://blog.csdn.net/u011510825/article/details/50531864)\n\n### 2ï¼‰è´Ÿè½½å‡è¡¡çš„æ–¹å¼\n* è½®è¯¢ï¼ˆé»˜è®¤ï¼‰\n* weight\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/4nEwZfiav75zUEbOrvApBRum)\n* ip_hash\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/zTtri1gyhfo8dmqQ2mN9gIUF)\n* fair\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/dbFlxsvGYlEo9gWqe33VKlmO)\n\n## locationåŒ¹é…è§„åˆ™\n[nginxé…ç½®ä¸­locationåŒ¹é…è§„åˆ™è¯¦è§£](http://www.findme.wang/blog/detail/id/495.html)');
INSERT INTO `blog_content` VALUES (52, '## åºè¨€\nåœ¨æœ¬æ¬¡æœŸæœ«è®¾è®¡å½“ä¸­ï¼Œåº”ä¸ºéœ€è¦åšéƒ¨ç½²è„šæœ¬ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯dockerfile+docker-composeçš„éƒ¨ç½²æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å¯¹vueé¡¹ç›®æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºvueä¸‹è½½ä¾èµ–ä¸æ‰“åŒ…æ˜¯åˆ†ç¦»å¼€æ¥çš„ï¼Œå³ä½¿ä¿®æ”¹äº†ä»£ç ï¼Œåªè¦æ²¡æœ‰å®‰è£…æ–°çš„åŒ…éƒ½ä¸ä¼šé‡æ–°å»ä¸‹è½½åŒ…ã€‚è€Œåœ¨SpringBooté¡¹ç›®ä¸­ï¼Œä¹Ÿè®¸æ˜¯ä¸ªäººæŠ€æœ¯åŸå› ï¼Œæ²¡æœ‰æ‰¾åˆ°ä¸‹è½½ä¾èµ–ä¸æ‰“åŒ…åˆ†ç¦»å¼€çš„æ–¹æ³•ï¼Œå¯¼è‡´æ¯æ¬¡ä¿®æ”¹ä»£ç æ‰“åŒ…çš„æ—¶å€™éƒ½éœ€è¦ä¸‹è½½ä¸€å †çš„ä¸œè¥¿ï¼Œå¯¼è‡´è¿è¡Œæ—¶é•¿è¿‡é•¿ã€‚åœ¨å’¨è¯¢ä¸€äº›å¤§ä½¬åå¾—çŸ¥jibæ’ä»¶ã€‚\n\n## å‡†å¤‡å·¥ä½œ\nåœ¨é˜¿é‡Œäº‘çš„å®¹å™¨é•œåƒæœåŠ¡ä¸­åˆ›å»ºä¸¤ä¸ªé•œåƒä»“åº“ï¼Œä¸€ä¸ªç”¨äºéƒ¨ç½²ï¼Œä¸€ä¸ªç”¨äºåˆ›å»ºè‡ªå·±çš„jdké•œåƒï¼ˆä¸ç”¨åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ã€‚\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/fQbyPegsHqJ5LyJRG4tGtlce)\n\n### ä¸€ã€è®¾ç½®jdké•œåƒ\nåœ¨ç®¡ç†é•œåƒä¸­å‚è€ƒå®˜æ–¹ç»™çš„demoè¿›è¡Œè®¾ç½®å³å¯\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/1TaEIjeIGMUzqUdPnZErytYY)\n\n### äºŒã€è®¾ç½®pom.xml\n```xml\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n            <plugin>\n                <groupId>com.google.cloud.tools</groupId>\n                <artifactId>jib-maven-plugin</artifactId>\n                <version>1.8.0</version>\n                <configuration>\n                    <from>\n                        <image>registry.cn-hangzhou.aliyuncs.com/yhhu/jdk8</image>\n                    </from>\n                    <to>\n                        <image>registry.cn-hangzhou.aliyuncs.com/yhhu/ejile</image>\n                        <tags>\n                            <tag>0.01</tag>\n                        </tags>\n                    </to>\n                    <container>\n                        <ports>\n                            <port>8080</port>\n                        </ports>\n                        <useCurrentTimestamp>true</useCurrentTimestamp>\n                        <args>\n                            <arg>--spring.profiles.active=prod</arg>\n                        </args>\n                    </container>\n                    <allowInsecureRegistries>true</allowInsecureRegistries>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n```\n\næ–¹æ³•ä¸€ï¼šé…ç½®`maven settings.xml`æ–‡ä»¶ï¼ˆæ¨èï¼‰\n```xml\n    <pluginGroups>\n        <!-- pluginGroup | Specifies a further group identifier to use for plugin\n            lookup. <pluginGroup>com.your.plugins</pluginGroup> -->\n        <pluginGroup>com.google.cloud.tools</pluginGroup>\n    </pluginGroups>\n    <!--å¯¹åº”å®¹å™¨ä»“åº“æƒé™çš„è´¦å·å¯†ç -->\n    <servers>\n        <server>\n            <id>registry.cn-hangzhou.aliyuncs.com</id>\n            <username>xxx</username>\n            <password>xxx</password>\n        </server>\n    </servers>\n```\n\næ–¹æ³•äºŒï¼šåœ¨pom.xmlä¸­æ·»åŠ è®¤è¯ä¿¡æ¯ï¼ˆä¸æ¨èï¼‰\n\n```xml\n                    <from>\n                        <image>registry.cn-hangzhou.aliyuncs.com/yhhu/jdk8</image>\n                        <auth>\n                            <username>my_username</username>\n                            <password>my_password</password>\n                        </auth>\n                    </from>\n                    <to>\n                        <image>registry.cn-hangzhou.aliyuncs.com/yhhu/ejile</image>\n                        <tags>\n                            <tag>0.01</tag>\n                        </tags>\n                        <auth>\n                            <username>my_username</username>\n                            <password>my_password</password>\n                        </auth>\n                    </to>\n```\n\n### ä¸‰ã€æ„å»ºå¹¶æäº¤é•œåƒ\n```sh\nmvn compile jib:build\n```\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/6e2Txd4Uf0KR4k4Qz6ZwAgW2)\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/Ub2Yyc94AfDONAP70J86dpYa)');
INSERT INTO `blog_content` VALUES (53, '## åºè¨€\nåœ¨SpringBooté¡¹ç›®éƒ¨ç½²çš„æ—¶å€™ï¼Œæˆ‘äº†è§£åˆ°äº†Jibæ’ä»¶çš„å¼ºå¤§ï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥å¿«é€Ÿæ„å»ºé•œåƒå‘å¸ƒåˆ°æˆ‘ä»¬çš„é•œåƒä»“åº“å½“ä¸­å»ã€‚äºæ˜¯æˆ‘æ‰“ç®—åœ¨æ¯•è®¾å½“ä¸­åŠ ä¸Šè¿™ä¸ªåŠŸèƒ½ï¼Œå¹¶ä¸”æ•´åˆåˆ°github actionsä¸­å»ã€‚\n\n## é˜»ç¢\nåœ¨å•ä½“åœ°ç‹±çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨jibæ’ä»¶ååˆ†çš„æ–¹ä¾¿ï¼Œåªéœ€è¦åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹è¿è¡Œå‘½ä»¤ï¼š`mvn complie jib:build`å°±å¯ä»¥å®Œæˆé•œåƒçš„æ„å»ºå¹¶ä¸”æ¨é€åˆ°ä»“åº“ã€‚è¯¦æƒ…è§ï¼š[jib-maven-pluginæ„å»ºé•œåƒ](http://blog.yhhu.xyz/#/blog/52)\nå¯æ˜¯è¿™ç§æ–¹æ³•åœ¨SpringCloudè¿™ç§å¤šæ¨¡å—åŒ–é¡¹ç›®å½“ä¸­è‚¯å®šæ˜¯æ— æ³•å®ç°çš„ã€‚å‡è®¾å½“å‰mavenå·¥ç¨‹æ˜¯çˆ¶å­ç»“æ„çš„ï¼Œæœ‰ä¸¤ä¸ªå­å·¥ç¨‹Aå’ŒBï¼Œå…¶ä¸­Aæ˜¯äºŒæ–¹åº“ï¼Œæä¾›ä¸€ä¸ªjaråŒ…ï¼Œé‡Œé¢æ˜¯æ¥å£ç±»å’ŒBeanç±»ï¼ŒBæ˜¯springbootåº”ç”¨ï¼Œå¹¶ä¸”Bçš„æºç ä¸­ç”¨åˆ°äº†Aæä¾›çš„æ¥å£å’ŒBeanï¼›ä¸Šè¿°çˆ¶å­ç»“æ„çš„mavenå·¥ç¨‹æ˜¯å¸¸è§çš„å·¥ç¨‹ç»“æ„ï¼Œæ­¤æ—¶å¦‚æœè¦å°†Bæ„å»ºæˆDockeré•œåƒï¼Œåœ¨Bçš„ç›®å½•ä¸‹æ‰§è¡Œ`mvn compile jib:build`æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºæ²¡æœ‰ç¼–è¯‘æ„å»ºAï¼Œä¼šå¯¼è‡´Bçš„ç¼–è¯‘å¤±è´¥ï¼›\n\n## è§£å†³åŠæ³•\næ­¤æ—¶æœ€å¥½çš„åšæ³•å°±æ˜¯å°†`jib`ä¸`mvn`æ„å»ºçš„ç”Ÿå‘½å‘¨æœŸç»‘å®šï¼Œä¿®æ”¹Bçš„`pom.xml`æ–‡ä»¶ï¼ŒåŠ å…¥`executions`èŠ‚ç‚¹ï¼›\nçˆ¶å·¥ç¨‹ç›®å½•ä¸‹æ‰§è¡Œ`mvn package`ï¼Œæ­¤æ—¶`maven`ä¼šå…ˆç¼–è¯‘æ„å»ºæ•´ä¸ªå·¥ç¨‹ï¼Œç„¶åå†å°†Bå·¥ç¨‹çš„æ„å»ºç»“æœåˆ¶ä½œæˆé•œåƒï¼›\n\n## å®ä¾‹\n### ä¸€ã€ç›®å½•ç»“æ„\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/vU6KQ5RfpTjEZ96gdKsTydJ6)\nè¿™æ˜¯æˆ‘çš„`SpringCloud`é¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„å†…å®¹ä¸ºéœ€è¦å‘å¸ƒåˆ°ä»“åº“çš„æœåŠ¡çš„`pom`æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/xfYHcyDaImboNQTyInBvEmit)\n\n### äºŒã€é€šè¿‡`<executions>`èŠ‚ç‚¹ç»‘å®šç”Ÿå‘½å‘¨æœŸ\n```xml\n    <plugin>\n        <groupId>com.google.cloud.tools</groupId>\n        <artifactId>jib-maven-plugin</artifactId>\n        <version>1.8.0</version>\n	<!-- executions   start-->\n        <executions>\n            <execution>\n                <id>build-image</id>\n                <phase>package</phase>\n                <goals>\n                    <goal>build</goal>\n                </goals>\n            </execution>\n        </executions>\n	<!-- executions   end-->\n        <configuration>\n            <from>\n                <image>registry.cn-hangzhou.aliyuncs.com/yhhu/jdk8</image>\n            </from>\n            <to>\n                <image>registry.cn-hangzhou.aliyuncs.com/2shop/user_provider</image>\n            </to>\n            <container>\n                <useCurrentTimestamp>true</useCurrentTimestamp>\n                <args>\n                    <arg>--spring.profiles.active=prod</arg>\n                </args>\n            </container>\n            <allowInsecureRegistries>true</allowInsecureRegistries>\n        </configuration>\n    </plugin>\n```\n\n### ä¸‰ã€ä¸`github actions`æ•´åˆï¼Œå®ç°`push`åè‡ªåŠ¨æ„å»ºé•œåƒ\ngithub actionæ–‡ä»¶å¦‚ä¸‹ï¼š\n```xml\nname: Cloud CI\non:\n  push:\n    branches:\n      - master\n  pull_request:\njobs:\n  push_docker:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v1\n      - name: Set up JDK 1.8\n        uses: actions/setup-java@v1\n        with:\n          java-version: 1.8\n          server-id: registry.cn-hangzhou.aliyuncs.com\n          server-username: MAVEN_USERNAME\n          server-password: MAVEN_PASSWORD\n      - name: Build\n        run: mvn package -q -B -V\n        env:\n          MAVEN_USERNAME: ${{secrets.DOCKER_USERNAME}}\n          MAVEN_PASSWORD: ${{secrets.DOCKER_PASSWORD}}\n```\n\n## å®Œå…¨æ•´åˆdemo\n[yhuihu/shop_api](https://github.com/yhuihu/shop_api)');
INSERT INTO `blog_content` VALUES (54, '## 1ã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/zxa2x58vG8HM2Ogm2uJ6F3G1)\n\n- çº¿ç¨‹ç§æœ‰çš„ï¼š\n	- ç¨‹åºè®¡æ•°å™¨\n	- è™šæ‹Ÿæœºæ ˆ\n	- æœ¬åœ°æ–¹æ³•æ ˆ\n\n- çº¿ç¨‹å…±äº«çš„ï¼š\n	- å †\n	- æ–¹æ³•åŒº\n	- ç›´æ¥å†…å­˜\n\n### 1.1 ç¨‹åºè®¡æ•°å™¨\nç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€åˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚\n\n> ä¸ºäº†ä¿è¯çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹éƒ½éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œä½¿å¾—å„çº¿ç¨‹é—´äº’ä¸å½±å“ã€‚æ‰€ä»¥ç¨‹åºè®¡æ•°å™¨çš„çº¿ç¨‹ç§æœ‰çš„ã€‚\n\n### 1.2 `Java`è™šæ‹Ÿæœºæ ˆ\nä¸ç¨‹åºè®¡æ•°å™¨ä¸€æ ·ï¼Œ`Java`è™šæ‹Ÿæœºæ ˆä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ç›¸åŒï¼Œæè¿°çš„æ˜¯`Java`æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ã€‚\n`Java`å†…å­˜å¯ä»¥ç²—ç³™çš„åŒºåˆ†ä¸ºå †å†…å­˜`Heap`å’Œæ ˆå†…å­˜`Stack`ï¼Œå…¶ä¸­æ ˆå†…å­˜å°±æ˜¯ç°åœ¨è¯´çš„è™šæ‹Ÿæœºæ ˆï¼Œæˆ–è€…è¯´æ˜¯è™šæ‹Ÿæœºæ ˆä¸­å±€éƒ¨å˜é‡è¡¨éƒ¨åˆ†ã€‚\nå±€éƒ¨å˜é‡è¡¨ä¸»è¦å­˜æ”¾äº†ç¼–è¯‘å™¨å¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨ï¼ˆreferenceç±»å‹ï¼Œå®ƒä¸åŒäºå¯¹è±¡æœ¬èº«ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–å…¶ä»–ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ï¼‰ã€‚\n\n### 1.3 æœ¬åœ°æ–¹æ³•æ ˆ\nå’Œè™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯ï¼šè™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ`Java`æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼ŒäºŒæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„`Native`æ–¹æ³•æœåŠ¡ã€‚åœ¨`HotSpot`è™šæ‹Ÿæœºä¸­å’Œ`Java`è™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚\n\n### 1.4 å †\n`Java`è™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œ`Java`å †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚æ­¤å†…å­˜åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚\n`Java`å †æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä½œ`GCå †ï¼ˆGarbage Collected Heapï¼‰`ã€‚\nä»åƒåœ¾å›æ”¶çš„è§’åº¦ï¼Œç”±äºç°åœ¨æ”¶é›†å™¨åŸºæœ¬éƒ½é‡‡ç”¨åˆ†ä»£åƒåœ¾æ”¶é›†ç®—æ³•ï¼Œæ‰€ä»¥Javaå †è¿˜å¯ä»¥ç»†åˆ†ä¸ºï¼šæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£ã€‚å†ç»†è‡´ä¸€ç‚¹å¯ä»¥åˆ†ä¸ºï¼š`Edenç©ºé—´`ã€`From Survivor`ã€`To Survivorç©ºé—´`ç­‰ã€‚\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ckGXMhquiOWkv42dpnTkrg7z)\n\n### 1.5 æ–¹æ³•åŒº\næ–¹æ³•åŒºå’Œå †ä¸€æ ·ï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸã€‚\n1. `JDK 1.7`åŠä»¥å‰ï¼Œ`Java`ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡éƒ½å­˜å‚¨åœ¨æ–¹æ³•åŒºé‡Œï¼Œåˆå¸¸è¢«ç§°ä¸º`Permï¼ˆæ°¸ä¹…ä»£ï¼‰`ï¼Œå½“æœ¬è´¨ä¸Šä¸¤è€…å¹¶ä¸ç­‰ä»·ï¼Œä»…ä»…æ˜¯å› ä¸ºHotSpotè™šæ‹Ÿæœºè®¾è®¡å›¢é˜Ÿç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºè€Œå·²ï¼Œè¿™æ ·HotSpotè™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨å°±å¯ä»¥åƒç®¡ç†`Java`å †ä¸€æ ·ç®¡ç†è¿™éƒ¨åˆ†å†…å­˜äº†ã€‚`Java`è™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘åŒºåŸŸï¼Œä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªåˆ«åå«`Non-Heapï¼ˆéå †ï¼‰`ã€‚ç±»çš„å…ƒæ•°æ®å’Œé™æ€å˜é‡åœ¨ç±»åŠ è½½çš„æ—¶å€™åˆ†é…åˆ°`Perm`ï¼Œå½“ç±»è¢«å¸è½½çš„æ—¶å€™åƒåœ¾æ”¶é›†å™¨ä»`Perm`å¤„ç†æ‰ã€‚\n\næ€»çš„æ¥è¯´ï¼Œå°±æ˜¯è™½ç„¶è¿™ä¸œè¥¿å«æ°¸ä¹…ä»£ï¼Œå¯æ˜¯å¹¶ä¸ä»£è¡¨è¿™é‡Œé¢çš„ä¸œè¥¿å°±æ˜¯æ°¸ä¹…å­˜åœ¨çš„ã€‚\n\n2. `JDK 1.8`å¯¹`JVM`æ¶æ„çš„æ”¹é€ å°†ç±»å…ƒæ•°æ®æ”¾åˆ°äº†æœ¬åœ°å†…å­˜å½“ä¸­ï¼ˆå…ƒç©ºé—´ï¼‰ï¼Œå¦å¤–ï¼Œå°†å¸¸é‡æ± å’Œé™æ€å˜é‡æ”¾åˆ°`Java`å †é‡Œã€‚`HotSpot VM`å°†ä¼šä¸ºç±»çš„å…ƒæ•°æ®æ˜ç¡®åˆ†é…å’Œé‡Šæ”¾æœ¬åœ°å†…å­˜ã€‚åœ¨è¿™ç§æ¶æ„ä¸‹ï¼Œç±»å…ƒä¿¡æ¯å°±çªç ´äº†åŸæ¥`-XX:MaxPermSize`çš„é—²ç½®ï¼Œæ‰€ä»¥`PermSize`çš„é…ç½®ä¹Ÿæ˜¯æ— æ•ˆçš„ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨æ›´å¤šçš„æœ¬åœ°å†…å­˜ã€‚è¿™æ ·å°±ä»ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†åŸæ¥åœ¨è¿è¡Œæ—¶ç”Ÿæˆå¤§é‡ç±»æ—¶é€ æˆç»å¸¸`Full GC`é—®é¢˜ï¼Œå¦‚è¿è¡Œæ—¶ä½¿ç”¨åå°„ã€ä»£ç†ç­‰ã€‚\n\n### 1.6 è¿è¡Œæ—¶å¸¸é‡æ± \nè¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚`Class`æ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ã€å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰å¸¸é‡æ± ä¿¡æ¯ï¼ˆç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼‰\næ—¢ç„¶è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œè‡ªç„¶å—åˆ°æ–¹æ³•åŒºå†…å­˜çš„é™åˆ¶ï¼Œå½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·åˆ°å†…å­˜æ—¶å°±ä¼šæŠ›å‡ºOOMå¼‚å¸¸ã€‚\n`JDK 1.7`åŠä»¥åç‰ˆæœ¬çš„`JVM`å·²ç»å°†è¿è¡Œæ—¶å¸¸é‡æ± ä»æ–¹æ³•åŒºä¸­ç§»äº†å‡ºæ¥ï¼Œåœ¨`Javaå †(Heap)`ä¸­å¼€è¾Ÿäº†ä¸€å—åŒºåŸŸå­˜æ”¾è¿è¡Œæ—¶å¸¸é‡æ± ã€‚åŒæ—¶åœ¨`JDK 1.8`ä¸­ç§»é™¤äº†æ•´ä¸ªæ°¸ä¹…ä»£ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ä¸ªå«å…ƒç©ºé—´çš„åŒºåŸŸã€‚\n\n## 2ã€ å¯¹è±¡çš„åˆ›å»º\n### 2.1 å¯¹è±¡åˆ›å»ºè¿‡ç¨‹æµç¨‹å›¾\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/bVrfbNr6F3Aj6HecB59clCkL)\n**â‘ ç±»åŠ è½½æ£€æŸ¥ï¼š** è™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡`new`æŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆå°†å»æ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°è¿™ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶ä¸”æ£€æŸ¥è¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½è¿‡ã€è§£æå’Œåˆå§‹åŒ–è¿‡ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£å¿…é¡»å…ˆæ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹ã€‚\n**â‘¡åˆ†é…å†…å­˜ï¼š** åœ¨ç±»åŠ è½½æ£€æŸ¥é€šè¿‡åï¼Œæ¥ä¸‹æ¥è™šæ‹Ÿæœºå°†ä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ã€‚å¯¹è±¡æ‰€éœ€çš„å†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯ç¡®å®šï¼Œä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡ç­‰åŒäºæŠŠä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜ä»`Javaå †`ä¸­åˆ’åˆ†å‡ºæ¥ã€‚åˆ†é…æ–¹å¼æœ‰ â€œæŒ‡é’ˆç¢°æ’â€ å’Œ â€œç©ºé—²åˆ—è¡¨â€ ä¸¤ç§ï¼Œé€‰æ‹©é‚£ç§åˆ†é…æ–¹å¼ç”± `Java å †`æ˜¯å¦è§„æ•´å†³å®šï¼Œè€Œ`Javaå †`æ˜¯å¦è§„æ•´åˆç”±æ‰€é‡‡ç”¨çš„åƒåœ¾æ”¶é›†å™¨æ˜¯å¦å¸¦æœ‰å‹ç¼©æ•´ç†åŠŸèƒ½å†³å®šã€‚\n\n::: hljs-center\n\n--------------åˆ†é…å†…å­˜çš„ä¸¤ç§æ–¹å¼----start--------------\n\n:::\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/lQcIFWR2GyciU26tddeVbPAV)\n\né€‰æ‹©ä»¥ä¸Šä¸¤ç§æ–¹å¼ä¸­çš„å“ªä¸€ç§ï¼Œå–å†³äº Java å †å†…å­˜æ˜¯å¦è§„æ•´ã€‚è€Œ Java å †å†…å­˜æ˜¯å¦è§„æ•´ï¼Œå–å†³äº GC æ”¶é›†å™¨çš„ç®—æ³•æ˜¯\"æ ‡è®°-æ¸…é™¤\"ï¼Œè¿˜æ˜¯\"æ ‡è®°-æ•´ç†\"ï¼ˆä¹Ÿç§°ä½œ\"æ ‡è®°-å‹ç¼©\"ï¼‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¤åˆ¶ç®—æ³•å†…å­˜ä¹Ÿæ˜¯è§„æ•´çš„\n\n\n::: hljs-center\n\n--------------åˆ†é…å†…å­˜çš„ä¸¤ç§æ–¹å¼----end--------------\n\n:::\n\n**â‘¢åˆå§‹åŒ–é›¶å€¼ï¼š** å†…å­˜åˆ†é…å®Œæˆåï¼Œè™šæ‹Ÿæœºéœ€è¦å°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡å¤´ï¼‰ï¼Œè¿™ä¸€æ­¥æ“ä½œä¿è¯äº†å¯¹è±¡çš„å®ä¾‹å­—æ®µåœ¨ Java ä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±ç›´æ¥ä½¿ç”¨ï¼Œç¨‹åºèƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼ã€‚\n\n**â‘£è®¾ç½®å¯¹è±¡å¤´ï¼š** åˆå§‹åŒ–é›¶å€¼å®Œæˆä¹‹åï¼Œè™šæ‹Ÿæœºè¦å¯¹å¯¹è±¡è¿›è¡Œå¿…è¦çš„è®¾ç½®ï¼Œä¾‹å¦‚è¿™ä¸ªå¯¹è±¡æ˜¯é‚£ä¸ªç±»çš„å®ä¾‹ã€å¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ã€å¯¹è±¡çš„å“ˆå¸Œå—ã€å¯¹è±¡çš„GCåˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯ã€‚ è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨å¯¹è±¡å¤´ä¸­ã€‚ å¦å¤–ï¼Œæ ¹æ®è™šæ‹Ÿæœºå½“å‰è¿è¡ŒçŠ¶æ€çš„ä¸åŒï¼Œå¦‚æ˜¯å¦å¯ç”¨åå‘é”ç­‰ï¼Œå¯¹è±¡å¤´ä¼šæœ‰ä¸åŒçš„è®¾ç½®æ–¹å¼ã€‚\n\n**â‘¤æ‰§è¡Œ init æ–¹æ³•ï¼š** åœ¨ä¸Šé¢å·¥ä½œéƒ½å®Œæˆä¹‹åï¼Œä»è™šæ‹Ÿæœºçš„è§†è§’æ¥çœ‹ï¼Œä¸€ä¸ªæ–°çš„å¯¹è±¡å·²ç»äº§ç”Ÿäº†ï¼Œä½†ä» Java ç¨‹åºçš„è§†è§’æ¥çœ‹ï¼Œå¯¹è±¡åˆ›å»ºæ‰åˆšå¼€å§‹ï¼Œ <init> æ–¹æ³•è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€æœ‰çš„å­—æ®µéƒ½è¿˜ä¸ºé›¶ã€‚æ‰€ä»¥ä¸€èˆ¬æ¥è¯´ï¼Œæ‰§è¡Œ new æŒ‡ä»¤ä¹‹åä¼šæ¥ç€æ‰§è¡Œ <init> æ–¹æ³•ï¼ŒæŠŠå¯¹è±¡æŒ‰ç…§ç¨‹åºå‘˜çš„æ„æ„¿è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªçœŸæ­£å¯ç”¨çš„å¯¹è±¡æ‰ç®—å®Œå…¨äº§ç”Ÿå‡ºæ¥ã€‚\n\n## 2ã€Stringç±»å’Œå¸¸é‡æ± \n### 2.1 Stringå¯¹è±¡çš„ä¸¤ç§åˆ›å»ºæ–¹å¼\n```java\nString str1=\"abc\";\nString str2=new String(\"abc\");\nâ‘ System.out.println(str1==str2); //false\n```\næ ¹æ®ä¸Šè¿°â‘ å¤„å¯çŸ¥ï¼Œè¿™ä¸¤ç§åˆ›å»ºæ–¹æ³•å¾—åˆ°çš„å¹¶ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚ç¬¬ä¸€ç§æ–¹æ³•å®åœ¨å¸¸é‡æ± ä¸­æ‹¿å¯¹è±¡ï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯ç›´æ¥åœ¨å †å†…å­˜ç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/AwBjx5ESK6TjkRlaad1skKN5)\n\n> åªè¦ä½¿ç”¨newæ–¹æ³•ï¼Œä¾¿éœ€è¦åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚\n\n### 2.2 Stringç±»å‹çš„å¸¸é‡æ± æ¯”è¾ƒç‰¹æ®Šã€‚å®ƒçš„ä¸»è¦ä½¿ç”¨æ–¹æ³•æœ‰ä¸¤ç§ï¼š\n- ç›´æ¥ä½¿ç”¨åŒå¼•å·å£°æ˜å‡ºæ¥é¢Stringå¯¹è±¡ä¼šç›´æ¥å­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ã€‚\n- å¦‚æœä¸æ˜¯ç”¨åŒå¼•å·å£°æ˜çš„Stringå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨Stringæä¾›çš„internæ–¹æ³•ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼šå¦‚æœè¿è¡Œæ—¶å¸¸é‡æ± ä¸­å·²ç»åŒ…å«ä¸€ä¸ªç­‰ä¸æ­¤Stringå¯¹è±¡å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å¸¸é‡æ± ä¸­è¯¥å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™åœ¨å¸¸é‡æ± ä¸­åˆ›å»ºäºæ­¤Stringå†…å®¹ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›å¸¸é‡æ± ä¸­åˆ›å»ºçš„å­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚\n\n```java\n        String s1=new String(\"hello\");\n        String s2=s1.intern();\n        String s3=\"hello\";\n        System.out.println(s2); //hello\n        System.out.println(s1 == s2); //false\n        System.out.println(s3 == s2); //true\n```\n\n### 2.3 Stringå­—ç¬¦ä¸²æ‹¼æ¥\n```java\n        String s1 = \"str\";\n        String s2 = \"ing\";\n        String s3 = \"str\" + \"ing\";  //å¸¸é‡æ± ä¸­çš„å¯¹è±¡\n        String s4 = s1 + s2;  //åœ¨å †ä¸Šåˆ›å»ºæ–°çš„å¯¹è±¡\n        String s5 = \"string\";  //å¸¸é‡æ± ä¸­çš„å¯¹è±¡\n        System.out.println(s3 == s4);  //false\n        System.out.println(s3 == s5);  //true\n        System.out.println(s4 == s5);  //false\n```\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/wfS4FgXsEoWDpf1RWDen2c4R)\n\n>å°½é‡é¿å…å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå› ä¸ºè¿™æ ·ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡ï¼Œæ¯æ¬¡ç”Ÿæˆå¯¹è±¡éƒ½ä¼šå¯¹ç³»ç»Ÿæ€§èƒ½äº§ç”Ÿå½±å“ï¼Œç‰¹åˆ«å½“å†…å­˜ä¸­æ— å¼•ç”¨å¯¹è±¡å¤šäº†ä»¥åï¼Œ JVM çš„ GC å°±ä¼šå¼€å§‹å·¥ä½œï¼Œé‚£é€Ÿåº¦æ˜¯ä¸€å®šä¼šç›¸å½“æ…¢çš„ã€‚ã€‚å¦‚æœéœ€è¦æ”¹å˜å­—ç¬¦ä¸²çš„èŠ±ï¼Œå¯ä»¥ä½¿ç”¨ StringBuilder æˆ–è€… StringBufferã€‚\n\n## 3ã€åƒåœ¾å›æ”¶æœºåˆ¶\n### 3.1 å †ç©ºé—´çš„åŸºæœ¬ç»“æ„\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/HTAJnDrpVKxoFRXwlTnSxa1j)\nä¸Šå›¾æ‰€ç¤ºçš„` eden `åŒºã€`s0(\"From\") `åŒºã€`s1(\"To\") `åŒºéƒ½å±äºæ–°ç”Ÿä»£ï¼Œ`tentired `åŒºå±äºè€å¹´ä»£ã€‚å¤§éƒ¨åˆ†æƒ…å†µï¼Œå¯¹è±¡éƒ½ä¼šé¦–å…ˆåœ¨ `Eden `åŒºåŸŸåˆ†é…ï¼Œåœ¨ä¸€æ¬¡æ–°ç”Ÿä»£åƒåœ¾å›æ”¶åï¼Œå¦‚æœå¯¹è±¡è¿˜å­˜æ´»ï¼Œåˆ™ä¼šè¿›å…¥` s1(\"To\")`ï¼Œå¹¶ä¸”å¯¹è±¡çš„å¹´é¾„è¿˜ä¼šåŠ  1(`Eden `åŒº->`Survivor `åŒºåå¯¹è±¡çš„åˆå§‹å¹´é¾„å˜ä¸º 1)ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º 15 å²ï¼‰ï¼Œå°±ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•°` -XX:MaxTenuringThreshold `æ¥è®¾ç½®ã€‚ç»è¿‡è¿™æ¬¡GCåï¼Œ`Eden`åŒºå’Œ`From`åŒºå·²ç»è¢«æ¸…ç©ºã€‚è¿™ä¸ªæ—¶å€™ï¼Œ`From`å’Œ`To`ä¼šäº¤æ¢ä»–ä»¬çš„è§’è‰²ï¼Œä¹Ÿå°±æ˜¯æ–°çš„`To`å°±æ˜¯ä¸Šæ¬¡GCå‰çš„`From`ï¼Œæ–°çš„`From`å°±æ˜¯ä¸Šæ¬¡GCå‰çš„`To`ã€‚ä¸ç®¡æ€æ ·ï¼Œéƒ½ä¼šä¿è¯åä¸º`To`çš„`Survivor`åŒºåŸŸæ˜¯ç©ºçš„ã€‚`Minor GC`ä¼šä¸€ç›´é‡å¤è¿™æ ·çš„è¿‡ç¨‹ï¼Œç›´åˆ°`To`åŒºè¢«å¡«æ»¡ï¼Œ`To`åŒºè¢«å¡«æ»¡ä¹‹åï¼Œä¼šå°†æ‰€æœ‰å¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚\n\n### 3.2 å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡\nå †ä¸­å‡ ä¹æ”¾ç€æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ï¼Œå¯¹å †åƒåœ¾å›æ”¶å‰çš„ç¬¬ä¸€æ­¥å°±æ˜¯è¦åˆ¤æ–­é‚£äº›å¯¹è±¡å·²ç»æ­»äº¡ï¼ˆå³ä¸èƒ½å†è¢«ä»»ä½•é€”å¾„ä½¿ç”¨çš„å¯¹è±¡ï¼‰ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/xyUK6aaR4wRbELEeDwIK2Y8b)\n\n#### 3.2.1 å¼•ç”¨è®¡æ•°æ³•\nç»™å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒï¼Œè®¡æ•°å™¨å°±åŠ  1ï¼›å½“å¼•ç”¨å¤±æ•ˆï¼Œè®¡æ•°å™¨å°±å‡ 1ï¼›ä»»ä½•æ—¶å€™è®¡æ•°å™¨ä¸º 0 çš„å¯¹è±¡å°±æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„ã€‚\n**è¿™ä¸ªæ–¹æ³•å®ç°ç®€å•ï¼Œæ•ˆç‡é«˜ï¼Œä½†æ˜¯ç›®å‰ä¸»æµçš„è™šæ‹Ÿæœºä¸­å¹¶æ²¡æœ‰é€‰æ‹©è¿™ä¸ªç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œå…¶æœ€ä¸»è¦çš„åŸå› æ˜¯å®ƒå¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´ç›¸äº’å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚** æ‰€è°“å¯¹è±¡ä¹‹é—´çš„ç›¸äº’å¼•ç”¨é—®é¢˜ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼šé™¤äº†å¯¹è±¡ objA å’Œ objB ç›¸äº’å¼•ç”¨ç€å¯¹æ–¹ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å†æ— ä»»ä½•å¼•ç”¨ã€‚ä½†æ˜¯ä»–ä»¬å› ä¸ºäº’ç›¸å¼•ç”¨å¯¹æ–¹ï¼Œå¯¼è‡´å®ƒä»¬çš„å¼•ç”¨è®¡æ•°å™¨éƒ½ä¸ä¸º 0ï¼Œäºæ˜¯å¼•ç”¨è®¡æ•°ç®—æ³•æ— æ³•é€šçŸ¥ GC å›æ”¶å™¨å›æ”¶ä»–ä»¬ã€‚\n```java\npublic class ReferenceCountingGc {\n    Object instance = null;\n    public static void main(String[] args) {\n        ReferenceCountingGc objA = new ReferenceCountingGc();\n        ReferenceCountingGc objB = new ReferenceCountingGc();\n        objA.instance = objB;\n        objB.instance = objA;\n        objA = null;\n        objB = null;\n\n    }\n}\n```\n\n#### 3.2.2 å¯è¾¾æ€§åˆ†æç®—æ³•\nè¿™ä¸ªç®—æ³•çš„åŸºæœ¬æ€æƒ³å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„ç§°ä¸º `GC Roots` çš„å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼ŒèŠ‚ç‚¹æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ° `GC Roots` æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿çš„è¯ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/dKUY5kHdfhUBip2PEeUHPGm6)\n\n### 3.3 å†è°ˆå¼•ç”¨\nå¼•ç”¨åˆ†ä¸ºå¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨å››ç§ï¼ˆå¼•ç”¨å¼ºåº¦é€æ¸å‡å¼±ï¼‰\n- å¼ºå¼•ç”¨ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œé‚£å°±ç±»ä¼¼äºå¿…ä¸å¯å°‘çš„ç”Ÿæ´»ç”¨å“ï¼Œåƒåœ¾å›æ”¶å™¨ç»ä¸ä¼šå›æ”¶å®ƒã€‚å½“å†…å­˜ç©ºé—´ä¸è¶³ï¼ŒJava è™šæ‹Ÿæœºå®æ„¿æŠ›å‡º OutOfMemoryError é”™è¯¯ï¼Œä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼Œä¹Ÿä¸ä¼šé éšæ„å›æ”¶å…·æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡æ¥è§£å†³å†…å­˜ä¸è¶³é—®é¢˜ã€‚\n- è½¯å¼•ç”¨ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡åªå…·æœ‰è½¯å¼•ç”¨ï¼Œé‚£å°±ç±»ä¼¼äºå¯æœ‰å¯æ— çš„ç”Ÿæ´»ç”¨å“ã€‚å¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œåƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸è¶³äº†ï¼Œå°±ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„å†…å­˜ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶å®ƒï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«ç¨‹åºä½¿ç”¨ã€‚è½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ã€‚\n- å¼±å¼•ç”¨ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡åªå…·æœ‰å¼±å¼•ç”¨ï¼Œé‚£å°±ç±»ä¼¼äºå¯æœ‰å¯æ— çš„ç”Ÿæ´»ç”¨å“ã€‚å¼±å¼•ç”¨ä¸è½¯å¼•ç”¨çš„åŒºåˆ«åœ¨äºï¼šåªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œ å› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚\n- è™šå¼•ç”¨ï¼š\"è™šå¼•ç”¨\"é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å½¢åŒè™šè®¾ï¼Œä¸å…¶ä»–å‡ ç§å¼•ç”¨éƒ½ä¸åŒï¼Œè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶ã€‚**è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„æ´»åŠ¨ã€‚**\n**è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼š** è™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ç¨‹åºå¯ä»¥é€šè¿‡åˆ¤æ–­å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦å·²ç»åŠ å…¥äº†è™šå¼•ç”¨ï¼Œæ¥äº†è§£è¢«å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å°†è¦è¢«åƒåœ¾å›æ”¶ã€‚ç¨‹åºå¦‚æœå‘ç°æŸä¸ªè™šå¼•ç”¨å·²ç»è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å†…å­˜è¢«å›æ”¶ä¹‹å‰é‡‡å–å¿…è¦çš„è¡ŒåŠ¨ã€‚\n\n### 3.4 ä¸å¯è¾¾å¯¹è±¡å¹¶é\"éæ­»ä¸å¯\"\nå³ä½¿åœ¨å¯è¾¾æ€§åˆ†ææ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡ï¼Œä¹Ÿå¹¶éæ˜¯â€œéæ­»ä¸å¯â€çš„ï¼Œè¿™æ—¶å€™å®ƒä»¬æš‚æ—¶å¤„äºâ€œç¼“åˆ‘é˜¶æ®µâ€ï¼Œè¦çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡æ­»äº¡ï¼Œè‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼›å¯è¾¾æ€§åˆ†ææ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡è¢«ç¬¬ä¸€æ¬¡æ ‡è®°å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ finalize æ–¹æ³•ã€‚å½“å¯¹è±¡æ²¡æœ‰è¦†ç›– finalize æ–¹æ³•ï¼Œæˆ– finalize æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡æ—¶ï¼Œè™šæ‹Ÿæœºå°†è¿™ä¸¤ç§æƒ…å†µè§†ä¸ºæ²¡æœ‰å¿…è¦æ‰§è¡Œã€‚\nè¢«åˆ¤å®šä¸ºéœ€è¦æ‰§è¡Œçš„å¯¹è±¡å°†ä¼šè¢«æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­è¿›è¡Œç¬¬äºŒæ¬¡æ ‡è®°ï¼Œé™¤éè¿™ä¸ªå¯¹è±¡ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”ï¼Œå¦åˆ™å°±ä¼šè¢«çœŸçš„å›æ”¶ã€‚\n\n### 3.5 å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡\nè¿è¡Œæ—¶å¸¸é‡æ± ä¸»è¦å›æ”¶çš„æ˜¯åºŸå¼ƒçš„å¸¸é‡ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡å‘¢ï¼Ÿ\nå‡å¦‚åœ¨å¸¸é‡æ± ä¸­å­˜åœ¨å­—ç¬¦ä¸² \"abc\"ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ä»»ä½• String å¯¹è±¡å¼•ç”¨è¯¥å­—ç¬¦ä¸²å¸¸é‡çš„è¯ï¼Œå°±è¯´æ˜å¸¸é‡ \"abc\" å°±æ˜¯åºŸå¼ƒå¸¸é‡ï¼Œå¦‚æœè¿™æ—¶å‘ç”Ÿå†…å­˜å›æ”¶çš„è¯è€Œä¸”æœ‰å¿…è¦çš„è¯ï¼Œ\"abc\" å°±ä¼šè¢«ç³»ç»Ÿæ¸…ç†å‡ºå¸¸é‡æ± ã€‚\n\n### 3.6 å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»\næ–¹æ³•åŒºä¸»è¦å›æ”¶çš„æ˜¯æ— ç”¨çš„ç±»ï¼Œé‚£ä¹ˆå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»çš„å‘¢ï¼Ÿ\n\nåˆ¤å®šä¸€ä¸ªå¸¸é‡æ˜¯å¦æ˜¯â€œåºŸå¼ƒå¸¸é‡â€æ¯”è¾ƒç®€å•ï¼Œè€Œè¦åˆ¤å®šä¸€ä¸ªç±»æ˜¯å¦æ˜¯â€œæ— ç”¨çš„ç±»â€çš„æ¡ä»¶åˆ™ç›¸å¯¹è‹›åˆ»è®¸å¤šã€‚ç±»éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢ 3 ä¸ªæ¡ä»¶æ‰èƒ½ç®—æ˜¯ â€œæ— ç”¨çš„ç±»â€ ï¼š\n\n- è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚\n- åŠ è½½è¯¥ç±»çš„ ClassLoader å·²ç»è¢«å›æ”¶ã€‚\n- è¯¥ç±»å¯¹åº”çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚\n\nè™šæ‹Ÿæœºå¯ä»¥å¯¹æ»¡è¶³ä¸Šè¿° 3 ä¸ªæ¡ä»¶çš„æ— ç”¨ç±»è¿›è¡Œå›æ”¶ï¼Œè¿™é‡Œè¯´çš„ä»…ä»…æ˜¯â€œå¯ä»¥â€ï¼Œè€Œå¹¶ä¸æ˜¯å’Œå¯¹è±¡ä¸€æ ·ä¸ä½¿ç”¨äº†å°±ä¼šå¿…ç„¶è¢«å›æ”¶ã€‚\n\n## 4ã€åƒåœ¾æ”¶é›†ç®—æ³•\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/1EtwjpH4u0NjJ0QwdAuCGPye)\n\n### 4.1 æ ‡å¿—-æ¸…é™¤ç®—æ³•\nè¯¥ç®—æ³•åˆ†ä¸ºâ€œæ ‡è®°â€å’Œâ€œæ¸…é™¤â€é˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚å®ƒæ˜¯æœ€åŸºç¡€çš„æ”¶é›†ç®—æ³•ï¼Œåç»­çš„ç®—æ³•éƒ½æ˜¯å¯¹å…¶ä¸è¶³è¿›è¡Œæ”¹è¿›å¾—åˆ°ã€‚è¿™ç§åƒåœ¾æ”¶é›†ç®—æ³•ä¼šå¸¦æ¥ä¸¤ä¸ªæ˜æ˜¾çš„é—®é¢˜ï¼š\n\n- æ•ˆç‡é—®é¢˜\n- ç©ºé—´é—®é¢˜ï¼ˆæ ‡å¿—æ¸…é™¤åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„ç©ºé—´ï¼‰\n\næ ‡è®°-æ¸…é™¤ç®—æ³•å…¶å®å°±æ˜¯æœ‰ä¸¤ä¸ªè¿‡ç¨‹ï¼Œç¬¬ä¸€ä¸ªè¿‡ç¨‹å°±æ˜¯æ ‡è®°ï¼Œç¬¬äºŒä¸ªè¿‡ç¨‹å°±æ˜¯è¿›è¡Œæ¸…é™¤ï¼Œæ‰€è°“çš„æ ‡è®°ï¼Œå°±æ˜¯æ ‡è®°å‡ºæ‰€éœ€è¦å›æ”¶çš„å¯¹è±¡\n\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/3daLgKLT3tLlnouWGeyDMapq)\n\næˆ‘ä»¬å‘ç°ï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬çš„å†…å­˜åŒºåŸŸä¼šå‡ºç°è¶Šæ¥è¶Šå¤šçš„ä¸è¿ç»­çš„ç©ºé—´ï¼Œé‚£ä¹ˆï¼Œè¿™å°±å¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘ä»¬åœ¨åˆ†é…ä¸€ä¸ªå¤§å¯¹è±¡çš„æ—¶å€™ï¼Œè¿™å—ç©ºé—´ä¸è¿ç»­ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œå¯»å€åœ¨æ‰¾çš„è¿‡ç¨‹ä¸­å°±éå¸¸éº»çƒ¦ï¼Œå½±å“æ€§èƒ½ï¼Œå¦å¤–ï¼Œå¦‚æœè¯´ï¼Œå®åœ¨æ‰¾ä¸åˆ°äº†ï¼Œè™šæ‹Ÿæœºä¼šè‡ªåŠ¨å†è¿›è¡Œè§¦å‘ä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯éå¸¸è€—æ€§èƒ½çš„ã€‚\n\n### 4.2 å¤åˆ¶ç®—æ³•\nä¸ºäº†è§£å†³æ•ˆç‡é—®é¢˜ï¼Œâ€œå¤åˆ¶â€æ”¶é›†ç®—æ³•å‡ºç°äº†ã€‚å®ƒå¯ä»¥å°†å†…å­˜åˆ†ä¸ºå¤§å°ç›¸åŒçš„ä¸¤å—ï¼Œæ¯æ¬¡ä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚å½“è¿™ä¸€å—çš„å†…å­˜ä½¿ç”¨å®Œåï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—å»ï¼Œç„¶åå†æŠŠä½¿ç”¨çš„ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚è¿™æ ·å°±ä½¿æ¯æ¬¡çš„å†…å­˜å›æ”¶éƒ½æ˜¯å¯¹å†…å­˜åŒºé—´çš„ä¸€åŠè¿›è¡Œå›æ”¶ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/WJqPJSFtSjZcCmPK8p6RCR0e)\n\n### 4.3 æ ‡å¿—-æ•´ç†ç®—æ³•\næ ¹æ®è€å¹´ä»£çš„ç‰¹ç‚¹æå‡ºçš„ä¸€ç§æ ‡è®°ç®—æ³•ï¼Œæ ‡è®°è¿‡ç¨‹ä»ç„¶ä¸â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¸€æ ·ï¼Œä½†åç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡å›æ”¶ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/qcBdrA9TfaUWLnHFuQe81amH)\n\n### 4.4 åˆ†ä»£æ”¶é›†ç®—æ³•\nå½“å‰è™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†éƒ½é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œè¿™ç§ç®—æ³•æ²¡æœ‰ä»€ä¹ˆæ–°çš„æ€æƒ³ï¼Œåªæ˜¯æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ†ä¸ºå‡ å—ã€‚ä¸€èˆ¬å°† java å †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚\n>**æ¯”å¦‚åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡æ”¶é›†éƒ½ä¼šæœ‰å¤§é‡å¯¹è±¡æ­»å»ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©å¤åˆ¶ç®—æ³•ï¼Œåªéœ€è¦ä»˜å‡ºå°‘é‡å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ¯æ¬¡åƒåœ¾æ”¶é›†ã€‚è€Œè€å¹´ä»£çš„å¯¹è±¡å­˜æ´»å‡ ç‡æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œè€Œä¸”æ²¡æœ‰é¢å¤–çš„ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é€‰æ‹©â€œæ ‡è®°-æ¸…é™¤â€æˆ–â€œæ ‡è®°-æ•´ç†â€ç®—æ³•è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚**\n\n**å»¶ä¼¸é¢è¯•é—®é¢˜ï¼š** HotSpot ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Ÿ\n\n### 5ã€ åƒåœ¾æ”¶é›†å™¨\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/uFJ1mBbXrutSNaFRP5Ozlt0W)\n\n**å¦‚æœè¯´æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®ºï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶çš„å…·ä½“å®ç°ã€‚**\n\nè™½ç„¶æˆ‘ä»¬å¯¹å„ä¸ªæ”¶é›†å™¨è¿›è¡Œæ¯”è¾ƒï¼Œä½†å¹¶éè¦æŒ‘é€‰å‡ºä¸€ä¸ªæœ€å¥½çš„æ”¶é›†å™¨ã€‚å› ä¸ºç›´åˆ°ç°åœ¨ä¸ºæ­¢è¿˜æ²¡æœ‰æœ€å¥½çš„åƒåœ¾æ”¶é›†å™¨å‡ºç°ï¼Œæ›´åŠ æ²¡æœ‰ä¸‡èƒ½çš„åƒåœ¾æ”¶é›†å™¨ï¼Œ**æˆ‘ä»¬èƒ½åšçš„å°±æ˜¯æ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯é€‰æ‹©é€‚åˆè‡ªå·±çš„åƒåœ¾æ”¶é›†å™¨ã€‚**\n\n#### 5.1 Serialæ”¶é›†å™¨\nSerialï¼ˆä¸²è¡Œï¼‰æ”¶é›†å™¨æ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬ã€å†å²æœ€æ‚ ä¹…çš„åƒåœ¾æ”¶é›†å™¨äº†ã€‚å¤§å®¶çœ‹åå­—å°±çŸ¥é“è¿™ä¸ªæ”¶é›†å™¨æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨äº†ã€‚å®ƒçš„ â€œå•çº¿ç¨‹â€ çš„æ„ä¹‰ä¸ä»…ä»…æ„å‘³ç€å®ƒåªä¼šä½¿ç”¨ä¸€æ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œæ›´é‡è¦çš„æ˜¯å®ƒåœ¨è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œçš„æ—¶å€™å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼ˆ \"Stop The World\" ï¼‰ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸã€‚\nåœ¨Serialæ”¶é›†å™¨ä¸­ï¼Œæ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚ï¼ˆååˆ†æ˜æ˜¾çš„åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œå…·ä½“çœ‹4.4ä¸­åˆ†ä»£æ”¶é›†ç®—æ³•çš„æè¿°ï¼‰\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/DVYnEqJpeUTZkgJjkQl3TjNL)\n\nè™šæ‹Ÿæœºçš„è®¾è®¡è€…ä»¬å½“ç„¶çŸ¥é“ Stop The World å¸¦æ¥çš„ä¸è‰¯ç”¨æˆ·ä½“éªŒï¼Œæ‰€ä»¥åœ¨åç»­çš„åƒåœ¾æ”¶é›†å™¨è®¾è®¡ä¸­åœé¡¿æ—¶é—´åœ¨ä¸æ–­ç¼©çŸ­ï¼ˆä»ç„¶è¿˜æœ‰åœé¡¿ï¼Œå¯»æ‰¾æœ€ä¼˜ç§€çš„åƒåœ¾æ”¶é›†å™¨çš„è¿‡ç¨‹ä»ç„¶åœ¨ç»§ç»­ï¼‰ã€‚\n\nä½†æ˜¯ Serial æ”¶é›†å™¨æœ‰æ²¡æœ‰ä¼˜äºå…¶ä»–åƒåœ¾æ”¶é›†å™¨çš„åœ°æ–¹å‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œå®ƒç®€å•è€Œé«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹ç›¸æ¯”ï¼‰ã€‚Serial æ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œè‡ªç„¶å¯ä»¥è·å¾—å¾ˆé«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚Serial æ”¶é›†å™¨å¯¹äºè¿è¡Œåœ¨ Client æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºæ¥è¯´æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚\n\n#### 5.2 Serial Old æ”¶é›†å™¨\nSerial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œå®ƒåŒæ ·æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ã€‚å®ƒä¸»è¦æœ‰ä¸¤å¤§ç”¨é€”ï¼šä¸€ç§ç”¨é€”æ˜¯åœ¨ JDK1.5 ä»¥åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ï¼Œå¦ä¸€ç§ç”¨é€”æ˜¯ä½œä¸º CMS æ”¶é›†å™¨çš„åå¤‡æ–¹æ¡ˆã€‚\n\n#### 5.3 ParNewæ”¶é›†å™¨\n**ParNew æ”¶é›†å™¨å…¶å®å°±æ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œé™¤äº†ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å¤–ï¼Œå…¶ä½™è¡Œä¸ºï¼ˆæ§åˆ¶å‚æ•°ã€æ”¶é›†ç®—æ³•ã€å›æ”¶ç­–ç•¥ç­‰ç­‰ï¼‰å’Œ Serial æ”¶é›†å™¨å®Œå…¨ä¸€æ ·ã€‚**\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/jI0vzvEsyfGBomUuERawpFrI)\n\nå®ƒæ˜¯è®¸å¤šè¿è¡Œåœ¨ Server æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºçš„é¦–è¦é€‰æ‹©ï¼Œé™¤äº† Serial æ”¶é›†å™¨å¤–ï¼Œåªæœ‰å®ƒèƒ½ä¸ CMS æ”¶é›†å™¨ï¼ˆçœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œåé¢ä¼šä»‹ç»åˆ°ï¼‰é…åˆå·¥ä½œã€‚\n**å¹¶è¡Œå’Œå¹¶å‘æ¦‚å¿µè¡¥å……ï¼š**\n- å¹¶è¡Œï¼ˆParallelï¼‰ ï¼šæŒ‡å¤šæ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å¹¶è¡Œå·¥ä½œï¼Œä½†æ­¤æ—¶ç”¨æˆ·çº¿ç¨‹ä»ç„¶å¤„äºç­‰å¾…çŠ¶æ€ã€‚\n- å¹¶å‘ï¼ˆConcurrentï¼‰ï¼šæŒ‡ç”¨æˆ·çº¿ç¨‹ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼ˆä½†ä¸ä¸€å®šæ˜¯å¹¶è¡Œï¼Œå¯èƒ½ä¼šäº¤æ›¿æ‰§è¡Œï¼‰ï¼Œç”¨æˆ·ç¨‹åºåœ¨ç»§ç»­è¿è¡Œï¼Œè€Œåƒåœ¾æ”¶é›†å™¨è¿è¡Œåœ¨å¦ä¸€ä¸ª CPU ä¸Šã€‚\n\n\n#### 5.4 Parallel Scavenge æ”¶é›†å™¨\nParallel Scavenge æ”¶é›†å™¨ä¹Ÿæ˜¯ä½¿ç”¨å¤åˆ¶ç®—æ³•çš„å¤šçº¿ç¨‹æ”¶é›†å™¨ï¼Œå®ƒçœ‹ä¸Šå»å‡ ä¹å’ŒParNewéƒ½ä¸€æ ·ã€‚ é‚£ä¹ˆå®ƒæœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„å‘¢ï¼Ÿ\n```\n-XX:+UseParallelGC \n\n    ä½¿ç”¨ Parallel æ”¶é›†å™¨+ è€å¹´ä»£ä¸²è¡Œ\n\n-XX:+UseParallelOldGC\n\n    ä½¿ç”¨ Parallel æ”¶é›†å™¨+ è€å¹´ä»£å¹¶è¡Œ\n```\n\nParallel Scavenge æ”¶é›†å™¨å…³æ³¨ç‚¹æ˜¯ååé‡ï¼ˆé«˜æ•ˆç‡çš„åˆ©ç”¨ CPUï¼‰ã€‚CMS ç­‰åƒåœ¾æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ›´å¤šçš„æ˜¯ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼ˆæé«˜ç”¨æˆ·ä½“éªŒï¼‰ã€‚æ‰€è°“ååé‡å°±æ˜¯ CPU ä¸­ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸ CPU æ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ã€‚ Parallel Scavenge æ”¶é›†å™¨æä¾›äº†å¾ˆå¤šå‚æ•°ä¾›ç”¨æˆ·æ‰¾åˆ°æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–æœ€å¤§ååé‡ï¼Œå¦‚æœå¯¹äºæ”¶é›†å™¨è¿ä½œä¸å¤ªäº†è§£çš„è¯ï¼Œæ‰‹å·¥ä¼˜åŒ–å­˜åœ¨å›°éš¾çš„è¯å¯ä»¥é€‰æ‹©æŠŠå†…å­˜ç®¡ç†ä¼˜åŒ–äº¤ç»™è™šæ‹Ÿæœºå»å®Œæˆä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚\næ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/CAOP2VDo5piEbnaYFj5vM4Re)\n\n#### 5.5 Parallel Old æ”¶é›†å™¨\nParallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ã€‚ä½¿ç”¨å¤šçº¿ç¨‹å’Œâ€œæ ‡è®°-æ•´ç†â€ç®—æ³•ã€‚åœ¨æ³¨é‡ååé‡ä»¥åŠ CPU èµ„æºçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge æ”¶é›†å™¨å’Œ Parallel Old æ”¶é›†å™¨ã€‚\n\n#### 5.6 CMS æ”¶é›†å™¨\nCMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚å®ƒéå¸¸ç¬¦åˆåœ¨æ³¨é‡ç”¨æˆ·ä½“éªŒçš„åº”ç”¨ä¸Šä½¿ç”¨ã€‚\nCMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ HotSpot è™šæ‹Ÿæœºç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ï¼ˆåŸºæœ¬ä¸Šï¼‰åŒæ—¶å·¥ä½œã€‚\nä»åå­—ä¸­çš„Mark Sweepè¿™ä¸¤ä¸ªè¯å¯ä»¥çœ‹å‡ºï¼ŒCMS æ”¶é›†å™¨æ˜¯ä¸€ç§ â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•å®ç°çš„ï¼Œå®ƒçš„è¿ä½œè¿‡ç¨‹ç›¸æ¯”äºå‰é¢å‡ ç§åƒåœ¾æ”¶é›†å™¨æ¥è¯´æ›´åŠ å¤æ‚ä¸€äº›ã€‚æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š\n- åˆå§‹æ ‡è®°ï¼š æš‚åœæ‰€æœ‰çš„å…¶ä»–çº¿ç¨‹ï¼Œå¹¶è®°å½•ä¸‹ç›´æ¥ä¸ root ç›¸è¿çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿« ï¼›ï¼ˆä»rootå¯¹è±¡å¼€å§‹æ ‡è®°å­˜æ´»çš„å¯¹è±¡ï¼‰\n- å¹¶å‘æ ‡è®°ï¼š åŒæ—¶å¼€å¯ GC å’Œç”¨æˆ·çº¿ç¨‹ï¼Œç”¨ä¸€ä¸ªé—­åŒ…ç»“æ„å»è®°å½•å¯è¾¾å¯¹è±¡ã€‚ä½†åœ¨è¿™ä¸ªé˜¶æ®µç»“æŸï¼Œè¿™ä¸ªé—­åŒ…ç»“æ„å¹¶ä¸èƒ½ä¿è¯åŒ…å«å½“å‰æ‰€æœ‰çš„å¯è¾¾å¯¹è±¡ã€‚å› ä¸ºç”¨æˆ·çº¿ç¨‹å¯èƒ½ä¼šä¸æ–­çš„æ›´æ–°å¼•ç”¨åŸŸï¼Œæ‰€ä»¥ GC çº¿ç¨‹æ— æ³•ä¿è¯å¯è¾¾æ€§åˆ†æçš„å®æ—¶æ€§ã€‚æ‰€ä»¥è¿™ä¸ªç®—æ³•é‡Œä¼šè·Ÿè¸ªè®°å½•è¿™äº›å‘ç”Ÿå¼•ç”¨æ›´æ–°çš„åœ°æ–¹ã€‚\n- é‡æ–°æ ‡è®°ï¼š é‡æ–°æ ‡è®°é˜¶æ®µå°±æ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µçš„æ—¶é—´ç¨é•¿ï¼Œè¿œè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µæ—¶é—´çŸ­ã€‚ï¼ˆå¹¶å‘æ ‡è®°é˜¶æ®µé—æ¼çš„å¯¹è±¡ï¼ˆåœ¨å¹¶å‘æ ‡è®°é˜¶æ®µç»“æŸåå¯¹è±¡çŠ¶æ€çš„æ›´æ–°å¯¼è‡´ï¼‰ã€‚ï¼‰\n- å¹¶å‘æ¸…é™¤ï¼š å¼€å¯ç”¨æˆ·çº¿ç¨‹ï¼ŒåŒæ—¶ GC çº¿ç¨‹å¼€å§‹å¯¹ä¸ºæ ‡è®°çš„åŒºåŸŸåšæ¸…æ‰«ã€‚\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/sYkaXCxhvYkKAtF7JxTLQVo1)\n\nä»å®ƒçš„åå­—å°±å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„åƒåœ¾æ”¶é›†å™¨ï¼Œ**ä¸»è¦ä¼˜ç‚¹ï¼šå¹¶å‘æ”¶é›†ã€ä½åœé¡¿ã€‚** ä½†æ˜¯å®ƒæœ‰ä¸‹é¢ä¸‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼š\n\n- å¯¹ CPU èµ„æºæ•æ„Ÿï¼›\n- æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼›ï¼ˆå¹¶å‘æ¸…ç†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œï¼Œè¿™æ®µæ—¶é—´å°±å¯èƒ½äº§ç”Ÿæ–°çš„åƒåœ¾ï¼Œæ–°çš„åƒåœ¾åœ¨æ­¤æ¬¡GCæ— æ³•æ¸…é™¤ï¼Œåªèƒ½ç­‰åˆ°ä¸‹æ¬¡æ¸…ç†ã€‚è¿™äº›åƒåœ¾æœ‰ä¸ªä¸“ä¸šåè¯ï¼šæµ®åŠ¨åƒåœ¾ã€‚ï¼‰\n- å®ƒä½¿ç”¨çš„å›æ”¶ç®—æ³•-â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¼šå¯¼è‡´æ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿã€‚\n\n#### 5.7 G1æ”¶é›†å™¨\n\nG1 (Garbage-First) æ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡å™¨çš„åƒåœ¾æ”¶é›†å™¨,ä¸»è¦é’ˆå¯¹é…å¤‡å¤šé¢—å¤„ç†å™¨åŠå¤§å®¹é‡å†…å­˜çš„æœºå™¨. ä»¥æé«˜æ¦‚ç‡æ»¡è¶³ GC åœé¡¿æ—¶é—´è¦æ±‚çš„åŒæ—¶,è¿˜å…·å¤‡é«˜ååé‡æ€§èƒ½ç‰¹å¾.\n\nè¢«è§†ä¸º JDK1.7 ä¸­ HotSpot è™šæ‹Ÿæœºçš„ä¸€ä¸ªé‡è¦è¿›åŒ–ç‰¹å¾ã€‚å®ƒå…·å¤‡ä¸€ä¸‹ç‰¹ç‚¹ï¼š\n\n- å¹¶è¡Œä¸å¹¶å‘ï¼šG1 èƒ½å……åˆ†åˆ©ç”¨ CPUã€å¤šæ ¸ç¯å¢ƒä¸‹çš„ç¡¬ä»¶ä¼˜åŠ¿ï¼Œä½¿ç”¨å¤šä¸ª CPUï¼ˆCPU æˆ–è€… CPU æ ¸å¿ƒï¼‰æ¥ç¼©çŸ­ Stop-The-World åœé¡¿æ—¶é—´ã€‚éƒ¨åˆ†å…¶ä»–æ”¶é›†å™¨åŸæœ¬éœ€è¦åœé¡¿ Java çº¿ç¨‹æ‰§è¡Œçš„ GC åŠ¨ä½œï¼ŒG1 æ”¶é›†å™¨ä»ç„¶å¯ä»¥é€šè¿‡å¹¶å‘çš„æ–¹å¼è®© java ç¨‹åºç»§ç»­æ‰§è¡Œã€‚\n- åˆ†ä»£æ”¶é›†ï¼šè™½ç„¶ G1 å¯ä»¥ä¸éœ€è¦å…¶ä»–æ”¶é›†å™¨é…åˆå°±èƒ½ç‹¬ç«‹ç®¡ç†æ•´ä¸ª GC å †ï¼Œä½†æ˜¯è¿˜æ˜¯ä¿ç•™äº†åˆ†ä»£çš„æ¦‚å¿µã€‚\n- ç©ºé—´æ•´åˆï¼šä¸ CMS çš„â€œæ ‡è®°--æ¸…ç†â€ç®—æ³•ä¸åŒï¼ŒG1 ä»æ•´ä½“æ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®°æ•´ç†â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼›ä»å±€éƒ¨ä¸Šæ¥çœ‹æ˜¯åŸºäºâ€œå¤åˆ¶â€ç®—æ³•å®ç°çš„ã€‚\n- å¯é¢„æµ‹çš„åœé¡¿ï¼šè¿™æ˜¯ G1 ç›¸å¯¹äº CMS çš„å¦ä¸€ä¸ªå¤§ä¼˜åŠ¿ï¼Œé™ä½åœé¡¿æ—¶é—´æ˜¯ G1 å’Œ CMS å…±åŒçš„å…³æ³¨ç‚¹ï¼Œä½† G1 é™¤äº†è¿½æ±‚ä½åœé¡¿å¤–ï¼Œè¿˜èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ã€‚\n\nG1 æ”¶é›†å™¨çš„è¿ä½œå¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š\n- åˆå§‹æ ‡è®°\n- å¹¶å‘æ ‡è®°\n- æœ€ç»ˆæ ‡è®°\n- ç­›é€‰å›æ”¶\n\nG1 æ”¶é›†å™¨åœ¨åå°ç»´æŠ¤äº†ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆé€‰æ‹©å›æ”¶ä»·å€¼æœ€å¤§çš„ Region(è¿™ä¹Ÿå°±æ˜¯å®ƒçš„åå­— Garbage-First çš„ç”±æ¥)ã€‚è¿™ç§ä½¿ç”¨ Region åˆ’åˆ†å†…å­˜ç©ºé—´ä»¥åŠæœ‰ä¼˜å…ˆçº§çš„åŒºåŸŸå›æ”¶æ–¹å¼ï¼Œä¿è¯äº† GF æ”¶é›†å™¨åœ¨æœ‰é™æ—¶é—´å†…å¯ä»¥å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡ï¼ˆæŠŠå†…å­˜åŒ–æ•´ä¸ºé›¶ï¼‰ã€‚\n\n\n### 6ã€è°ƒä¼˜å¸¸ç”¨å‚æ•°\n\n```\n-XX:MetaspaceSize=128M -XX:MaxMetaspaceSize=256M -Xms256m -Xmx256m\n```\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/2YiTOeuf3FJuVTYhZkr5IDT9)\n\n> å›¾ä¸­æ°¸ä¹…ä»£åœ¨ç°åœ¨åº”æ”¹ä¸ºå…ƒç©ºé—´ï¼Œå¯¹åº”çš„è®¾ç½®å‚æ•°ä¸ºMetaspaceï¼Œä½¿ç”¨PermSizeå°†ä¸èµ·ä½œç”¨\n\n## å‚è€ƒ\n[å¯èƒ½æ˜¯æŠŠJavaå†…å­˜åŒºåŸŸè®²çš„æœ€æ¸…æ¥šçš„ä¸€ç¯‡æ–‡ç« ](https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&mid=2247484884&amp;idx=1&amp;sn=0d9b841ce0fc300c78ade2a87ffbfb46&source=41#wechat_redirect)\n');
INSERT INTO `blog_content` VALUES (55, '- cd <è·¯å¾„>ï¼šcdå‘½ä»¤åé¢è·Ÿä¸€ä¸ªè·¯å¾„ï¼Œç”¨äºåˆ‡æ¢å½“å‰ç”¨æˆ·æ‰€åœ¨çš„è·¯å¾„ï¼Œå…¶ä¸­è·¯å¾„å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„\n- ls <å‚æ•°> <è·¯å¾„>ï¼šlsæ˜¯listçš„ç¼©å†™ã€‚æœ€å¸¸ç”¨çš„å‚æ•°æ˜¯`-l`ï¼Œä¹Ÿå°±æ˜¯`ls -l`å‘½ä»¤ï¼Œä½œç”¨ä¸ºç”¨äºæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹çš„è¯¦ç»†ä¿¡æ¯\n- cat <æ–‡ä»¶>ï¼šconcatenateçš„ç¼©å†™ï¼Œè¡¨ç¤ºè¯»å–æ–‡ä»¶å†…å®¹åŠæ‹¼æ¥æ–‡ä»¶\n- rm <æ–‡ä»¶>æˆ–rm -r <æ–‡ä»¶å¤¹>ï¼šrmæ˜¯removeçš„ç¼©å†™ï¼Œ-rè¡¨ç¤ºåˆ é™¤ç›®å½•ï¼Œä¹Ÿå¯ä»¥ç”¨äºåˆ é™¤æ–‡ä»¶ï¼Œ-fè¡¨ç¤ºå¼ºåˆ¶åˆ é™¤ï¼Œä¸éœ€è¦ç¡®è®¤\n- mkdir æ–‡ä»¶å¤¹ï¼šmake directoryçš„ç¼©å†™\n- cp <æ–‡ä»¶> <ç›®æ ‡æ–‡ä»¶>æˆ–cp -r <æ–‡ä»¶å¤¹> <ç›®æ ‡æ–‡ä»¶å¤¹>ï¼Œcpæ˜¯copyçš„ç¼©å†™\n- kill PIDç ï¼šç»“æŸPIDç æŒ‡å®šçš„è¿›ç¨‹ï¼Œkill -9 PIDç è¡¨ç¤ºå¼ºåˆ¶ç»“æŸã€‚\n- pwdï¼šæŸ¥çœ‹å½“å‰è·¯å¾„\n- psï¼šç”¨äºæŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ï¼Œå¦‚æœéœ€è¦åŠ¨æ€è¿ç»­ç»“æœä½¿ç”¨topã€‚å¸¸ç”¨å‚æ•°ï¼š\n	- -A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹\n	- -a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹æ‰€æœ‰è¿›ç¨‹\n	- c æ˜¾ç¤ºè¿›ç¨‹çœŸå®åç§°\n	- e æ˜¾ç¤ºç¯å¢ƒå˜é‡\n	- f æ˜¾ç¤ºè¿›ç¨‹é—´å…³ç³»\n	- r æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹\n	- -aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶å®ƒä½¿ç”¨çš„è¿›ç¨‹');
INSERT INTO `blog_content` VALUES (56, '## ä¸€ã€å•ä¾‹æ¨¡å¼\n### 1.1 é¥¿æ±‰æ¨¡å¼\n```Java\n//é¥¿æ±‰å¼å•ä¾‹ç±».åœ¨ç±»åˆå§‹åŒ–æ—¶ï¼Œå·²ç»è‡ªè¡Œå®ä¾‹åŒ–   \npublic class Singleton1 {  \n    private Singleton1() {}  \n    private static final Singleton1 single = new Singleton1();  \n    //é™æ€å·¥å‚æ–¹æ³•   \n    public static Singleton1 getInstance() {  \n        return single;  \n    }  \n}\n```\n\né¥¿æ±‰å¼åœ¨ç±»åˆ›å»ºçš„åŒæ—¶å°±å®ä¾‹åŒ–ä¸€ä¸ªé™æ€å¯¹è±¡å‡ºæ¥ï¼Œä¸ç®¡ä¹‹åä¼šä¸ä¼šä½¿ç”¨è¿™ä¸ªå•ä¾‹ï¼Œéƒ½ä¼šå æ®ä¸€å®šçš„å†…å­˜ï¼Œä½†æ˜¯ç›¸åº”çš„ï¼Œåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶é€Ÿåº¦ä¹Ÿä¼šæ›´å¿«ï¼Œå› ä¸ºå…¶èµ„æºå·²ç»åˆå§‹åŒ–å®Œæˆï¼Œ\n\n### 1.2 æ‡’æ±‰æ¨¡å¼\nå…ˆçœ‹ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬\n```Java\n//æ‡’æ±‰å¼å•ä¾‹ç±».åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™å®ä¾‹åŒ–è‡ªå·±   \npublic class Singleton {  \n    private Singleton() {}  \n    private volatile static Singleton single=null;  \n    //é™æ€å·¥å‚æ–¹æ³•   \n    public static Singleton getInstance() {  \n         if (single == null) {    \n             single = new Singleton();  \n         }    \n        return single;  \n    }  \n} \n```\nå¦‚æœå¯¹çº¿ç¨‹å®‰å…¨æœ‰äº†è§£ï¼Œé‚£ä¹ˆå°±ä¼šçŸ¥é“ï¼Œè¿™ä¸ªæ‡’æ±‰æ–¹æ³•å®é™…ä¸Šæ˜¯ä¸å¥½çš„ï¼Œå®ƒåœ¨å¹¶å‘çš„ç¯å¢ƒä¸‹æ˜¯æœ‰å¯èƒ½è¢«å¤šæ¬¡å®ä¾‹åŒ–çš„ã€‚äºæ˜¯ä¹æœ‰äº†ä¸‹é¢ä¸‰ç§æ–¹æ³•ï¼Œéƒ½æ˜¯å¯¹getInstanceè¿™ä¸ªæ–¹æ³•æ”¹é€ ï¼Œä¿è¯äº†æ‡’æ±‰å¼å•ä¾‹çš„çº¿ç¨‹å®‰å…¨ã€‚\n\n#### 1.2.1 å°†`getInstance()`æ–¹æ³•æ”¹ä¸ºåŒæ­¥æ–¹æ³•ï¼ˆä¸æ¨èï¼Œæ•ˆç‡å¤ªä½äº†ï¼‰\n```Java\npublic static synchronized Singleton getInstance() {  \n         if (single == null) {    \n             single = new Singleton();  \n         }    \n        return single;  \n} \n```\n\n#### 1.2.2 åŒé‡æ ¡éªŒæ–¹æ³•ï¼ˆDouble Check Lockï¼‰\n```Java\npublic static Singleton getInstance() {  \n    if (singleton == null) {    \n        synchronized (Singleton.class) {    \n           if (singleton == null) {    \n              singleton = new Singleton();   \n           }    \n        }    \n    }    \n    return singleton;   \n} \n```\nç”±äºjvmå­˜åœ¨ä¹±åºæ‰§è¡ŒåŠŸèƒ½ï¼ŒDCLä¹Ÿä¼šå‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µã€‚\n\n`INSTANCE  = new SingleTon(); `è¿™ä¸ªæ­¥éª¤ï¼Œå…¶å®åœ¨jvmé‡Œé¢çš„æ‰§è¡Œåˆ†ä¸ºä¸‰æ­¥ï¼š\n- åœ¨å †å†…å­˜å¼€è¾Ÿå†…å­˜ç©ºé—´ã€‚\n- åœ¨å †å†…å­˜ä¸­å®ä¾‹åŒ–SingleToné‡Œé¢çš„å„ä¸ªå‚æ•°ã€‚\n- æŠŠå¯¹è±¡æŒ‡å‘å †å†…å­˜ç©ºé—´ã€‚\n\n\nç”±äºjvmå­˜åœ¨ä¹±åºæ‰§è¡ŒåŠŸèƒ½ï¼Œæ‰€ä»¥å¯èƒ½åœ¨2è¿˜æ²¡æ‰§è¡Œæ—¶å°±å…ˆæ‰§è¡Œäº†3ï¼Œå¦‚æœæ­¤æ—¶å†è¢«åˆ‡æ¢åˆ°çº¿ç¨‹Bä¸Šï¼Œç”±äºæ‰§è¡Œäº†3ï¼ŒINSTANCE å·²ç»éç©ºäº†ï¼Œä¼šè¢«ç›´æ¥æ‹¿å‡ºæ¥ç”¨ï¼Œè¿™æ ·çš„è¯ï¼Œå°±ä¼šå‡ºç°å¼‚å¸¸ã€‚è¿™ä¸ªå°±æ˜¯è‘—åçš„DCLå¤±æ•ˆé—®é¢˜ã€‚\nä¸è¿‡åœ¨JDK1.5ä¹‹åï¼Œå®˜æ–¹ä¹Ÿå‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œæ•…è€Œå…·ä½“åŒ–äº†volatileï¼Œå³åœ¨JDK1.6åŠä»¥åï¼Œåªè¦å®šä¹‰ä¸ºprivate volatile static SingleTonÂ  INSTANCE = null;å°±å¯è§£å†³DCLå¤±æ•ˆé—®é¢˜ã€‚volatileç¡®ä¿INSTANCEæ¯æ¬¡å‡åœ¨ä¸»å†…å­˜ä¸­è¯»å–ï¼Œè¿™æ ·è™½ç„¶ä¼šç‰ºç‰²ä¸€ç‚¹æ•ˆç‡ï¼Œä½†ä¹Ÿæ— ä¼¤å¤§é›…ã€‚\n\n\n\n\n#### 1.2.3 é™æ€å†…éƒ¨ç±»ï¼ˆæ¨èï¼‰\n```Java\npublic class Singleton {    \n    private static class LazyHolder {    \n       private static final Singleton INSTANCE = new Singleton();    \n    }    \n    private Singleton (){}    \n    public static final Singleton getInstance() {    \n       return LazyHolder.INSTANCE;    \n    }    \n} \n```\nè¿™ç§æ¯”ä¸Šé¢1ã€2éƒ½å¥½ä¸€äº›ï¼Œæ—¢å®ç°äº†çº¿ç¨‹å®‰å…¨ï¼Œåˆé¿å…äº†åŒæ­¥å¸¦æ¥çš„æ€§èƒ½å½±å“ã€‚\n[æ·±å…¥ç†è§£å•ä¾‹æ¨¡å¼ï¼šé™æ€å†…éƒ¨ç±»å•ä¾‹åŸç†](https://blog.csdn.net/mnb65482/article/details/80458571)\n\n#### 1.2.4 æšä¸¾æ–¹æ³•\n```java\npublic class EnumSingleton {\n\n    enum SerEnumSingleton {\n        INSTANCE;\n        private String content;\n\n        public String getContent() {\n            return content;\n        }\n\n        /**\n         * å†…å®¹æµ‹è¯•\n         * @param content content\n         */\n        public void setContent(String content) {\n            this.content = content;\n        }\n\n        SerEnumSingleton() { }\n    }\n\n    public static void main(String[] args) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {\n        SerEnumSingleton serEnumSingleton = SerEnumSingleton.INSTANCE;\n        serEnumSingleton.setContent(\"singleton1\");\n        Class<SerEnumSingleton> serEnumSingletonClass = SerEnumSingleton.class;\n        Constructor<SerEnumSingleton> constructor=serEnumSingletonClass.getDeclaredConstructor(String.class,int.class);\n        constructor.setAccessible(true);\n        SerEnumSingleton serEnumSingleton1=constructor.newInstance(\"test\",123);\n        System.out.println(serEnumSingleton==serEnumSingleton1);\n    }\n}\n```\n\n[ä¸ºä»€ä¹ˆè¦ç”¨æšä¸¾å®ç°å•ä¾‹æ¨¡å¼ï¼ˆé¿å…åå°„ã€åºåˆ—åŒ–é—®é¢˜ï¼‰](https://www.cnblogs.com/chiclee/p/9097772.html)\n\n## äºŒã€å·¥å‚æ¨¡å¼\n\n### 2.1 ç®€å•å·¥å‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/hMpGLQL18CmtKWIPDuAxxnqa)\næ˜¯é€šè¿‡ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»æ¥è´Ÿè´£åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»ã€‚\nç®€å•å·¥å‚æ¨¡å¼å°±æ˜¯é€šè¿‡ä¸€ä¸ª\"å…¨èƒ½ç±»\"ï¼Œæ ¹æ®å¤–ç•Œä¼ é€’çš„ä¿¡æ¯æ¥å†³å®šåˆ›å»ºå“ªä¸ªå…·ä½“ç±»çš„å¯¹è±¡ã€‚\n```java\npublic class SimpleFactory {\n    public static IProduct getFactory(String name) throws IllegalAccessException {\n        if (name.equals(\"A\")){\n            return new AProduct();\n        }else if (name.equals(\"B\")){\n            return new BProduct();\n        }else{\n            throw new IllegalAccessException();\n        }\n    }\n}\n```\n\n### 2.2 å·¥å‚æ–¹æ³•æ¨¡å¼\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/tDR7T6fhZ5fOuBWDYzlIZ6kp)\nå¯¹ç®€å•å·¥å‚æ¨¡å¼è¿›è¡Œäº†æŠ½è±¡åŒ–ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ï¼Œå®ç°äº†å¯æ‰©å±•ã€‚\nå·¥å‚æ–¹æ³•(Factory Method)æ¨¡å¼çš„æ„ä¹‰æ˜¯å®šä¹‰ä¸€ä¸ªåˆ›å»ºäº§å“å¯¹è±¡çš„å·¥å‚æ¥å£ï¼Œå°†å®é™…åˆ›å»ºå·¥ä½œæ¨è¿Ÿåˆ°å­ç±»å½“ä¸­ã€‚æ ¸å¿ƒå·¥å‚ç±»ä¸å†è´Ÿè´£äº§å“çš„åˆ›å»ºï¼Œè¿™æ ·æ ¸å¿ƒç±»æˆä¸ºä¸€ä¸ªæŠ½è±¡å·¥å‚è§’è‰²ï¼Œä»…è´Ÿè´£å…·ä½“å·¥å‚å­ç±»å¿…é¡»å®ç°çš„æ¥å£ï¼Œè¿™æ ·è¿›ä¸€æ­¥æŠ½è±¡åŒ–çš„å¥½å¤„æ˜¯ä½¿å¾—å·¥å‚æ–¹æ³•æ¨¡å¼å¯ä»¥ä½¿ç³»ç»Ÿåœ¨ä¸ä¿®æ”¹å…·ä½“å·¥å‚è§’è‰²çš„æƒ…å†µä¸‹å¼•è¿›æ–°çš„äº§å“ã€‚\n```java\npublic interface MyPhone {\n    String phoneName();\n}\n\npublic class IPhone implements MyPhone{\n    @Override\n    public String phoneName() {\n        return \"IPhone\";\n    }\n}\n\npublic class OnePlus implements MyPhone{\n    @Override\n    public String phoneName() {\n        return \"OnePlus\";\n    }\n}\n\npublic class FactoryMethods {\n    public static void main(String[] args) {\n        MyPhone iphone =new IPhone();\n        MyPhone onePlus=new OnePlus();\n        System.out.println(iphone.phoneName());\n        System.out.println(onePlus.phoneName());\n    }\n}\n```\n\n### 2.3 æŠ½è±¡å·¥å‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/1csnvnvVlK288sobKlH0ZlGv)\næŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰æ˜¯å›´ç»•ä¸€ä¸ªè¶…çº§å·¥å‚åˆ›å»ºå…¶ä»–å·¥å‚ã€‚è¯¥è¶…çº§å·¥å‚åˆç§°ä¸ºå…¶ä»–å·¥å‚çš„å·¥å‚ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚\n\nåœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œæ¥å£æ˜¯è´Ÿè´£åˆ›å»ºä¸€ä¸ªç›¸å…³å¯¹è±¡çš„å·¥å‚ï¼Œä¸éœ€è¦æ˜¾å¼æŒ‡å®šå®ƒä»¬çš„ç±»ã€‚æ¯ä¸ªç”Ÿæˆçš„å·¥å‚éƒ½èƒ½æŒ‰ç…§å·¥å‚æ¨¡å¼æä¾›å¯¹è±¡ã€‚\n\n## ä¸‰ã€ä»£ç†æ¨¡å¼\n### 3.1 é™æ€ä»£ç†\né™æ€ä»£ç†æ˜¯ç”±ç¨‹åºå‘˜åˆ›å»ºæˆ–ç‰¹å®šå·¥å…·è‡ªåŠ¨ç”Ÿæˆæºä»£ç ï¼Œåœ¨å¯¹å…¶ç¼–è¯‘ã€‚åœ¨ç¨‹åºå‘˜è¿è¡Œä¹‹å‰ï¼Œä»£ç†ç±».classæ–‡ä»¶å°±å·²ç»è¢«åˆ›å»ºäº†ã€‚\n```java\npublic interface BuyHouse {\n    void buyHouse();\n}\n\n\npublic class BuyHouseImpl implements BuyHouse {\n    @Override\n    public void buyHouse() {\n        System.out.println(\"æˆ‘è¦ä¹°æˆ¿\");\n    }\n}\n\n\npublic class BuyHouseProxy implements BuyHouse {\n    private BuyHouse buyHouse;\n\n    public BuyHouseProxy(final BuyHouse buyHouse) {\n        this.buyHouse = buyHouse;\n    }\n\n    @Override\n    public void buyHouse() {\n        System.out.println(\"ä¹°æˆ¿å‰å‡†å¤‡\");\n        buyHouse.buyHouse();\n        System.out.println(\"ä¹°å®Œäº†\");\n    }\n}\n\n\npublic class ProxyTest {\n    public static void main(String[] args) {\n        BuyHouse buyHouse = new BuyHouseImpl();\n        BuyHouseProxy buyHouseProxy = new BuyHouseProxy(buyHouse);\n        buyHouseProxy.buyHouse();\n    }\n}\n```\n\n### 3.2 JDKä»£ç†\nåœ¨åŠ¨æ€ä»£ç†ä¸­æˆ‘ä»¬ä¸å†éœ€è¦å†æ‰‹åŠ¨çš„åˆ›å»ºä»£ç†ç±»ï¼Œæˆ‘ä»¬åªéœ€è¦ç¼–å†™ä¸€ä¸ªåŠ¨æ€å¤„ç†å™¨å°±å¯ä»¥äº†ã€‚çœŸæ­£çš„ä»£ç†å¯¹è±¡ç”±JDKå†è¿è¡Œæ—¶ä¸ºæˆ‘ä»¬åŠ¨æ€çš„æ¥åˆ›å»ºã€‚JDKå®ç°åŠ¨æ€ä»£ç†éœ€è¦å®ç°ç±»é€šè¿‡æ¥å£å®šä¹‰ä¸šåŠ¡æ–¹æ³•ã€‚\n```java\npublic class ProxyMethod implements InvocationHandler {\n    private Object object;\n    public ProxyMethod(final Object o){\n        this.object=o;\n    }\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        System.out.println(\"ä¹°æˆ¿å‡†å¤‡\");\n        Object o=method.invoke(object,args);\n        System.out.println(\"ä¹°å®Œäº†\");\n        return null;\n    }\n}\n\npublic class ProxyTest {\n    public static void main(String[] args) {\n        BuyHouse buyHouse = new BuyHouseImpl();\n        BuyHouse proxyBuyHouse = (BuyHouse) Proxy.newProxyInstance(BuyHouse.class.getClassLoader(),\n                new Class[]{BuyHouse.class}, new ProxyMethod(buyHouse));\n        proxyBuyHouse.buyHouse();\n    }\n}\n\n```\næ³¨æ„Proxy.newProxyInstance()æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/TiwxuCF60cFc8JN38NK7meIx)\n- ClassLoader loader:æŒ‡å®šå½“å‰ç›®æ ‡å¯¹è±¡ä½¿ç”¨çš„ç±»åŠ è½½å™¨,è·å–åŠ è½½å™¨çš„æ–¹æ³•æ˜¯å›ºå®šçš„\n- Class<?>[] interfaces:æŒ‡å®šç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£çš„ç±»å‹,ä½¿ç”¨æ³›å‹æ–¹å¼ç¡®è®¤ç±»å‹\n- InvocationHandler:æŒ‡å®šåŠ¨æ€å¤„ç†å™¨ï¼Œæ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•æ—¶,ä¼šè§¦å‘äº‹ä»¶å¤„ç†å™¨çš„æ–¹æ³•\n\n\n### 3.3 CGLIBä»£ç†\nå¯¹äºæ²¡æœ‰æ¥å£çš„ç±»ï¼Œå¦‚ä½•å®ç°åŠ¨æ€ä»£ç†å‘¢ï¼Œè¿™å°±éœ€è¦CGLibäº†ã€‚CGLibé‡‡ç”¨äº†éå¸¸åº•å±‚çš„å­—èŠ‚ç æŠ€æœ¯ï¼Œå…¶åŸç†æ˜¯é€šè¿‡å­—èŠ‚ç æŠ€æœ¯ä¸ºä¸€ä¸ªç±»åˆ›å»ºå­ç±»ï¼Œå¹¶åœ¨å­ç±»ä¸­é‡‡ç”¨æ–¹æ³•æ‹¦æˆªçš„æŠ€æœ¯æ‹¦æˆªæ‰€æœ‰çˆ¶ç±»æ–¹æ³•çš„è°ƒç”¨ï¼Œé¡ºåŠ¿ç»‡å…¥æ¨ªåˆ‡é€»è¾‘ã€‚ä½†å› ä¸ºé‡‡ç”¨çš„æ˜¯ç»§æ‰¿ï¼Œæ‰€ä»¥ä¸èƒ½å¯¹finalä¿®é¥°çš„ç±»è¿›è¡Œä»£ç†ã€‚JDKåŠ¨æ€ä»£ç†ä¸CGLibåŠ¨æ€ä»£ç†å‡æ˜¯å®ç°Spring AOPçš„åŸºç¡€ã€‚\nCGLIBåˆ›å»ºçš„åŠ¨æ€ä»£ç†å¯¹è±¡æ¯”JDKåˆ›å»ºçš„åŠ¨æ€ä»£ç†å¯¹è±¡çš„æ€§èƒ½æ›´é«˜ï¼Œä½†æ˜¯CGLIBåˆ›å»ºä»£ç†å¯¹è±¡æ—¶æ‰€èŠ±è´¹çš„æ—¶é—´å´æ¯”JDKå¤šå¾—å¤šã€‚æ‰€ä»¥å¯¹äºå•ä¾‹çš„å¯¹è±¡ï¼Œå› ä¸ºæ— éœ€é¢‘ç¹åˆ›å»ºå¯¹è±¡ï¼Œç”¨CGLIBåˆé€‚ï¼Œåä¹‹ä½¿ç”¨JDKæ–¹å¼è¦æ›´ä¸ºåˆé€‚ä¸€äº›ã€‚åŒæ—¶ç”±äºCGLibç”±äºæ˜¯é‡‡ç”¨åŠ¨æ€åˆ›å»ºå­ç±»çš„æ–¹æ³•ï¼Œå¯¹äºfinalä¿®é¥°çš„æ–¹æ³•æ— æ³•è¿›è¡Œä»£ç†ã€‚\n\n> ç”±äºcglibæ˜¯ç¬¬ä¸‰æ–¹å®ç°çš„ï¼Œéœ€è¦è‡ªå·±å…ˆå¼•å…¥cglibåŒ…æˆ–è€…ç›´æ¥å¼•å…¥springåŒ…\n\n```java\npublic class CglibProxy implements MethodInterceptor {\n\n    private Object object;\n\n    public Object getInstance(Object o){\n        this.object=o;\n        Enhancer enhancer=new Enhancer();\n        enhancer.setSuperclass(this.object.getClass());\n        enhancer.setCallback(this);\n        return enhancer.create();\n    }\n\n    @Override\n    public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable {\n        System.out.println(\"ä¹°æˆ¿å‰å‡†å¤‡\");\n        Object result = methodProxy.invokeSuper(o, objects);\n        System.out.println(\"ä¹°æˆ¿åè£…ä¿®\");\n        return result;\n    }\n}\n\npublic class CglibTest {\n    public static void main(String[] args) {\n        BuyHouse buyHouse = new BuyHouseImpl();\n        CglibProxy cglibProxy = new CglibProxy();\n        BuyHouseImpl buyHouse1 = (BuyHouseImpl) cglibProxy.getInstance(buyHouse);\n        buyHouse1.buyHouse();\n    }\n}\n```\nè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯`intercept`ä¸­è¦ä½¿ç”¨`methodProxy.invokeSuper(o,objects)`æ–¹æ³•ã€‚ä½¿ç”¨`invoke`å°†ä¼šå‘ç”Ÿæ­»å¾ªç¯ã€‚ï¼ˆå…·ä½“åŸå› å¾…è¡¥å……ï¼‰\n\n## å››ã€é€‚é…å™¨æ¨¡å¼\né€‚é…å™¨æ¨¡å¼(Adapter Pattern)ï¼šå°†ä¸€ä¸ªæ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œä½¿æ¥å£ä¸å…¼å®¹çš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œï¼Œå…¶åˆ«åä¸ºåŒ…è£…å™¨(Wrapper)ã€‚é€‚é…å™¨æ¨¡å¼æ—¢å¯ä»¥ä½œä¸ºç±»ç»“æ„å‹æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚\nåœ¨é€‚é…å™¨æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¢åŠ ä¸€ä¸ªæ–°çš„é€‚é…å™¨ç±»æ¥è§£å†³æ¥å£ä¸å…¼å®¹çš„é—®é¢˜ï¼Œä½¿å¾—åŸæœ¬æ²¡æœ‰ä»»ä½•å…³ç³»çš„ç±»å¯ä»¥ååŒå·¥ä½œã€‚\næ ¹æ®é€‚é…å™¨ç±»ä¸é€‚é…è€…ç±»çš„å…³ç³»ä¸åŒï¼Œé€‚é…å™¨æ¨¡å¼å¯åˆ†ä¸ºå¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨ä¸¤ç§ï¼Œåœ¨å¯¹è±¡é€‚é…å™¨æ¨¡å¼ä¸­ï¼Œé€‚é…å™¨ä¸é€‚é…è€…ä¹‹é—´æ˜¯å…³è”å…³ç³»ï¼›åœ¨ç±»é€‚é…å™¨æ¨¡å¼ä¸­ï¼Œé€‚é…å™¨ä¸é€‚é…è€…ä¹‹é—´æ˜¯ç»§æ‰¿ï¼ˆæˆ–å®ç°ï¼‰å…³ç³»ã€‚\n- ç±»é€‚é…å™¨\né¦–å…ˆæœ‰ä¸€ä¸ªå·²å­˜åœ¨çš„å°†è¢«é€‚é…çš„ç±»,å®šä¹‰ä¸€ä¸ªç›®æ ‡æ¥å£,æ€ä¹ˆæ‰å¯ä»¥åœ¨ç›®æ ‡æ¥å£ä¸­çš„ request() è°ƒç”¨ Adaptee çš„ adapteeRequest() æ–¹æ³•å‘¢ï¼Ÿé€šè¿‡ä¸€ä¸ªé€‚é…å™¨ç±»ï¼Œå®ç° Target æ¥å£ï¼ŒåŒæ—¶ç»§æ‰¿äº† Adaptee ç±»ï¼Œç„¶ååœ¨å®ç°çš„ request() æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»çš„ adapteeRequest() å³å¯å®ç°\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/YpGMLnrDXbKhEC4xuW1MYbcb)\n\n```java\npublic interface Target {\n    void request();\n}\n\npublic class ConcreteTarget implements Target {\n    @Override\n    public void request() {\n        System.out.println(\"concreteTargetç›®æ ‡æ–¹æ³•\");\n    }\n}\n\n\npublic class Adaptee {\n    public void adapteeRequest() {\n        System.out.println(\"è¢«é€‚é…è€…çš„æ–¹æ³•\");\n    }\n}\n\npublic class Adapter extends Adaptee implements Target {\n\n    @Override\n    public void request() {\n        super.adapteeRequest();\n    }\n}\n\npublic class Test {\n    public static void main(String[] args) {\n        Target target = new ConcreteTarget();\n        target.request();\n\n        Target adapterTarget = new Adapter();\n        adapterTarget.request();\n    }\n}\n```\n\n- å¯¹è±¡é€‚é…å™¨\nå¯¹è±¡é€‚é…å™¨ä¸ç±»é€‚é…å™¨ä¸åŒä¹‹å¤„åœ¨äºï¼Œç±»é€‚é…å™¨é€šè¿‡ç»§æ‰¿æ¥å®Œæˆé€‚é…ï¼Œå¯¹è±¡é€‚é…å™¨åˆ™æ˜¯é€šè¿‡å…³è”æ¥å®Œæˆï¼Œè¿™é‡Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹ Adapter ç±»å³å¯å°†è½¬å˜ä¸ºå¯¹è±¡é€‚é…å™¨ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/scUyDpbIOMjQ01EwnOaV41UJ)\n\n```java\npublic class Adapter implements Target {\n    // é€‚é…è€…æ˜¯å¯¹è±¡é€‚é…å™¨çš„ä¸€ä¸ªå±æ€§\n    private Adaptee adaptee = new Adaptee();\n\n    @Override\n    public void request() {\n        adaptee.adapteeRequest();\n    }\n}\n```\n\næ³¨æ„è¿™é‡Œçš„ Adapter æ˜¯å°† Adaptee ä½œä¸ºä¸€ä¸ªæˆå‘˜å±æ€§ï¼Œè€Œä¸æ˜¯ç»§æ‰¿å®ƒ\n\n');
INSERT INTO `blog_content` VALUES (57, '# è®¡ç®—æœºç½‘ç»œ\n### [TCP å¸¸è§é¢è¯•é¢˜](https://zhuanlan.zhihu.com/p/87310327)\n### [TCPè¿æ¥æ‹¥å¡æ§åˆ¶å››ç§æ–¹æ³•æ€»ç»“ï¼ˆè¯¦ç»†ç®€å•ï¼Œç¨³çš„ä¸€æ‰¹ï¼‰](https://blog.csdn.net/qq_26896213/article/details/84594060?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task)\n### [Httpä¸­200ã€302ã€304ã€404å’Œ500ç­‰å“åº”çŠ¶æ€ç æ‰€è¡¨ç¤ºçš„æ„ä¹‰ï¼Ÿ](https://blog.csdn.net/qq_44066201/article/details/100518914)\n\n# Java\n### [javaä¸­çš„å„ç§é”è¯¦ç»†ä»‹ç»](https://www.cnblogs.com/jyroy/p/11365935.html)\n### [æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰å’Œè¿‡æ»¤å™¨ï¼ˆFilterï¼‰çš„æ‰§è¡Œé¡ºåºå’ŒåŒºåˆ«](https://blog.csdn.net/zxd1435513775/article/details/80556034)\n### [æ·±å…¥ç†è§£CyclicBarrieråŸç†](https://blog.csdn.net/qq_39241239/article/details/87030142)\n### [è®¾è®¡æ¨¡å¼ | é€‚é…å™¨æ¨¡å¼åŠå…¸å‹åº”ç”¨](https://blog.csdn.net/wwwdc1012/article/details/82780560)\n### [å­¦ä¹ ã€æ¢ç©¶Javaè®¾è®¡æ¨¡å¼â€”â€”è£…é¥°è€…æ¨¡å¼](https://blog.csdn.net/a553181867/article/details/52108423)\n### [javaåŒäº²å§”æ´¾æ¨¡å‹](https://www.jianshu.com/p/9df9d318e838)\n### [Bæ ‘ã€B-æ ‘ã€B+æ ‘ã€B*æ ‘ä¹‹é—´çš„å…³ç³»](https://blog.csdn.net/u013411246/article/details/81088914)\n### [é¢è¯•é¢˜ï¼šBï¼ˆB-ï¼‰æ ‘ï¼ŒB+æ ‘ï¼ŒBæ ‘å’ŒB+æ ‘çš„åŒºåˆ«ï¼ŒBæ ‘å’ŒB+æ ‘çš„ä¼˜ç‚¹](https://blog.csdn.net/weixin_42228338/article/details/97684517)\n### [JAVAä¸ä½¿ç”¨ä¸­é—´å˜é‡ï¼Œå®ç°ä¸¤ä¸ªæ•°çš„äº¤æ¢](https://blog.csdn.net/qq1608731824/article/details/81449508)\n### [Javaæ•°æ®ç»“æ„å’Œç®—æ³•ï¼ˆåä¸€ï¼‰â€”â€”çº¢é»‘æ ‘](https://www.cnblogs.com/ysocean/p/8004211.html)\n\n# Redis\n### [å›¾è§£Redisä¹‹æ•°æ®ç»“æ„ç¯‡â€”â€”è·³è·ƒè¡¨](https://www.cnblogs.com/hunternet/p/11248192.html)\n\n# MySQL\n### [æ•°æ®åº“ä¸‰å¤§èŒƒå¼æœ€ç®€å•çš„è§£é‡Š](https://blog.csdn.net/andywuchuanlong/article/details/25913235?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task)\n### [MySqlå­˜å‚¨å¼•æ“å’Œç´¢å¼•åŸç†](https://blog.csdn.net/xc123_java/article/details/89350332)\n### [MySQLç´¢å¼•åŸç†](https://www.cnblogs.com/iwenwen/p/11052766.html)\n### [èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•(é€šä¿—æ˜“æ‡‚ è¨€ç®€æ„èµ…)](https://www.cnblogs.com/jiawen010/p/11805241.html)\n\n# Spring \n### [springæ‰§è¡Œæµç¨‹](https://blog.csdn.net/xuebaobao130526/article/details/80831412)(è¿™æ˜¯SpringMVC)\n');
INSERT INTO `blog_content` VALUES (58, 'æœ¬æ–‡ç« å¯¹åº”ä»£ç åœ°å€ï¼š[github-NIO](https://github.com/yhuihu/Java-Study/tree/master/NIO)\n## ä¸€ã€äº†è§£IOä¸NIOåŒºåˆ«\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/Noa9o99Wg7E2Wi7sFglL6Ybj)\n\n## äºŒã€åˆè§Bufferç¼“å†²åŒº\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/iWflUQfv3EcWt3y9L4jCw9o6)\n\n### 2.1 éç›´æ¥ç¼“å†²åŒº ï¼š`allocate()`æ–¹æ³•åˆ›å»º`Buffer`\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ur332TjhRyK6A8xp2WoPO17W)\n\n### 2.2 ç›´æ¥ç¼“å†²åŒº ï¼š`allocateDirect()`æ–¹æ³•åˆ›å»º`Buffer`\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/LzPVD34BXDJm7P5XlkD1eLVx)\n\n### 2.3 å¯¹`Buffer`çš„æ“ä½œï¼š\n`Buffer`æœ‰è®¸å¤šç±»å‹ï¼Œåœ¨åŸºæœ¬æ•°æ®ç±»å‹å½“ä¸­ï¼Œé™¤äº†`boolean`ï¼Œå…¶ä»–éƒ½æœ‰å¯¹åº”çš„`Buffer`ï¼Œå¦‚ï¼š`ByteBuffer`ã€`CharBuffer`ã€`ShortBuffer`ã€`LongBuffer`ã€`IntBuffer`ã€`DoubleBuffer`ã€`FloatBuffer`ï¼Œä»¥ä¸‹é€šè¿‡`ByteBuffer`ä»£ç è¿›è¡Œå±•ç¤ºã€‚é¦–å…ˆæˆ‘ä»¬æ‰“å¼€æºç å¯ä»¥çŸ¥é“ä»–ä»¬éƒ½ç»§æ‰¿äº†`Buffer`ç±»ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/CfZT3EvmQF6nEmHuPyxDM0cA)\n`Buffer`ç±»å››å¤§æ ¸å¿ƒå±æ€§ï¼š\n- `mark`ï¼šæ ‡è®°ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨`reset()`æ–¹æ³•æ—¶ï¼Œ`position`å°†å›åˆ°è¯¥ä½ç½®\n- `position`ï¼šä¸ªäººç†è§£ä¸ºæ¸¸æ ‡ï¼Œç”¨äºè®°å½•å½“å‰æ“ä½œåˆ°ä»€ä¹ˆä½ç½®\n- `limit`ï¼šé™åˆ¶å¤§å°ï¼Œåœ¨å†™`Buffer`æ—¶å¯¹åº”æ€»å¤§å°ï¼ˆå³`allocate`çš„å¤§å°ï¼‰ã€‚åœ¨è¯»æ—¶å¯¹åº”å½“å‰`Buffer`çš„æ•°æ®é•¿åº¦ï¼ˆæ¯”å¦‚å¾€`Buffer`ä¸­å†™å…¥3ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆ`limit`ä¸º3ï¼‰\n- `capcity`ï¼šæ€»å¤§å°\n\n`Buffer`æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªæ–¹æ³•ä¸ºï¼š`put()`å’Œ\'get()\'ï¼Œåˆ†åˆ«å¯¹åº”å­˜å’Œå–\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/vQ8aC4VwzW4Di2XB9UQGmZUz)\n\n> æ³¨æ„ï¼šè¿›å…¥è¯»æ¨¡å¼æ—¶éœ€è¦è°ƒç”¨`flip()`æ–¹æ³•\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/UvBgZ8s1eJJ8GVmdtDQFN8oi)\n\n```java\npublic class BufferTest {\n    public static void main(String[] args) {\n        //        ç›´æ¥ç¼“å†²åŒº\n        ByteBuffer buffer = ByteBuffer.allocateDirect(1024);\n        System.out.println(\"-----------allocateDirect----------\");\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n\n        System.out.println(\"-----------put----------\");\n        buffer.put(\"abcdefg\".getBytes());\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n\n        System.out.println(\"-----------flip----------\");\n        buffer.flip();\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n\n        System.out.println(\"-----------ç¬¬ä¸€æ¬¡get----------\");\n        byte[] bt = new byte[buffer.limit()];\n        //        offsetè¡¨ç¤ºç¬¬å‡ ä¸ªå¼€å§‹ï¼Œlengthè¡¨ç¤ºé€‰å¤šå°‘ä¸ª\n        buffer.get(bt, 0, 2);\n        System.out.println(\"å–å‡ºçš„æ•°æ®ä¸ºï¼š\" + new String(bt));\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n\n        System.out.println(\"-----------ç¬¬äºŒæ¬¡get----------\");\n        buffer.mark();\n        byte[] bt1 = new byte[buffer.limit()];\n        //        offsetè¡¨ç¤ºç¬¬å‡ ä¸ªå¼€å§‹ï¼Œlengthè¡¨ç¤ºé€‰å¤šå°‘ä¸ª\n        buffer.get(bt1, 2, 2);\n        System.out.println(\"å–å‡ºçš„æ•°æ®ä¸ºï¼š\" + new String(bt1));\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n\n        System.out.println(\"-----------reset----------\");\n        buffer.reset();\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n\n        System.out.println(\"-----------rewind----------\");\n        buffer.rewind();\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n\n        System.out.println(\"-----------remind----------\");\n        if (buffer.hasRemaining()) {\n//            æ˜¾ç¤ºå¯æ“ä½œæ•°é‡\n            System.out.println(buffer.remaining());\n        }\n\n        System.out.println(\"-----------clear----------\");\n//        æ³¨æ„ï¼šæ•°æ®è¿˜å­˜åœ¨ï¼Œåªæ˜¯ä½ç½®å›åˆ°äº†æœ€å¼€å§‹çš„ä½ç½®ï¼Œæ•°æ®å¤„äºè¢«é—å¿˜çŠ¶æ€\n        buffer.clear();\n        System.out.println(\"position:\" + buffer.position());\n        System.out.println(\"limit:\" + buffer.limit());\n        System.out.println(\"capacity:\" + buffer.capacity());\n        System.out.println(\"data:\" + (char) (buffer.get()));\n    }\n}\n```\nè¿è¡Œç»“æœï¼š\n```txt\n-----------allocateDirect----------\nposition:0\nlimit:1024\ncapacity:1024\n-----------put----------\nposition:7\nlimit:1024\ncapacity:1024\n-----------flip----------\nposition:0\nlimit:7\ncapacity:1024\n-----------ç¬¬ä¸€æ¬¡get----------\nå–å‡ºçš„æ•°æ®ä¸ºï¼šab     \nposition:2\nlimit:7\ncapacity:1024\n-----------ç¬¬äºŒæ¬¡get----------\nå–å‡ºçš„æ•°æ®ä¸ºï¼š  cd   \nposition:4\nlimit:7\ncapacity:1024\n-----------reset----------\nposition:2\nlimit:7\ncapacity:1024\n-----------rewind----------\nposition:0\nlimit:7\ncapacity:1024\n-----------remind----------\n7\n-----------clear----------\nposition:0\nlimit:1024\ncapacity:1024\ndata:a\nPicked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF-8\n\nProcess finished with exit code 0\n```\n\n## ä¸‰ã€é€šé“ï¼ˆChannelï¼‰\n### 3.1 æ²¡æœ‰é€šé“å‰ï¼Œä½¿ç”¨DMAæ€»çº¿\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/TIBrXf9zo8wilQQ6V91XIx8p)\nå½“æœ‰å¤§é‡I/Oè¯·æ±‚æ—¶ï¼Œcpuåˆ©ç”¨ç‡ä½ï¼Œå› ä¸ºéœ€è¦è¯·æ±‚cpuè·å–èµ„æºã€‚\n\n### 3.2 ä½¿ç”¨é€šé“å\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/q9z0GhNy552dpEqovZIwiXP4)\né€šé“æ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å¤„ç†å™¨ï¼Œä¸“é—¨ç”¨äºI/Oæ“ä½œï¼Œæœ‰è‡ªå·±çš„å‘½ä»¤ï¼Œé™„å±äºCPUã€‚å°±ç®—æœ‰å¤§é‡è¯·æ±‚ï¼Œä¹Ÿä¸éœ€è¦å‘cpuè¯·æ±‚ã€‚\n\n### 3.3 é€šé“çš„ä½¿ç”¨\né€šé“ç”¨äºæºèŠ‚ç‚¹ä¸ç›®æ ‡èŠ‚ç‚¹çš„è¿æ¥ã€‚åœ¨`Java NIO`ä¸­è´Ÿè´£ç¼“å†²åŒºä¸­æ•°æ®çš„ä¼ è¾“ã€‚`Channel`æœ¬èº«ä¸å­˜å‚¨æ•°æ®ï¼Œå› æ­¤éœ€è¦é…åˆç¼“å†²åŒºè¿›è¡Œä¼ è¾“ã€‚\n#### 3.3.1é€šé“ä¸»è¦çš„å®ç°ç±»ï¼š\n- `FileChannel`ï¼šæ–‡ä»¶æ“ä½œé€šé“\n- `SocketChannel`ï¼šTCP\n- `ServerSocketChannel`ï¼šTCP\n- `DatagramChannel`ï¼šUDP\n\n#### 3.3.2è·å–é€šé“çš„æ–¹å¼ï¼š\n1. `Java`é’ˆå¯¹æ”¯æŒé€šé“çš„ç±»æä¾›äº†`getChannel()`æ–¹æ³•\n	1. æœ¬åœ°`IO`ï¼š\n		1. `FileInputStream/FileOutputStream`\n		2. `RandomAccessFile`\n	2. ç½‘ç»œ`IO`ï¼š\n		1. `Socket`\n		2. `ServerSocket`\n		3. `DatagramSocket`\n2. åœ¨`JDK 1.7`ä¸­çš„`NIO.2`é’ˆå¯¹å„ä¸ªé€šé“æä¾›äº†é™æ€æ–¹æ³•`open()`\n3. åœ¨`JDK 1.7`ä¸­çš„`NIO.2`çš„`Files`å·¥å…·ç±»çš„`newByteChannel`\n\n#### 3.3.3 ä»£ç å®ç°é€šé“æ–‡ä»¶å¤åˆ¶\n```java\npublic class ChannelTest {\n\n    //åˆ©ç”¨é€šé“å®Œæˆæ–‡ä»¶å¤åˆ¶ï¼ˆéç›´æ¥ç¼“å†²åŒºï¼‰\n    @Test\n    public void test1() throws IOException {\n        long start = System.currentTimeMillis();\n        FileInputStream fileInputStream = new FileInputStream(new File(\"D:\\\\èµ„æº\\\\1.mp4\"));\n        FileOutputStream fileOutputStream = new FileOutputStream(new File(\"D:\\\\èµ„æº\\\\2.mp4\"));\n        FileChannel channel = fileInputStream.getChannel();\n        FileChannel channel1 = fileOutputStream.getChannel();\n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        while (channel.read(byteBuffer) != -1) {\n            byteBuffer.flip();\n            channel1.write(byteBuffer);\n            byteBuffer.clear();\n        }\n        long end = System.currentTimeMillis();\n        System.out.println(end - start);\n        channel.close();\n        channel1.close();\n        fileInputStream.close();\n        fileOutputStream.close();\n    }\n\n    @Test\n    public void test2() throws IOException {\n        long start = System.currentTimeMillis();\n        FileChannel inputChannel = FileChannel.open(Paths.get(\"D:\\\\èµ„æº\\\\1.mp4\"), StandardOpenOption.READ);\n        FileChannel outputChannel = FileChannel.open(Paths.get(\"D:\\\\èµ„æº\\\\2.mp4\"), StandardOpenOption.READ, StandardOpenOption.WRITE, StandardOpenOption.CREATE);\n//        å†…å­˜æ˜ å°„æ–‡ä»¶\n        MappedByteBuffer map = inputChannel.map(FileChannel.MapMode.READ_ONLY, 0, inputChannel.size());\n        MappedByteBuffer map1 = outputChannel.map(FileChannel.MapMode.READ_WRITE, 0, inputChannel.size());\n        byte[] bytes=new byte[map.limit()];\n        map.get(bytes);\n        map1.put(bytes);\n        long end = System.currentTimeMillis();\n        System.out.println(end - start);\n        inputChannel.close();\n        outputChannel.close();\n    }\n\n    //é€šé“é—´ç›´æ¥ä¼ è¾“ï¼ˆç›´æ¥ç¼“å†²åŒºï¼‰\n    @Test\n    public void test3() throws IOException {\n        long start = System.currentTimeMillis();\n        FileChannel inputChannel = FileChannel.open(Paths.get(\"D:\\\\èµ„æº\\\\1.mp4\"), StandardOpenOption.READ);\n        FileChannel outputChannel = FileChannel.open(Paths.get(\"D:\\\\èµ„æº\\\\2.mp4\"), StandardOpenOption.READ, StandardOpenOption.WRITE, StandardOpenOption.CREATE);\n        inputChannel.transferTo(0, inputChannel.size(), outputChannel);\n//        outputChannel.transferFrom(inputChannel,0,inputChannel.size());\n        inputChannel.close();\n        outputChannel.close();\n        long end = System.currentTimeMillis();\n        System.out.println(end - start);\n    }\n\n//    åˆ†æ•£è¯»å–ï¼Œèšé›†å†™å…¥\n    @Test\n    public void test4() throws IOException {\n        RandomAccessFile randomAccessFile=new RandomAccessFile(\"C:\\\\Users\\\\Admin\\\\Desktop\\\\æ–°å»ºæ–‡æœ¬æ–‡æ¡£.txt\",\"rw\");\n        FileChannel fileChannel=randomAccessFile.getChannel();\n        ByteBuffer buffer1=ByteBuffer.allocate(100);\n        ByteBuffer buffer2=ByteBuffer.allocate(1024);\n        ByteBuffer[] byteBuffers={buffer1,buffer2};\n        fileChannel.read(byteBuffers);\n        for (ByteBuffer byteBuffer : byteBuffers) {\n            byteBuffer.flip();\n        }\n        System.out.println(new String(byteBuffers[0].array(),0,byteBuffers[0].limit()));\n        System.out.println(new String(byteBuffers[1].array(),0,byteBuffers[1].limit()));\n        RandomAccessFile randomAccessFile1=new RandomAccessFile(\"2.txt\",\"rw\");\n        FileChannel fileChannel1=randomAccessFile1.getChannel();\n        fileChannel1.write(byteBuffers);\n        fileChannel1.close();\n        fileChannel.close();\n    }\n}\n```\n\n## å››ã€ç½‘ç»œé€šä¿¡\n\n### 4.1 ä¸‰å¤§æ ¸å¿ƒ\n- é€šé“ï¼ˆ`Channel`ï¼‰:è´Ÿè´£è¿æ¥\n- ç¼“å†²åŒºï¼ˆ`Buffer`ï¼‰ï¼šè´Ÿè´£æ•°æ®çš„å­˜å–\n- é€‰æ‹©å™¨ï¼ˆ`Selector`ï¼‰ï¼šæ˜¯`SelectableChannel`çš„å¤šè·¯å¤ç”¨ã€‚ç”¨äºç›‘æ§`SelectableChannel`çš„IOçŠ¶å†µ\n\n### 4.2 ä»£ç ä½¿ç”¨\né˜»å¡ç‰ˆæœ¬ï¼š\n```java\npublic class Client {\n    public static void main(java.lang.String[] args) throws IOException {\n        // 1.å»ºç«‹è¿æ¥\n        SocketChannel socketChannel = SocketChannel.open(new InetSocketAddress(\"127.0.0.1\", 8888));\n        // 2.è·å–æ–‡ä»¶\n        FileChannel inputChannel = FileChannel.open(Paths.get(\"D:\\\\èµ„æº\\\\èµ„æ–™\\\\ä¸ªäºº\\\\æ¨è¾‰è™1.jpg\"), StandardOpenOption.READ);\n        // 3.åˆ›å»ºç¼“å†²åŒº\n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        // 4.è¯»å–æ•°æ®\n        while (inputChannel.read(byteBuffer) != -1) {\n            byteBuffer.flip();\n            socketChannel.write(byteBuffer);\n            byteBuffer.clear();\n        }\n\n        // 5.å‘Šè¯‰æœåŠ¡ç«¯è‡ªå·±å‘é€å®Œæˆäº†ï¼Œä¸ç„¶ä¼šä¸€ç›´é˜»å¡ï¼Œæ— æ³•è¿›å…¥ä¸‹ä¸€æ­¥\n        socketChannel.shutdownOutput();\n\n        int length = 0;\n        while ((length = socketChannel.read(byteBuffer)) != -1) {\n            byteBuffer.flip();\n            System.out.println(new java.lang.String(byteBuffer.array(), 0, length));\n            byteBuffer.clear();\n        }\n        inputChannel.close();\n        socketChannel.close();\n    }\n}public class Server {\n    public static void main(String[] args) throws IOException {\n        // 1.è·å–é€šé“\n        ServerSocketChannel serverSocketChannel=ServerSocketChannel.open();\n        // 2.æ–‡ä»¶é€šé“\n        FileChannel outChannel = FileChannel.open(Paths.get(\"D:\\\\èµ„æº\\\\2.mp4\"), StandardOpenOption.READ,StandardOpenOption.WRITE,StandardOpenOption.CREATE);\n        // 3.ç»‘å®šè¿æ¥\n        serverSocketChannel.bind(new InetSocketAddress(8888));\n        // 4.è·å–å®¢æˆ·ç«¯è¿æ¥çš„é€šé“\n        SocketChannel accept = serverSocketChannel.accept();\n        // 5.åˆ†é…ç¼“å†²åŒº\n        ByteBuffer byteBuffer=ByteBuffer.allocate(1024);\n        // 6.æ¥æ”¶æ•°æ®\n        while (accept.read(byteBuffer)!=-1){\n            byteBuffer.flip();\n            outChannel.write(byteBuffer);\n            byteBuffer.clear();\n        }\n        outChannel.close();\n        accept.close();\n        serverSocketChannel.close();\n    }\n}\n```\n\néé˜»å¡ç‰ˆæœ¬å…ˆå¼•å…¥å‡ ä¸ªå†…å®¹ï¼š\n- `Selector`ï¼šé€‰æ‹©å™¨\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ajEGNFEhBJBBaRRMji7nnmoC)\n- `SelectionKey`: è¡¨ç¤º`SelectableChannel`å’Œ`Selector`ä¹‹é—´çš„æ³¨å†Œå…³ç³»ã€‚æ¯æ¬¡å‘é€‰æ‹©å™¨æ³¨å†Œé€šé“æ—¶å°±ä¼šé€‰æ‹©ä¸€ä¸ªäº‹ä»¶ï¼ˆé€‰æ‹©é”®ï¼‰ã€‚é€‰æ‹©é”®åŒ…å«ä¸¤ä¸ªè¡¨ç¤ºæœªæ•´æ•°å€¼çš„æ“ä½œé›†ã€‚æ“ä½œé›†çš„æ¯ä¸€ä½éƒ½è¡¨ç¤ºè¯¥é”®çš„é€šé“é”æ”¯æŒçš„ä¸€ç±»å¯é€‰æ‹©æ“ä½œã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/1iKt7i7qqq6QtPxAHdCe1bHj)\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/UWTo16PKwRC47koTsEDu9itn)\n\n```java\npublic class Server {\n    public static void main(String[] args) throws IOException {\n        //1.è·å–é€šé“\n        ServerSocketChannel ssChannel = ServerSocketChannel.open();\n        //2.åˆ‡æ¢éé˜»å¡å¼æ¨¡å¼\n        ssChannel.configureBlocking(false);\n        //3.ç»‘å®šè¿æ¥\n        ssChannel.bind(new InetSocketAddress(9898));\n        //4.è·å–é€‰æ‹©å™¨\n        Selector selector = Selector.open();\n        //5.å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Šï¼Œå¹¶ä¸”æŒ‡å®šâ€œç›‘å¬æ¥æ”¶äº‹ä»¶â€\n        ssChannel.register(selector, SelectionKey.OP_ACCEPT);\n        //6.è½®è¯¢å¼çš„è·å–é€‰æ‹©å™¨ä¸Šå·²ç»â€œå‡†å¤‡å°±ç»ªâ€çš„äº‹ä»¶\n        while (selector.select() > 0) {\n            //7.è·å–å½“å‰é€‰æ‹©å™¨ä¸­æ‰€æœ‰æ³¨å†Œçš„â€œé€‰æ‹©é”®ï¼ˆå·²å°±ç»ªçš„ç›‘å¬äº‹ä»¶ï¼‰â€\n            Iterator<SelectionKey> it = selector.selectedKeys().iterator();\n            while (it.hasNext()) {\n                //8.è·å–å‡†å¤‡â€œå°±ç»ªâ€çš„äº‹ä»¶\n                SelectionKey sk = it.next();\n                //9.åˆ¤æ–­å…·ä½“æ˜¯ä»€ä¹ˆæ—¶é—´å‡†å¤‡å°±ç»ª\n                if (sk.isAcceptable()) {\n                    //10.è‹¥â€œæ¥æ”¶å°±ç»ªâ€ï¼Œè·å–å®¢æˆ·ç«¯è¿æ¥\n                    SocketChannel sChannel = ssChannel.accept();\n                    //11.åˆ‡æ¢éé˜»å¡æ¨¡å¼\n                    sChannel.configureBlocking(false);\n                    //12.å°†è¯¥é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Š\n                    sChannel.register(selector, SelectionKey.OP_READ);\n                } else if (sk.isReadable()) {\n                    //13.è·å–å½“å‰é€‰æ‹©å™¨ä¸Šâ€œè¯»å°±ç»ªâ€çŠ¶æ€çš„é€šé“\n                    SocketChannel sChannel = (SocketChannel) sk.channel();\n                    //14.è¯»å–æ•°æ®\n                    ByteBuffer buf = ByteBuffer.allocate(1024);\n                    int len = 0;\n                    while ((len = sChannel.read(buf)) > 0) {\n                        buf.flip();\n                        System.out.println(new String(buf.array(), 0, len));\n                        buf.clear();\n                    }\n                }\n                //15.å–æ¶ˆé€‰æ‹©é”®SelectionKey\n                it.remove();\n            }\n        }\n    }\n}\n\npublic class Client {\n    public static void main(String[] args) throws IOException {\n        //1.è·å–é€šé“\n        SocketChannel sChannel = SocketChannel.open(new InetSocketAddress(\"127.0.0.1\", 9898));\n        //2.åˆ‡æ¢éé˜»å¡æ¨¡å¼\n        sChannel.configureBlocking(false);\n        //3.åˆ†é…æŒ‡å®šå¤§å°çš„ç¼“å†²åŒº\n        ByteBuffer buf = ByteBuffer.allocate(1024);\n        //4.å‘é€æ•°æ®ç»™æœåŠ¡ç«¯\n        Scanner scan = new Scanner(System.in);\n        while (scan.hasNext()) {\n            String str = scan.next();\n            buf.put((new Date().toString() + \"\\n\" + str).getBytes());\n            buf.flip();\n            sChannel.write(buf);\n            buf.clear();\n        }\n        //5.å…³é—­é€šé“\n        sChannel.close();\n    }\n}\n\n```\n\nUDPæ–¹å¼ï¼š\n```java\npublic class Server {\n    public static void main(String[] args) throws IOException {\n        DatagramChannel dc= DatagramChannel.open();\n        dc.configureBlocking(false);\n        dc.bind(new InetSocketAddress(9898));\n        Selector selector= Selector.open();\n        dc.register(selector, SelectionKey.OP_READ);\n        while(selector.select()>0){\n            Iterator<SelectionKey> it=selector.selectedKeys().iterator();\n            while(it.hasNext()){\n                SelectionKey sk=it.next();\n                if(sk.isReadable()){\n                    ByteBuffer buf= ByteBuffer.allocate(1024);\n                    dc.receive(buf)\n                    ;\n                    buf.flip();\n                    System.out.println(new String(buf.array(),0,buf.limit()));\n                    buf.clear();\n                }\n            }\n            it.remove();\n        }\n    }\n}\n\npublic class Client {\n    public static void main(String[] args) throws IOException {\n        DatagramChannel dc= DatagramChannel.open();\n        dc.configureBlocking(false);\n        ByteBuffer buf= ByteBuffer.allocate(1024);\n        Scanner scan=new Scanner(System.in);\n        while(scan.hasNext()){\n            String str=scan.next();\n            buf.put((new Date().toString()+\"\\n\"+str).getBytes());\n            buf.flip();\n            dc.send(buf, new InetSocketAddress(\"127.0.0.1\", 9898));\n            buf.clear();\n        }\n        dc.close();\n    }\n}\n```');
INSERT INTO `blog_content` VALUES (59, 'å†…å®¹å‚è€ƒå°šç¡…è°·`Netty`æ•™ç¨‹\n## æœ‰äº†NIOï¼Œä¸ºä»€ä¹ˆè¿˜æœ‰Netty\n1. `NIO`ä¸­`epoll`ç©ºè½®è¯¢é—®é¢˜\n[NIOçš„epollç©ºè½®è¯¢bug](https://www.cnblogs.com/JAYIT/p/8241634.html)\n\n2. `NIO`çš„ç±»åº“å’Œ`API`ç¹æ‚ï¼Œä½¿ç”¨éº»çƒ¦ï¼šéœ€è¦æŒæ¡`Selector`ã€`ServerSocketChannel`ã€`SocketChannel`ã€`ByteBuffer`ç­‰ã€‚å…·ä½“å¯ä»¥å‚è€ƒ`NIO`çš„æ–‡ç« \n3. å¼€å‘éš¾åº¦å’Œå·¥ä½œé‡å¤§ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯é¢ä¸´æ–­è¿é‡è¿ã€ç½‘ç»œé—ªæ–­ã€åŠåŒ…è¯»å†™ã€å¤±è´¥ç¼“å­˜ã€ç½‘ç»œæ‹¥å¡å’Œå¼‚å¸¸æµçš„å¤„ç†ç­‰ï¼Œåœ¨`NIO`ä¸­ï¼Œè¿™äº›é—®é¢˜éƒ½éœ€è¦æˆ‘ä»¬è‡ªè¡Œè§£å†³\n4. éœ€è¦ç†Ÿæ‚‰å¤šçº¿ç¨‹ï¼Œå› ä¸º`NIO`ç¼–ç¨‹æ¶‰åŠåˆ°`Reactor`æ¨¡å¼ï¼Œå¿…é¡»å¯¹å¤šçº¿ç¨‹å’Œç½‘ç»œç¼–ç¨‹ååˆ†ç†Ÿæ‚‰ï¼Œæ‰èƒ½ç¼–å†™å‡ºé«˜è´¨é‡ä»£ç \n\n## è®¤è¯†Netty\nå®˜ç½‘ï¼š`https://netty.io/`\nä»¥ä¸‹æ˜¯å®˜ç½‘çš„æè¿°ï¼š\n`Netty is an asynchronous event-driven network application framework\nfor rapid development of maintainable high performance protocol servers & clients.`\n`Netty`æ˜¯ä¸€ä¸ªå¼‚æ­¥åŸºäºäº‹ä»¶é©±åŠ¨çš„ç½‘ç»œåº”ç”¨æ¡†æ¶ï¼Œç”¨æ¥å¿«é€Ÿå¼€å‘é«˜æ€§èƒ½çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/WVDB9Lnc9Sv6Uszb3qgbU8XN)\n\n- `Core`ï¼š`Netty`çš„æ ¸å¿ƒï¼Œé›¶æ‹·è´ã€äº¤äº’APIåº“ã€å¯æ‰©å±•çš„äº‹ä»¶æ¨¡å‹\n- `Protocol Support`ï¼š`Netty`æ”¯æŒçš„åè®®\n- `Transport Services`ï¼šæ”¯æŒçš„ä¼ è¾“æœåŠ¡\n\nå®˜æ–¹æ–‡æ¡£ï¼š`https://netty.io/wiki/user-guide-for-4.x.html`\n\n## `Netty`çš„ä¼˜ç‚¹\n\n## `Netty`çš„çº¿ç¨‹æ¨¡å‹\næ ¹æ®`Reactor`çš„æ•°é‡å’Œå¤„ç†èµ„æºçº¿ç¨‹çš„æ•°é‡ä¸åŒï¼Œæœ‰3ç§å…¸å‹çš„å®ç°ï¼š\n- å•`Reactor`å•çº¿ç¨‹\n- å•`Reactor`å¤šçº¿ç¨‹\n- ä¸»ä»`Reactor`å¤šçº¿ç¨‹\n`Netty`çº¿ç¨‹æ¨¡å‹ä¸»è¦åŸºäºä¸»ä»`Reactor`çº¿ç¨‹æ¨¡å‹åšäº†ä¸€å®šçš„æ”¹è¿›ï¼Œå…¶ä¸­ä¸»ä»`Reactor`å¤šçº¿ç¨‹æ¨¡å‹æœ‰å¤šä¸ª`Reactor`\n\n1. ä¼ ç»Ÿé˜»å¡I/OæœåŠ¡æ¨¡å‹\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/w5RiIShKNsONxt88getU7sYY)\n\n2. `Reactor`æ¨¡å¼ï¼ˆè¿˜æœ‰ååº”å™¨æ¨¡å¼ï¼Œåˆ†å‘è€…æ¨¡å¼ï¼Œé€šçŸ¥è€…æ¨¡å¼å«æ³•ï¼‰\né’ˆå¯¹ä¼ ç»Ÿé˜»å¡I/OæœåŠ¡æ¨¡å‹çš„ä¸¤ä¸ªç¼ºç‚¹ï¼Œæä¾›äº†è§£å†³æ–¹æ¡ˆï¼š\n- åŸºäºI/Oå¤ç”¨æ¨¡å‹ï¼šå¤šä¸ªè¿æ¥å…±ç”¨ä¸€ä¸ªé˜»å¡å¯¹è±¡ï¼Œåº”ç”¨ç¨‹åºåªéœ€è¦åœ¨ä¸€ä¸ªé˜»å¡å¯¹è±¡ç­‰å¾…ï¼Œæ— éœ€é˜»å¡ç­‰å¾…æ‰€æœ‰è¿æ¥ã€‚å½“æŸä¸ªè¿æ¥æœ‰æ–°çš„æ•°æ®å¯ä»¥å¤„ç†æ—¶ï¼Œæ“ä½œç³»ç»Ÿé€šçŸ¥åº”ç”¨ç¨‹åºï¼Œçº¿ç¨‹ä»é˜»å¡çŠ¶æ€è¿”å›ï¼Œå¼€å§‹è¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚\n- åŸºäºçº¿ç¨‹æ± å¤ç”¨çº¿ç¨‹èµ„æºï¼šä¸å¿…å†ä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºçº¿ç¨‹ï¼Œå°†è¿æ¥å®Œæˆåçš„ä¸šåŠ¡å¤„ç†ä»»åŠ¡åˆ†é…ç»™çº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤„ç†å¤šä¸ªè¿æ¥çš„ä¸šåŠ¡ã€‚\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/oyDWAQGT2jzZYiEBzfWBzHxV)\n\nI/Oå¤ç”¨ç»“åˆçº¿ç¨‹æ± ï¼Œå°±æ˜¯`Reactor`æ¨¡å¼åŸºæœ¬æ€æƒ³\n- `Reactor`æ¨¡å¼ï¼Œé€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥åŒæ—¶ä¼ é€’ç»™æœåŠ¡å¤„ç†å™¨çš„æ¨¡å¼ï¼ˆåŸºäºäº‹ä»¶é©±åŠ¨ï¼‰\n- æœåŠ¡å™¨ç«¯ç¨‹åºå¤„ç†ä¼ å…¥çš„å¤šä¸ªè¯·æ±‚ï¼Œå¹¶å°†å®ƒä»¬åŒæ­¥åˆ†æ´¾åˆ°ç›¸åº”çš„å¤„ç†çº¿ç¨‹ï¼Œå› æ­¤`Reactor`æ¨¡å¼ä¹Ÿå«`Dispatcher`æ¨¡å¼\n- `Reactor`æ¨¡å¼ä½¿ç”¨IOå¤ç”¨ç›‘å¬äº‹ä»¶ï¼Œæ”¶åˆ°äº‹ä»¶åï¼Œåˆ†å‘ç»™æŸä¸ªçº¿ç¨‹ï¼ˆè¿›ç¨‹ï¼‰ï¼Œè¿™ç‚¹å°±æ˜¯ç½‘ç»œæœåŠ¡å™¨é«˜å¹¶å‘å¤„ç†çš„å…³é”®\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/UD5Fomqe1CHKXACk6VEuhy65)\n\n3. `Reactor`æ¨¡å¼ä¸­çš„æ ¸å¿ƒ\n- `Reactor`:`Reactor`åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­è¿è¡Œï¼Œè´Ÿè´£ç›‘å¬å’Œåˆ†å‘äº‹ä»¶ï¼Œåˆ†å‘ç»™é€‚å½“çš„å¤„ç†ç¨‹åºæ¥å¯¹IOäº‹ä»¶åšå‡ºååº”ã€‚å®ƒå°±åƒå…¬å¸çš„ç”µè¯æ¥çº¿å‘˜ï¼Œå®ƒæ¥å¬æ¥è‡ªå®¢æˆ·çš„ç”µè¯å¹¶å°†çº¿è·¯è½¬ç§»åˆ°é€‚å½“çš„è”ç³»äººï¼›\n- `Handlers`:å¤„ç†ç¨‹åºæ‰§è¡ŒI/Oäº‹ä»¶è¦å®Œæˆçš„å®é™…æ—¶é—´ï¼Œç±»ä¼¼äºå®¢æˆ·æƒ³è¦ä¸ä¹‹äº¤è°ˆçš„å…¬å¸ä¸­çš„å®é™…å®˜å‘˜ã€‚`Reactor`é€šè¿‡è°ƒåº¦é€‚å½“çš„å¤„ç†ç¨‹åºæ¥å“åº”I/Oäº‹ä»¶ï¼Œå¤„ç†ç¨‹åºæ‰§è¡Œéé˜»å¡æ“ä½œã€‚\n\n## `Reactor`æ¨¡å¼åˆ†ç±»\n- å•`Reactor`å•çº¿ç¨‹ï¼ˆNIOå°±æ˜¯è¿™æ ·çš„ï¼‰\nçº¿ç¨‹æ•°é‡å°‘äº†ï¼Œå¯æ˜¯å¤ªå°‘äº†ï¼Œreadçš„æ—¶å€™è¿˜æ˜¯ä¼šå‡ºç°\"æ’é˜Ÿ\"\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/pX5mHZo3oejJM0CWBnTi7xpD)\n\nè¯´æ˜ï¼š\n1. `Select` æ˜¯å‰é¢ I/Oå¤ç”¨æ¨¡å‹ä»‹ç»çš„æ ‡å‡†ç½‘ç»œç¼–ç¨‹APIï¼Œå¯ä»¥å®ç°åº”ç”¨ç¨‹åºé€šè¿‡ä¸€ä¸ªé˜»å¡å¯¹è±¡ç›‘å¬å¤šè·¯è¿æ¥è¯·æ±‚\n2. `Reactor` å¯¹è±¡é€šè¿‡ `Select` ç›‘æ§å®¢æˆ·ç«¯è¯·æ±‚äº‹ä»¶ï¼Œæ”¶åˆ°äº‹ä»¶åé€šè¿‡ `Dispatch` è¿›è¡Œåˆ†å‘\n3. å¦‚æœæ˜¯å»ºç«‹è¿æ¥è¯·æ±‚äº‹ä»¶ï¼Œåˆ™ç”± Acceptor é€šè¿‡ Accept å¤„ç†è¿æ¥è¯·æ±‚ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª Handler å¯¹è±¡å¤„ç†è¿æ¥å®Œæˆåçš„åç»­ä¸šåŠ¡å¤„ç†\n4. å¦‚æœä¸æ˜¯å»ºç«‹è¿æ¥äº‹ä»¶ï¼Œåˆ™ Reactor ä¼šåˆ†å‘è°ƒç”¨è¿æ¥å¯¹åº”çš„ Handler æ¥å“åº”\n5. Handler ä¼šå®Œæˆ Readâ†’ä¸šåŠ¡å¤„ç†â†’Send çš„å®Œæ•´ä¸šåŠ¡æµç¨‹\n\nç»“åˆå®ä¾‹ï¼šæœåŠ¡å™¨ç«¯ç”¨ä¸€ä¸ªçº¿ç¨‹é€šè¿‡å¤šè·¯å¤ç”¨æå®šæ‰€æœ‰çš„ IO æ“ä½œï¼ˆåŒ…æ‹¬è¿æ¥ï¼Œè¯»ã€å†™ç­‰ï¼‰ï¼Œç¼–ç ç®€å•ï¼Œæ¸…æ™°æ˜äº†ï¼Œä½†æ˜¯å¦‚æœå®¢æˆ·ç«¯è¿æ¥æ•°é‡è¾ƒå¤šï¼Œå°†æ— æ³•æ”¯æ’‘ï¼Œå‰é¢çš„ NIO æ¡ˆä¾‹å°±å±äºè¿™ç§æ¨¡å‹ã€‚\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/stJ4rry7RU6oKaTDbtfN8XV1)\n\n- å•`Reactor`å¤šçº¿ç¨‹\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/jD1t1OZfhEJMID95l3YQUlA4)\n\nè¯´æ˜ï¼š\n1. Reactor å¯¹è±¡é€šè¿‡select ç›‘æ§å®¢æˆ·ç«¯è¯·æ±‚äº‹ä»¶, æ”¶åˆ°äº‹ä»¶åï¼Œé€šè¿‡dispatchè¿›è¡Œåˆ†å‘\n2. å¦‚æœå»ºç«‹è¿æ¥è¯·æ±‚, åˆ™å³Acceptor é€šè¿‡accept å¤„ç†è¿æ¥è¯·æ±‚, ç„¶ååˆ›å»ºä¸€ä¸ªHandlerå¯¹è±¡å¤„ç†å®Œæˆè¿æ¥åçš„å„ç§äº‹ä»¶\n3. å¦‚æœä¸æ˜¯è¿æ¥è¯·æ±‚ï¼Œåˆ™ç”±reactoråˆ†å‘è°ƒç”¨è¿æ¥å¯¹åº”çš„handler æ¥å¤„ç†\n4. handler åªè´Ÿè´£å“åº”äº‹ä»¶ï¼Œä¸åšå…·ä½“çš„ä¸šåŠ¡å¤„ç†, é€šè¿‡read è¯»å–æ•°æ®åï¼Œä¼šåˆ†å‘ç»™åé¢çš„workerçº¿ç¨‹æ± çš„æŸä¸ªçº¿ç¨‹å¤„ç†ä¸šåŠ¡\n5. worker çº¿ç¨‹æ± ä¼šåˆ†é…ç‹¬ç«‹çº¿ç¨‹å®ŒæˆçœŸæ­£çš„ä¸šåŠ¡ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™handler\n6. handleræ”¶åˆ°å“åº”åï¼Œé€šè¿‡send å°†ç»“æœè¿”å›ç»™client\n\n- ä¸»ä»`Reactor`å¤šçº¿ç¨‹\n\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/9zhJyTlSNJd6wCvufEIwaafn)\n\nè¯´æ˜ï¼š\n1. `Reactor`ä¸»çº¿ç¨‹`MainReactor`å¯¹è±¡é€šè¿‡`select`ç›‘å¬è¿æ¥äº‹ä»¶ï¼Œæ”¶åˆ°äº‹ä»¶åï¼Œé€šè¿‡`Acceptor`å¤„ç†è¿æ¥äº‹ä»¶\n2. å½“`Acceptor`å¤„ç†è¿æ¥äº‹ä»¶åï¼Œ`MainReactor`å°†è¿æ¥åˆ†é…ç»™`SubReactor`\n3. `SubReactor`å°†é“¾æ¥åŠ å…¥åˆ°è¿æ¥é˜Ÿåˆ—è¿›è¡Œç›‘å¬ï¼Œå¹¶åˆ›å»º`handler`è¿›è¡Œå„ç§äº‹ä»¶å¤„ç†\n4. å½“æœ‰æ–°äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œ`SubReactor`å°±ä¼šè°ƒç”¨å¯¹åº”çš„`handler`å¤„ç†\n5. `handler`é€šè¿‡`read`è¯»å–æ•°æ®ï¼Œåˆ†å‘ç»™åé¢çš„`worker`çº¿ç¨‹å¤„ç†\n6. `worker`çº¿ç¨‹æ± åˆ†é…ç‹¬ç«‹çš„`worker`çº¿ç¨‹è¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œå¹¶è¿”å›ç»“æœ\n7. `handler`æ”¶åˆ°å“åº”çš„ç»“æœåï¼Œå†é€šè¿‡`send`å°†ç»“æœè¿”å›ç»™`client`\n8. `Reactor`ä¸»çº¿ç¨‹å¯ä»¥å¯¹åº”å¤šä¸ª`Reactor`å­çº¿ç¨‹ï¼Œå³`MainReactor`å¯ä»¥å…³è”å¤šä¸ª`SubReactor`\n\n## `Netty`æ¨¡å‹\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/K5mTKNtHGrOylzz3g7eLH9g6)\n\nè¯´æ˜ï¼š\n1. `Netty`æŠ½è±¡å‡ºä¸¤ç»„çº¿ç¨‹æ± ï¼Œåˆ†åˆ«ä¸º`BossGroup`å’Œ`WorkerGroup`ã€‚`BossGroup`è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥ã€‚`WorkerGroup`è´Ÿè´£ç½‘ç»œçš„è¯»å†™\n2. `BossGroup`å’Œ`WorkerGroup`ç±»å‹éƒ½æ˜¯`NioEventLoopGroup`\n3. `NioEventLoopGroup`ç›¸å½“äºä¸€ä¸ªäº‹ä»¶å¾ªç¯ç»„ï¼Œè¿™ä¸ªç»„ä¸­å«æœ‰å¤šä¸ªäº‹ä»¶å¾ªç¯ï¼Œæ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯æ˜¯`NioEventLoop`\n4. `NioEventLoop`è¡¨ç¤ºä¸€ä¸ªä¸æ–­å¾ªç¯çš„æ‰§è¡Œå¤„ç†ä»»åŠ¡çš„çº¿ç¨‹ï¼Œæ¯ä¸ª`NioEventLoop`éƒ½æœ‰ä¸€ä¸ª`selector`ï¼Œç”¨äºç›‘å¬ç»‘å®šåœ¨å…¶ä¸Šçš„`socket`ç½‘ç»œé€šè®¯\n5. `NioEventLoopGroup`å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå³å¯ä»¥å«æœ‰å¤šä¸ªè´µ`NioEventLoop`\n6. æ¯ä¸ª`BossNioEventLoop`å¾ªç¯æ‰§è¡Œä¸‰ä¸ªæ­¥éª¤ï¼š\n	1. è½®è¯¢`accept`äº‹ä»¶\n	2. å¤„ç†`accept`äº‹ä»¶ï¼Œä¸`client`å»ºç«‹è¿æ¥ï¼Œç”Ÿæˆ`NioSocketChannel`ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°æŸä¸ª`WorkerGroup`çš„`NioEventLoop`ä¸Šçš„`selector`\n	3. å¤„ç†ä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œå³`runAllTasks`\n7. æ¯ä¸ª`WorkerNioEventLoop`å¾ªç¯æ‰§è¡Œä¸‰ä¸ªæ­¥éª¤:\n	1. è½®è¯¢`read,write`äº‹ä»¶\n	2. å¤„ç†`I/O`äº‹ä»¶ï¼Œå³`read,write`äº‹ä»¶ï¼Œåœ¨å¯¹åº”`NioSocketChannel`å¤„ç†\n	3. å¤„ç†ä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œå³`runAllTasks`\n8. æ¯ä¸ª`Worker NioEventLoop`å¤„ç†ä¸šåŠ¡æ—¶ï¼Œä¼šä½¿ç”¨`pipeline`ï¼ˆç®¡é“ï¼‰ï¼Œ`pipeline`ä¸­åŒ…å«äº†`channel`,å³é€šè¿‡`pipeline`å¯ä»¥è·å–åˆ°å¯¹åº”é€šé“ï¼Œç®¡é“ä¸­ç»´æŠ¤äº†å¾ˆå¤šå¤„ç†å™¨\n\n');
INSERT INTO `blog_content` VALUES (60, '## ä½¿ç”¨Nettyå¼€å¯TCPæœåŠ¡\n\n[github](https://github.com/yhuihu/Java-Study/tree/master/netty)\n\n### NettyæœåŠ¡ç«¯\n```java\npublic class NettyServer {\n    public static void main(String[] args) throws InterruptedException {\n        //åˆ›å»ºBossGroupå’ŒworkerGroup\n        //1.åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ç»„bossGroupå’ŒworkerGroup\n        //2bossGroupåªæ˜¯å¤„ç†è¿æ¥è¯·æ±‚ï¼ŒçœŸæ­£å’Œå®¢æˆ·ç«¯è¿›è¡Œä¸šåŠ¡å¤„ç†çš„ï¼Œæ˜¯workerGroup\n        EventLoopGroup bossGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        //åˆ›å»ºæœåŠ¡å™¨ç«¯çš„å¯åŠ¨å¯¹è±¡ï¼Œé…ç½®å‚æ•°\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            //ä½¿ç”¨é“¾å¼ç¼–ç¨‹æ¥è¿›è¡Œè®¾ç½®\n            serverBootstrap.group(bossGroup, workerGroup)//è®¾ç½®ä¸¤ä¸ªçº¿ç¨‹ç»„\n                    .channel(NioServerSocketChannel.class)//ä½¿ç”¨NioServerSocketChannelä½œä¸ºæœåŠ¡å™¨çš„é€šé“å®ç°\n                    .option(ChannelOption.SO_BACKLOG, 128)//è®¾ç½®çº¿ç¨‹é˜Ÿåˆ—å¾—åˆ°è¿æ¥çš„ä¸ªæ•°\n                    .childOption(ChannelOption.SO_KEEPALIVE, true)//è®¾ç½®ä¿æŒæ´»åŠ¨è¿æ¥çŠ¶æ€\n                    .childHandler(new ChannelInitializer<SocketChannel>() {//åˆ›å»ºä¸€ä¸ªé€šé“æµ‹è¯•å¯¹è±¡ï¼ˆåŒ¿åå¯¹è±¡ï¼‰\n                        //ç»™pipelineè®¾ç½®å¤„ç†å™¨\n                        @Override\n                        protected void initChannel(SocketChannel ch) throws Exception {\n                            //ç»™æˆ‘ä»¬çš„workerGroupçš„EventLoopå¯¹åº”çš„ç®¡é“è®¾ç½®å¤„ç†å™¨\n                            ch.pipeline().addLast(new NettyServerHandler());\n                        }\n                    });\n            System.out.println(\"..æœåŠ¡å™¨ is ready\");\n            //ç»‘å®šä¸€ä¸ªç«¯å£å¹¶ä¸”åŒæ­¥ï¼Œç”Ÿæˆäº†ä¸€ä¸ªChannelFutureå¯¹è±¡\n            //å¯åŠ¨æœåŠ¡å™¨\n            ChannelFuture sync = serverBootstrap.bind(6668).sync();\n            //å¯¹å…³é—­é€šé“è¿›è¡Œç›‘å¬ å½“æœ‰å…³é—­é€šé“æ¶ˆæ¯äº‹ä»¶æ—¶æ‰ä¼šå…³é—­\n            sync.channel().closeFuture().sync();\n        } finally {\n            bossGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n}\n\npublic class NettyServerHandler extends ChannelInboundHandlerAdapter {\n    /**\n     * è¯»å–å®é™…æ•°æ®ï¼ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥è¯»å–å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ï¼‰\n     * 1.ChannelHandlerContext cts:ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå«æœ‰ä¸ç®¡é“pipelineï¼Œé€šé“channelï¼Œåœ°å€\n     * 2.Object msg:å°±æ˜¯å®¢æˆ·ç«¯å‘é€çš„æ•°æ® é»˜è®¤Object\n     */\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        System.out.println(\"æœåŠ¡å™¨è¯»å–çº¿ç¨‹ï¼š\"+Thread.currentThread().getName());\n        System.out.println(\"server ctx=\" + ctx);\n        //å°†msgè½¬æˆByteBufï¼Œè¿™æ˜¯nettyæä¾›çš„ï¼Œä¹Ÿnioçš„ByteBufferä¸åŒ\n        ByteBuf byteBuf = (ByteBuf) msg;\n        System.out.println(\"å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯æ˜¯ï¼š\" + byteBuf.toString(CharsetUtil.UTF_8));\n        System.out.println(\"å®¢æˆ·ç«¯åœ°å€ï¼š\" + ctx.channel().remoteAddress());\n    }\n\n    /**\n     * æ•°æ®è¯»å–å®Œæ¯•\n     *\n     * @param ctx ä¸Šä¸‹æ–‡å¯¹è±¡\n     * @throws Exception e\n     */\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {\n        //writeæ–¹æ³•+flushæ–¹æ³•ï¼Œå°†æ•°æ®å†™å…¥ç¼“å­˜å¹¶åˆ·æ–°ï¼Œä¸€èˆ¬è®²ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸ªå‘é€çš„æ•°æ®è¿›è¡Œç¼–ç \n        ctx.writeAndFlush(Unpooled.copiedBuffer(\"hello,å®¢æˆ·ç«¯\", CharsetUtil.UTF_8));\n    }\n\n    /**\n     * å‘ç”Ÿå¼‚å¸¸ï¼Œå…³é—­é€šé“\n     *\n     * @param ctx   ä¸Šä¸‹æ–‡\n     * @param cause\n     * @throws Exception\n     */\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        ctx.close();\n    }\n}\n```\n\n### Nettyå®¢æˆ·ç«¯\n```java\npublic class NettyClient {\n    public static void main(String[] args) throws InterruptedException {\n        //å®¢æˆ·ç«¯éœ€è¦ä¸€ä¸ªäº‹ä»¶å¾ªç¯ç»„\n        EventLoopGroup eventExecutors = new NioEventLoopGroup();\n        //åˆ›å»ºå®¢æˆ·ç«¯å¯åŠ¨å¯¹è±¡\n        try {\n            Bootstrap bootstrap = new Bootstrap();\n            bootstrap.group(eventExecutors)//è®¾ç½®çº¿ç¨‹ç»„\n                    .channel(NioSocketChannel.class)//è®¾ç½®å®¢æˆ·ç«¯é€šé“çš„å®ç°ç±»ï¼ˆåå°„ï¼‰\n                    .handler(new ChannelInitializer<SocketChannel>() {\n                        @Override\n                        protected void initChannel(SocketChannel ch) throws Exception {\n                            ch.pipeline().addLast(new NettyClientHandler());\n                        }\n                    });\n            System.out.println(\"å®¢æˆ·ç«¯ ok..\");\n            //å¯åŠ¨å®¢æˆ·ç«¯å»è¿æ¥æœåŠ¡ç«¯\n            //å…³äºchannelFutureè¦åˆ†æï¼Œæ¶‰åŠåˆ°nettyçš„å¼‚æ­¥æ¨¡å‹\n            ChannelFuture sync = bootstrap.connect(\"127.0.0.1\", 6668).sync();\n            //ç»™å…³é—­é€šé“è¿›è¡Œç›‘å¬\n            sync.channel().closeFuture().sync();\n        } finally {\n            eventExecutors.shutdownGracefully();\n        }\n    }\n}\n\npublic class NettyClientHandler extends ChannelInboundHandlerAdapter {\n    /**\n     * å½“é€šé“å°±ç»ªå°±ä¼šè§¦å‘è¯¥æ–¹æ³•\n     *\n     * @param ctx ctx\n     * @throws Exception e\n     */\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n        System.out.println(\"client:\" + ctx);\n        ctx.writeAndFlush(Unpooled.copiedBuffer(\"hello,server\", CharsetUtil.UTF_8));\n    }\n\n    /**\n     * è¯»å–äº‹ä»¶è§¦å‘\n     *\n     * @param ctx ctx\n     * @param msg msg\n     * @throws Exception e\n     */\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        ByteBuf byteBuf = (ByteBuf) msg;\n        System.out.println(\"æ¥æ”¶åˆ°æœåŠ¡å™¨æ¶ˆæ¯ï¼š\" + byteBuf.toString(CharsetUtil.UTF_8));\n        System.out.println(\"æœåŠ¡å™¨åœ°å€:\" + ctx.channel().remoteAddress());\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        cause.printStackTrace();\n        ctx.close();\n    }\n}\n```\n\n');
INSERT INTO `blog_content` VALUES (61, '## Nettyä»»åŠ¡é˜Ÿåˆ—\n- ç”¨æˆ·ç¨‹åºè‡ªå®šä¹‰çš„æ™®é€šä»»åŠ¡\n```java\n	ctx.channel().eventLoop().execute(() -> {\n            try {\n                Thread.sleep(20 * 1000);\n                ctx.writeAndFlush(Unpooled.copiedBuffer(\"å¤„ç†ç»“æŸ2\", CharsetUtil.UTF_8));\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        });\n```\n\n- ç”¨æˆ·è‡ªå®šä¹‰å®šæ—¶ä»»åŠ¡\n```java\n        //scheduleå’Œexecuteæ˜¯åœ¨ä¸¤ä¸ªä¸åŒé˜Ÿåˆ—çš„\n        ctx.channel().eventLoop().schedule(() -> {\n            try {\n                Thread.sleep(10 * 1000);\n                ctx.writeAndFlush(Unpooled.copiedBuffer(\"å¤„ç†ç»“æŸ1\", CharsetUtil.UTF_8));\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        },5, TimeUnit.SECONDS);\n```\n\n- éå½“å‰Reactorçº¿ç¨‹è°ƒç”¨Channelçš„å„ç§æ–¹æ³•\nä¾‹å¦‚åœ¨æ¨é€ç³»ç»Ÿçš„ä¸šåŠ¡çº¿ç¨‹é‡Œé¢ï¼Œæ ¹æ®ç”¨æˆ·çš„æ ‡è¯†ï¼Œæ‰¾åˆ°å¯¹åº”çš„ Channel å¼•ç”¨ï¼Œç„¶åè°ƒç”¨ Write ç±»æ–¹æ³•å‘è¯¥ç”¨æˆ·æ¨é€æ¶ˆæ¯ï¼Œå°±ä¼šè¿›å…¥åˆ°è¿™ç§åœºæ™¯ã€‚æœ€ç»ˆçš„ Write ä¼šæäº¤åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­åè¢«å¼‚æ­¥æ¶ˆè´¹ã€‚ï¼ˆè¿™é‡Œç»™ä¸ªæ€è·¯ï¼Œå°†ç”¨æˆ·ä¸Channelå¯¹åº”å…³ç³»æ–¹æ³•ä¸€ä¸ªmapä¸­ï¼Œéœ€è¦å‘é€æ¶ˆæ¯æ—¶æ ¹æ®ç”¨æˆ·å–å‡ºæ¥ã€‚å¦‚æœæ˜¯ç¾¤èŠç³»ç»Ÿçš„è¯ä¸¤ä¸ªmapï¼Œæœ‰ä¼˜åŒ–æ–¹æ³•æ—¶å†è¡¥å……ï¼‰\n\n## æ³¨æ„äº‹é¡¹\n1. æ™®é€šä»»åŠ¡ä¸å®šæ—¶ä»»åŠ¡æ˜¯åœ¨ä¸¤ä¸ªä¸åŒçš„é˜Ÿåˆ—å½“ä¸­çš„\n![image.png](https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/rhXc8CCyy25OSLKLQieL92ZI)\n\n2. å¦‚æœå¤šä¸ªä»»åŠ¡åœ¨åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œé‚£ä¹ˆä¼šå‡ºç°æ’é˜Ÿçš„æ•ˆæœï¼Œä¾‹å¦‚ï¼š`ctx.channel().eventLoop().execute(new Runable())`è¿™ä¸ªæ–¹æ³•æ‰§è¡Œä¸¤æ¬¡ï¼Œç¬¬ä¸€ä¸ªä»»åŠ¡è€—æ—¶5sï¼Œç¬¬äºŒä¸ªä»»åŠ¡è€—æ—¶10sï¼Œé‚£ä¹ˆç»“æœå°†æ˜¯ï¼Œç¬¬ä¸€ä¸ªä»»åŠ¡åœ¨5sè¿”å›ï¼Œç¬¬äºŒä¸ªä»»åŠ¡åœ¨15sè¿”å›ï¼Œå› ä¸ºé˜Ÿåˆ—éµå¾ªå…ˆè¿›å…ˆå‡ºã€‚');
INSERT INTO `blog_content` VALUES (62, '```java\npublic class ChatServer {\n    private int port;\n\n    ChatServer(int port) {\n        this.port = port;\n    }\n\n    public void start() throws InterruptedException {\n        EventLoopGroup boss = new NioEventLoopGroup();\n        EventLoopGroup worker = new NioEventLoopGroup();\n        ServerBootstrap serverBootstrap = new ServerBootstrap();\n        serverBootstrap.group(boss, worker);\n        serverBootstrap.channel(NioServerSocketChannel.class);\n        serverBootstrap.handler(new LoggingHandler(LogLevel.INFO));\n        serverBootstrap.childHandler(new ChannelInitializer<SocketChannel>() {\n            @Override\n            protected void initChannel(SocketChannel ch) throws Exception {\n                ChannelPipeline pipeline = ch.pipeline();\n                //httpåŠ è§£ç \n                pipeline.addLast(new HttpServerCodec());\n                //è¯·æ±‚é•¿åº¦é™åˆ¶\n                pipeline.addLast(new HttpObjectAggregator(8972));\n                //websocketè¿æ¥ç«¯ç‚¹\n                pipeline.addLast(new WebSocketServerProtocolHandler(\"/websocket\"));\n                pipeline.addLast(new ChatServerHandler());\n            }\n        });\n        ChannelFuture sync = serverBootstrap.bind(8080).sync();\n        sync.channel().closeFuture().sync();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        ChatServer chatServer = new ChatServer(8080);\n        chatServer.start();\n    }\n}\n```\n\n```java\npublic class ChatServerHandler extends SimpleChannelInboundHandler<TextWebSocketFrame> {\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx, TextWebSocketFrame msg) throws Exception {\n        Channel channel = ctx.channel();\n        System.out.println(\"æ¥æ”¶åˆ°æ¥è‡ª[\" + channel.remoteAddress() + \"]çš„æ¶ˆæ¯ï¼š\" + msg.text());\n        ctx.writeAndFlush(new TextWebSocketFrame(\"æœåŠ¡å™¨æ—¶é—´\" + LocalDateTime.now() + \" \" + msg.text()));\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        System.out.println(\"å‘ç”Ÿå¼‚å¸¸ï¼š\" + cause.getMessage());\n    }\n\n    @Override\n    public void handlerAdded(ChannelHandlerContext ctx) throws Exception {\n        System.out.println(ctx.channel().remoteAddress() + \"ä¸Šçº¿äº†\");\n    }\n\n    @Override\n    public void handlerRemoved(ChannelHandlerContext ctx) throws Exception {\n        System.out.println(ctx.channel().remoteAddress() + \"ç¦»å¼€äº†\");\n    }\n}\n```\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>websocket</title>\n</head>\n<script>\n  var socket = null;\n  if (!window.WebSocket) {\n    alert(\"å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ\");\n  } else {\n    socket = new WebSocket(\"ws://localhost:8080/websocket\");\n    socket.onopen = function () {\n      var elementById = document.getElementById(\"responseText\");\n      elementById.value = \"è¿æ¥å¼€å¯äº†ã€‚\"\n    }\n    //ç›¸å½“äºè¿æ¥å…³é—­(æ„ŸçŸ¥åˆ°è¿æ¥å…³é—­)\n    socket.onclose = function (ev) {\n      var rt = document.getElementById(\"responseText\");\n      rt.value = rt.value + \"\\n\" + \"è¿æ¥å…³é—­äº†..\"\n    }\n    socket.onmessage = function (ev) {\n      var rt = document.getElementById(\"responseText\");\n      rt.value = rt.value + \"\\n\" + ev.data;\n    }\n  }\n\n  //å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨\n  function send() {\n    if (!window.socket) { //å…ˆåˆ¤æ–­socketæ˜¯å¦åˆ›å»ºå¥½\n      return;\n    }\n    if (socket.readyState === WebSocket.OPEN) {\n      //é€šè¿‡socket å‘é€æ¶ˆæ¯\n      socket.send(document.getElementById(\"textValue\").value)\n    } else {\n      alert(\"è¿æ¥æ²¡æœ‰å¼€å¯\");\n    }\n  }\n</script>\n<body>\n<div>\n    <label>\n        <input type=\"text\" id=\"textValue\">\n    </label>\n    <input type=\"button\" value=\"å‘é€æ¶ˆæ¯\" onclick=\"send()\">\n</div>\n<div>\n    <label>\n        <textarea style=\"width: 300px;height: 300px\" id=\"responseText\"></textarea>\n    </label>\n    <input type=\"button\" value=\"æ¸…ç©ºæ¶ˆæ¯\" onclick=\"document.getElementById(\'responseText\').value=\'\'\">\n</div>\n</body>\n</html>\n\n```');
INSERT INTO `blog_content` VALUES (63, 'é¡¹ç›®éƒ¨ç½²ä¸Šçº¿ågithubç¬¬ä¸‰æ–¹ç™»å½•ç¦»å¥‡çš„æ…¢ï¼Œå¹¶ä¸”å¤šæ¬¡å‡ºç°`Connection refused (Connection refused)`çš„é”™è¯¯ï¼Œå› æ­¤æ‰¾åˆ°äº†ä¸€ç§åŠæ³•æ˜¯é€šè¿‡ä¿®æ”¹hostsè§£å†³ã€‚\nWindowsä¸‹åœ¨`C:/Windows/system32/drivers/etc/hosts`\nUbuntuç­‰linuxç³»ä¸€èˆ¬åœ¨`/etc/hosts`\n```yml\n # Github\n151.101.44.249 github.global.ssl.fastly.net\n192.30.253.113 github.com\n103.245.222.133 assets-cdn.github.com\n23.235.47.133 assets-cdn.github.com\n203.208.39.104 assets-cdn.github.com\n204.232.175.78 documentcloud.github.com\n204.232.175.94 gist.github.com\n107.21.116.220 help.github.com\n207.97.227.252 nodeload.github.com\n199.27.76.130 raw.github.com\n107.22.3.110 status.github.com\n204.232.175.78 training.github.com\n207.97.227.243 www.github.com\n185.31.16.184 github.global.ssl.fastly.net\n151.101.0.0/22 avatars0.githubusercontent.com\n151.101.0.0/22 avatars1.githubusercontent.com\n151.101.0.0/22 avatars2.githubusercontent.com\n151.101.0.0/22 avatars3.githubusercontent.com\n199.232.28.133 cloud.githubusercontent.com\n```\nåˆ·æ–°hosts\nWindowsï¼š`ipconfig /flushdns`\nUbuntuï¼š`sudo systemctl restart nscd`');

-- ----------------------------
-- Table structure for carousel
-- ----------------------------
DROP TABLE IF EXISTS `carousel`;
CREATE TABLE `carousel`  (
                             `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                             `image` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'å›¾ç‰‡',
                             `image_order` int(0) NOT NULL COMMENT 'é¡ºåº',
                             `url` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'é“¾æ¥',
                             PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 4 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of carousel
-- ----------------------------
INSERT INTO `carousel` VALUES (1, 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/pYA3VyEiRqk5u83Pi9QNKyks', 1, '');
INSERT INTO `carousel` VALUES (3, 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/TZD9h01g8i414gSc6mMApPy4', 3, '');
INSERT INTO `carousel` VALUES (4, 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/KHzm6Fhn4lIydTbZ7IZB7D4X', 1, '');

-- ----------------------------
-- Table structure for comment
-- ----------------------------
DROP TABLE IF EXISTS `comment`;
CREATE TABLE `comment`  (
                            `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                            `blog_id` int(0) UNSIGNED NOT NULL COMMENT 'å¯¹åº”çš„åšå®¢',
                            `content` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'è¯„è®ºå†…å®¹',
                            `comment_date` datetime(0) NOT NULL COMMENT 'è¯„è®ºæ—¥æœŸ',
                            `reader_id` int(0) UNSIGNED NOT NULL COMMENT 'è¯»è€…/è¯„è®ºè€…',
                            `reply_comment_id` int(0) UNSIGNED NULL DEFAULT NULL COMMENT 'å›å¤çš„è¯„è®ºï¼Œç©ºè¡¨ç¤ºè¯„è®ºåšå®¢',
                            PRIMARY KEY (`id`) USING BTREE,
                            INDEX `comment_ibfk_1`(`blog_id`) USING BTREE,
                            INDEX `reader_id`(`reader_id`) USING BTREE,
                            INDEX `reply_comment_id`(`reply_comment_id`) USING BTREE,
                            CONSTRAINT `comment_ibfk_1` FOREIGN KEY (`blog_id`) REFERENCES `blog` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
                            CONSTRAINT `comment_ibfk_2` FOREIGN KEY (`reader_id`) REFERENCES `reader` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
                            CONSTRAINT `comment_ibfk_3` FOREIGN KEY (`reply_comment_id`) REFERENCES `comment` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB AUTO_INCREMENT = 139 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of comment
-- ----------------------------
INSERT INTO `comment` VALUES (108, 35, 'githubç¬¬ä¸‰æ–¹ç™»å½•æˆåŠŸ', '2019-08-26 19:19:07', 138, NULL);
INSERT INTO `comment` VALUES (109, 37, 'å¤šçº¿ç¨‹çˆ¬è™«å¤ªç‹ äº†', '2019-08-27 19:20:53', 138, NULL);
INSERT INTO `comment` VALUES (111, 37, 'æœ¬æ–‡ç« demoå·²ç»ä¸Šä¼ github\nhttps://github.com/yhuihu/Java_Spilder', '2019-08-28 10:06:07', 138, NULL);
INSERT INTO `comment` VALUES (112, 37, 'ç‰›æ‰¹', '2019-08-28 17:11:40', 139, NULL);
INSERT INTO `comment` VALUES (139, 62, '<img src=1 onerror=alert(1)>', '2020-07-15 21:29:07', 139, NULL);

-- ----------------------------
-- Table structure for flyway_schema_history
-- ----------------------------
DROP TABLE IF EXISTS `flyway_schema_history`;
CREATE TABLE `flyway_schema_history`  (
                                          `installed_rank` int(0) NOT NULL,
                                          `version` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
                                          `description` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
                                          `type` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
                                          `script` varchar(1000) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
                                          `checksum` int(0) NULL DEFAULT NULL,
                                          `installed_by` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
                                          `installed_on` timestamp(0) NOT NULL DEFAULT CURRENT_TIMESTAMP(0),
                                          `execution_time` int(0) NOT NULL,
                                          `success` tinyint(1) NOT NULL,
                                          PRIMARY KEY (`installed_rank`) USING BTREE,
                                          INDEX `flyway_schema_history_s_idx`(`success`) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of flyway_schema_history
-- ----------------------------
INSERT INTO `flyway_schema_history` VALUES (1, '1', 'init', 'SQL', 'V1__init.sql', 2120726760, 'blog', '2020-07-23 14:17:16', 1203, 1);

-- ----------------------------
-- Table structure for link
-- ----------------------------
DROP TABLE IF EXISTS `link`;
CREATE TABLE `link`  (
                         `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                         `link_name` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'é“¾æ¥åç§°',
                         `link_url` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'é“¾æ¥åœ°å€',
                         `link_order` int(0) NOT NULL COMMENT 'é“¾æ¥æ¬¡åºï¼ˆå°çš„åœ¨å‰ï¼‰',
                         PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 5 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of link
-- ----------------------------
INSERT INTO `link` VALUES (1, 'iconfont', 'http://www.iconfont.cn/', 4);
INSERT INTO `link` VALUES (2, 'github', 'https://github.com/yhuihu/', 6);
INSERT INTO `link` VALUES (5, 'ç™¾åº¦', 'http://www.baidu.com', 10);

-- ----------------------------
-- Table structure for project
-- ----------------------------
DROP TABLE IF EXISTS `project`;
CREATE TABLE `project`  (
                            `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                            `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'åç§°',
                            `url` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'é¡¹ç›®åœ°å€',
                            `image` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'é¡¹ç›®å›¾ç‰‡',
                            `project_order` int(0) UNSIGNED NOT NULL COMMENT 'é¡¹ç›®é¡ºåº',
                            PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 3 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of project
-- ----------------------------
INSERT INTO `project` VALUES (1, 'å®¢æˆ¿é¢„è®¢ç³»ç»Ÿ', 'https://github.com/yhuihu/HotelsBook', 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/x4PJYPybcXTz9ikarRBSLrHA', 1);
INSERT INTO `project` VALUES (2, 'ä¸ªäººåšå®¢ç³»ç»Ÿ', 'https://github.com/yhuihu/yhhu_blog_front', 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/8drzCCJGbrVu8wS0QWjW3Aco', 2);
INSERT INTO `project` VALUES (3, 'Javaçˆ¬è™«', 'https://github.com/yhuihu/Java_Spilder', 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/oOjL0WcQ10OMenyGofEBqT6P', 3);

-- ----------------------------
-- Table structure for reader
-- ----------------------------
DROP TABLE IF EXISTS `reader`;
CREATE TABLE `reader`  (
                           `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                           `username` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç™»å½•ç”¨çš„è´¦æˆ·',
                           `password` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç™»å½•ç”¨çš„å¯†ç ',
                           `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'åå­—',
                           `ip` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ipåœ°å€',
                           `avatar` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'å¤´åƒ',
                           `email` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'é‚®ç®±',
                           `inform` int(0) NULL DEFAULT 0 COMMENT 'æ”¶åˆ°å›å¤æ—¶æ˜¯å¦æ¥æ”¶é‚®ä»¶',
                           `uuid` int(0) NULL DEFAULT NULL,
                           PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 140 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of reader
-- ----------------------------
INSERT INTO `reader` VALUES (138, NULL, NULL, 'SuperTig', '127.0.0.1', 'https://avatars3.githubusercontent.com/u/35516186?v=4', NULL, 0, 35516186);
INSERT INTO `reader` VALUES (139, NULL, NULL, 'åŠªåŠ›å­¦ä¹ å¤©å¤©å‘ä¸Š', '127.0.0.1', 'https://avatars2.githubusercontent.com/u/43103543?v=4', NULL, 0, 43103543);
INSERT INTO `reader` VALUES (140, NULL, NULL, 'Arthur-_-', '223.74.111.32', 'https://avatars3.githubusercontent.com/u/66620545?v=4', NULL, 0, 66620545);

-- ----------------------------
-- Table structure for send_comment
-- ----------------------------
DROP TABLE IF EXISTS `send_comment`;
CREATE TABLE `send_comment`  (
                                 `id` int(0) NOT NULL AUTO_INCREMENT,
                                 `email` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
                                 `title` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
                                 `comment_id` int(0) UNSIGNED NOT NULL,
                                 `blog_id` int(0) UNSIGNED NOT NULL,
                                 `content` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
                                 `reader_name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
                                 PRIMARY KEY (`id`) USING BTREE,
                                 INDEX `comment_id`(`comment_id`) USING BTREE,
                                 INDEX `blog_id`(`blog_id`) USING BTREE,
                                 CONSTRAINT `send_comment_ibfk_1` FOREIGN KEY (`comment_id`) REFERENCES `comment` (`id`) ON DELETE RESTRICT ON UPDATE RESTRICT,
                                 CONSTRAINT `send_comment_ibfk_2` FOREIGN KEY (`blog_id`) REFERENCES `blog` (`id`) ON DELETE RESTRICT ON UPDATE RESTRICT
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Table structure for tag_name
-- ----------------------------
DROP TABLE IF EXISTS `tag_name`;
CREATE TABLE `tag_name`  (
                             `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                             `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'åç§°',
                             PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 16 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of tag_name
-- ----------------------------
INSERT INTO `tag_name` VALUES (1, 'Java');
INSERT INTO `tag_name` VALUES (2, 'Spring');
INSERT INTO `tag_name` VALUES (4, 'JS');
INSERT INTO `tag_name` VALUES (5, 'HMTL');
INSERT INTO `tag_name` VALUES (6, 'Vue');
INSERT INTO `tag_name` VALUES (7, 'æ•°æ®åº“');
INSERT INTO `tag_name` VALUES (8, 'Linux');
INSERT INTO `tag_name` VALUES (9, 'æ•°æ®ç»“æ„');
INSERT INTO `tag_name` VALUES (10, 'ç®—æ³•');
INSERT INTO `tag_name` VALUES (11, 'é¡¹ç›®');
INSERT INTO `tag_name` VALUES (12, 'ç¬”è®°');
INSERT INTO `tag_name` VALUES (13, 'å…¶ä»–');
INSERT INTO `tag_name` VALUES (14, 'CSS');
INSERT INTO `tag_name` VALUES (15, 'å¾®æœåŠ¡');
INSERT INTO `tag_name` VALUES (16, 'ä¸­é—´ä»¶');

-- ----------------------------
-- Table structure for type_name
-- ----------------------------
DROP TABLE IF EXISTS `type_name`;
CREATE TABLE `type_name`  (
                              `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                              `name` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT 'åç§°',
                              PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 3 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of type_name
-- ----------------------------
INSERT INTO `type_name` VALUES (1, 'åŸåˆ›');
INSERT INTO `type_name` VALUES (2, 'è½¬è½½');
INSERT INTO `type_name` VALUES (3, 'ç¿»è¯‘');

-- ----------------------------
-- Table structure for user
-- ----------------------------
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user`  (
                         `id` int(0) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
                         `nickname` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'åå­—',
                         `profile` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç®€ä»‹',
                         `avatar` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'å¤´åƒ',
                         `password` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'å¯†ç ',
                         `username` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'ç”¨æˆ·å',
                         `email` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL COMMENT 'é‚®ç®±',
                         PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of user
-- ----------------------------
INSERT INTO `user` VALUES (1, 'yhhu', 'ğŸ˜„æ™®é€šå¤§å­¦ç”Ÿï¼ŒæŠ€æœ¯çˆ±å¥½è€…ğŸ˜„', 'https://yhhu.oss-cn-shenzhen.aliyuncs.com/blog/ft1Uo1DThKrCsVGosrEVxuGK', 'fT28i22g7aee7ref0ff0950720e00ba0e901b0f404c0780f', 'Tiger', '1357958736@qq.com');

SET FOREIGN_KEY_CHECKS = 1;
